Conditional Multi-Task learning for Plant Disease
Identification
Sue Han Lee, Hervé Goëau, Pierre Bonnet, Alexis Joly

To cite this version:

Sue Han Lee, Hervé Goëau, Pierre Bonnet, Alexis Joly. Conditional Multi-Task learning for Plant
Disease Identification. ICPR 2020 - 25th International Conference on Pattern Recognition, The In-
ternational Association for Pattern Recognition (IAPR); ICPR2020 Organizing committee, Jan 2021,
Milan, Italy. pp.3320-3327, ￿10.1109/ICPR48806.2021.9412643￿. ￿hal-03415972￿

HAL Id: hal-03415972

https://inria.hal.science/hal-03415972

Submitted on 10 Nov 2021

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.

Conditional Multi-Task learning
for Plant Disease Identiﬁcation

Sue Han Lee
Swinburne University of Technology
Sarawak Campus,
Jalan Simpang Tiga
93350 Kuching, Sarawak, Malaysia
Email: shlee@swinburne.edu.my

Herv´e Go¨eau
CIRAD, UMR AMAP
Montpellier, France
Email: herve.goeau@cirad.fr

Pierre Bonnet
CIRAD, UMR AMAP
Montpellier, France
Email: pierre.bonnet@cirad.fr

Alexis Joly
INRIA
Montpellier, France
Email: alexis.joly@inria.fr

Abstract—Several recent studies have proposed an automatic
plant disease identiﬁcation system based on deep learning.
However, these approaches are generally based on learned clas-
siﬁcation models with target classes of joint host species-disease
pairs that may not allow optimal use of the available information.
This is because these approaches require distinguishing between
similar host species or diseases, and more importantly, they have
limited scalability due to the size of a network gradually increases
as new classes are added, despite the fact that information on
host species or diseases is already available. This constraint is
all the more important as it can be difﬁcult to collect/establish a
speciﬁc list of all diseases for each host plant species in an actual
application. In this paper, we address the problems by proposing
a new conditional multi-task learning (CMTL) approach which
allows the distribution of host species and disease characteristics
learned simultaneously with a conditional link between them.
This conditioning is formed in such a way that the knowledge to
infer the prediction of one concept (the diseases) depends on the
other concept (the host species), which corresponds to the way
plant pathologists used to infer the diseases of the host species. We
show that our approach can improve the performance of plant
disease identiﬁcation compared to the usual species-disease pair
modeling in the previous studies. Meanwhile, we also compose
a new dataset on plant disease identiﬁcation that could serve as
an important benchmark in this ﬁeld.

Index Terms—plant disease identiﬁcation, multi-task learning

I. INTRODUCTION

Plant diseases are a major threat to agricultural production,
causing a severe food recession and affecting crop quality
[2]. To detect diseases in crops, plant pathologists generally
use molecular and serological methods or measurements of
various parameters such as morphological change, temperature
change, change in transpiration rates and emission of volatile
organic compounds from infected plants [3]. Expert consulta-
tion is one of the major way to control plant diseases, but it
is time consuming and expensive, and it is not always easy to
ﬁnd an available pathologist, specialist of the target crop or
disease. In recent years, automated plant disease identiﬁcation
has been introduced into plant taxonomy to potentially ﬁll
gaps in human disease identiﬁcation capabilities. Researchers
use deep learning techniques to automatically identify diseases
of single or multiple host species. In this paper, the scope of
research is not limited to diseases of a single host species, but

Fig. 1. The identiﬁcation of plant diseases is based on two main concepts
which are host species and diseases. These two concepts are closely related
and can be structurally linked in such a way that knowledge of one concept
(j) depends on the other (i). In this case, i is equivalent to the host species
concept while j is the disease concept. Such modeling corresponds to the way
plant pathologists use species information to infer associated diseases [1].

to a large number of diseases of several host species in order
to increase the ﬂexibility of applications in different ﬁelds.

To learn the representation of diseases of multiple host
species [4], [5], [6], in all cases, researchers trained stan-
dard convolutional neural network (CNN) models to distin-
guish characteristics based on joint species-disease classes,
for example: Grape Black rot, Apple Apple scab and
Apple Black rot. Although successfully, it requires that
the size of the network gradually increases when new classes
are added, even though there is already information on crops

or diseases. In addition, we consider that it would be very
difﬁcult, if not impossible, in a real application to collect a
complete set of images illustrating each species-disease pair. In
fact, it may not be easy to establish a speciﬁc list of all diseases
for each host species. We note that pathogens with a wide host
range can infect many different host species. For example,
as reported in [7], nearly 200 plant species can be infected
by bacterial wilt (Ralstonia solanacearum). Therefore, a new
strategy is needed to improve the efﬁciency of plant disease
identiﬁcation modelling in order to increase the ﬂexibility to
transfer knowledge from one disease context to another.

In this paper, we propose to use a conditional multi-task
learning (CMTL) in the identiﬁcation of plant diseases, replac-
ing previous modelling approaches [4], [5], [6] with joint host
species-disease pairs. More speciﬁcally, we propose to model
two main concepts/tasks which are host species and diseases
through multi-task learning, and each concept is represented
by its own feature distribution but they are strongly linked
by a speciﬁc conditional structure, as shown in Fig. 1. This
structured process corresponds not only to the fundamental
building block of human intelligence to reason for everyday
visual input on the basis of related prior knowledge [8], but
more importantly, corresponds to the way plant pathologists
use species information to infer the associated diseases [1].
Therefore, unlike previous works on large-scale multitasking
[9], [10], [11], in this paper, we aim to solve the problem of
plant disease identiﬁcation tasks where the tasks are interre-
lated of which the representation of one task is considered an
obvious indicator for inferring the other task.

In short, the contributions of the paper are as follows:
1) This paper presents a new method for classifying plant
diseases. It deploys a multi-task learning mechanism and
proposes a conditional scheme strongly adapted to the
context of plant disease identiﬁcation.

2) The experimental results show that our proposed condi-
tional multi-task learning can improve the performance
of plant disease identiﬁcation compared to the traditional
joint species-disease pair modeling.

3) We compose a new dataset that is used for benchmarking
the accuracy of plant disease identiﬁcation. To our
knowledge, this is the ﬁrst plant disease identiﬁcation
dataset that covers the largest number of host species and
diseases. In exact, we have 1145 joint species-disease
classes, 311 host species and 289 diseases, which is
larger than the well-known PlantVillage dataset [4] with
only 38 joint species-disease, 14 host species and 20
number of diseases.

II. RELATED WORKS

A. Plant disease identiﬁcation

Early studies on automated identiﬁcation of plant diseases
focused primarily on one single host species and relied on
hand-crafted approaches, but as deep learning techniques have
demonstrated extremely high recognition capabilities in many
image recognition tasks, multi-host species and diseases based

models are receiving increasing attention [13], [14]. To form
a multi-host species and diseases model, a straightforward
approach is to consider target classes as joint species-diseases
[15], [4], [5], [6], [16], as shown in Fig. 2c. Although success-
ful, there remains a doubt as to whether the characteristics
learned from such model are optimal for identifying plant
diseases, especially when the model is trained to discriminate
similar host species or diseases. A potentially undesirable
effect that may occur is that the model learns more from the
content related to the species than the visual content related to
the disease [4], [17], [13]. This adverse effect can potentially
be ampliﬁed if a species has a very pronounced characteristics
while the disease’s features are not very visible. In addition,
it requires that the size of the network gradually increases
when new classes are added, even though there is already
information on crops or diseases. Although [13] addressed the
problem by proposing a symptoms oriented feature modelling
strategy by considering only diseases without considering host
species, this strategy may not be consistent with the perception
of expertise in distinguishing plant diseases, particularly when
information on host species is often needed to delineate lists
of diseases associated with host species [1]. This observation
prompts us to examine methods that could use prior knowledge
of host species to assist disease inference. Therefore, to over-
come these limitations, in this work, we study an alternative
approach to the usual modeling of joint species-disease pairs
by proposing a new approach based on conditional multi-task
learning (CMTL). We individually model the distribution of
the host species and diseases, and train them simultaneously
using our proposed CMTL method. The hypothesis is that
such intuitive modeling will engage the model to learn better
individual characteristics of the host species and the disease,
while exploiting the relationship between them based on a
conditional learning scheme that will be explained in Sec. III.

B. Multi-task learning (MTL)

Inspired by the ability of humans to generalize and transfer
knowledge acquired in one type of activity to other related
tasks, MTL has been widely explored in the ﬁeld of artiﬁcial
intelligence to accelerate up the learning process and improve
the generalization performance of multiple tasks. It has been
successfully applied from speech and natural language pro-
cessing to computer vision, bioinformatics, health informatics,
web applications and ubiquitous computing [18], [19]. There
are multiple learning tasks in MTL, each of which can be
a general learning task such as supervised tasks (classiﬁca-
tion and regression problems), unsupervised tasks (clustering
problem), semi-supervised tasks, reinforcement learning tasks,
etc. Among these learning tasks, it is assumed that all or
at least a subset of them are related to each other. In fact,
there is evidence that joint learning of these tasks can lead
to a considerable improvement in performance compared to
learning them individually [20], [18], [19]. General approaches
based on deep learning can be categorised into soft and
hard parameters sharing [21], [22]. In the soft parameter
sharing, each task is modeled by its own parameters, while

Fig. 2. Examples of CNN models used in the experiments. In order to obtain a fair comparison, all models were built on Inception-V3 with the same size
of shared layers (depth). (a), (b) and (c) illustrate the baselines architectures of different conﬁgurations. (a) which is called the generic MTL is composed of
shared layers and task-speciﬁc layers, (b) which is called the single nets is composed of individual networks for each concept and (c) which is called the Joint
net illustrates the conventional classiﬁcation of plant diseases with joint species-disease modelling. (d) is the classiﬁcation model proposed by [12] which was
designed to solve two closely related tasks of visual fashion analysis. We called it Fashion net. (e) is our proposed new terminology CMTL where predictive
modeling of one concept depends on the other.

for the hard parameter sharing approach, the hidden layer
parameters are shared between all tasks while keeping several
output layers speciﬁc to the tasks. Since in the case of soft
parameter sharing, the size of the network increases linearly
with the number of tasks (which is not so effective in terms
of parameters compared to the hard parameter sharing), and
since hard parameter based approach has been recognised as
the most commonly used approach for MTL [18], we use it to
test our concept. Next, to adapt this context to the identiﬁcation
of plant diseases, we improvise the classical MTL approach
(Fig. 2a) by introducing CMTL strategy (Fig. 2e), and by
experimental analysis, we show that CMTL approaches can
achieve better performance compared to MTL.

III. METHODOLOGY

A. Deﬁnitions and Preliminaries

In the general framework of MTL, given an entry x with
several classiﬁcation tasks ti where i = 1,2,...,k, the predictive
modeling can be formulated by [23]:

P (t1, .., tk/f (x)) = P (t1/f (x))...P (tk/f (x)) (1)
where f (x) is neural network function that takes into account
x and is parameterized by a weight vector w. The w consist of
the trainable shared weights wsh and the task-speciﬁc weights
wts.

In this paper, we aim to solve two related classiﬁcation
tasks in the identiﬁcation of plant diseases by giving an
input image x. These two related classiﬁcation tasks are the
identiﬁcation of diseases and host species. We present a new
strategy, called CMTL, in which it introduces a conditional
learning mechanism of task relationship where the learning of
the characteristics of a task is conditioned by another task.
Thus, unlike the traditional formulation in Eqn. (1), predictive
modeling is formulated in such a way that:

P (ts, td/f (x)) = P (ts/fs(x))P (td/fs(x), fd(x))

(2)

the host

where s and d represent
species and dis-
ease respectively. To achieve the conditional probability
P (td/fs(x), fd(x)), we learn the conditional function fc(x)
by employing two different approaches which are the con-
ditional
feature-wise linear
modulation.

feature fusion and conditional

B. Conditional feature fusion

The feature fusion based approach is responsible to softly
forward the disease-speciﬁc features conditioning on the
species-speciﬁc features for the disease predictive modeling
via feature fusion. We test with two common fusion strategies:
sum fusion and cascade fusion.

1) Sum fusion: In sum fusion (Fig. 3a), it learns functions
s (x)
d (x) respectively, and both signals are modulated via

of Hσ and Hγ which output σ and γ as a function of wts
and wts
the following functions:
σ = Hσ(wts

γ = Hγ(wts

d (x))

s (x))

fc(x) = tanh(σ + γ)

wts
is the function of the ﬁrst embedding layer of task i,
i
i (x) ∈ R1×N and N is the number
producing hidden units wts
of hidden units. Hσ and Hγ can be arbitrary functions such
as neural networks while in this case are formed using fully
connected layers.

2) Cascade fusion: Different from the sum fusion, both the
output neurons σ and γ are cascaded and then pass through
a reduction layer before the logits layer, as illustrated in Fig.
3b. More formally, the function is formulated as follows:

σ = Hσ(wts

s (x))

γ = Hγ(wts

d (x))

(5)

fc(x) = relu(Hβ([σ, γ]))
(6)
where the cascaded features have size R1×2N and Hβ is the
reduction function formed using fully connected layer.

(3)

(4)

Fig. 3. Examples of our CMTL proposals: Conditional feature fusion scheme - (a) Sum (FFS) and (b) Cascade (FFC) fusion, and (c) Conditional feature-wise
linear modulation (FiLM). Note that the identical mapping which is introduced to enrich the features of the disease layer is illustrated with dotted line.

C. Conditional feature-wise linear modulation

Feature-wise linear modulation (FiLM), considered as a
conditional normalization method [24], has been widely used
in several recent works proposing conditioning networks.
For example, conditional image synthesis [25], image-based
question answering [24] and conditional auto encoder for open
set recognition [26]. In this work, we use the same approach
to modulate the features of the disease at the fully connected
layer, conditioned by information on the host species, as shown
in Fig. 3c. As a function of input host species features wts
s (x),
the FiLM conditioning layer on the disease features wts
d (x)
is formulated as follows:

σj = Hσ(wts

s (x))
fc(x) = σj (cid:12) Hγ(wts

βj = Hβ(wts

s (x))

d,j(x)) + βj

(7)

(8)

where Hσ and Hβ are fully connected layers learned as a
function of wts
s (x) while Hγ is fully connected learned as a
function of wts
d (x), subscript j is refer to the jth neurons and
the (cid:12) deﬁnes the Hadamard product. Fig. 3c illustrates the
FiLM conditioning conﬁguration.

D. Identical mapping

With the features F output from the conditional layer fc, we
introduce an identical function to allow the disease embedding
features wts
d (x) and F to be combined as input to the next
layer as follows:

y = relu(F + wts

d (x))

(9)

The function is illustrated by the dotted contents in Fig.
3a-c. This approach builds on the work on residual learning
[27]
the model with
conditional learning mechanism is not degraded compared to

the performance of

to ensure that

a model without conditional learning. In addition, such a skip
architecture could help to enrich the features of the ﬁnal layer
of the disease with the information that has been captured in
the initial layers. We provide a detailed performance analysis
in Sec. V.

E. Training objective

This paper aims to solve multi-task classiﬁcation in the
identiﬁcation of plant diseases by giving an input image of
x. The output of the last hidden layer corresponding to the
i-th task is normalized by the softmax function

Pi(r|x) =

esr,i(x)
m=1 esm,i(x)

(cid:80)M

(10)

where M and r represent the total number of classes and
the target class respectively, while s(x) represents the ﬁnal
activation of the x input image obtained in the last hidden
layer/logits layer. After performing the softmax operation, we
ﬁnd the maximum likelihood of the sample by applying the
objective function, Li = −logPi(r|x). To optimize both tasks
ts and td, we simply add up both losses L = Ls + Ld.

IV. PLANT DISEASE DATASET

In the area of identiﬁcation of plant diseases for multiple
host species, there are not many publicly available datasets
with which researchers can work and, in many cases, re-
searchers must develop their own datasets. The process, from
the collection of samples to veriﬁcation by the plant’s experts,
can take several hours or days of work. To date, only two main
datasets with trusted labels are available online: PlantVillage
(PV) [4] and Digipathos [28]. The majority of studies are
based on the PV dataset [6], [4], which is currently the largest

TABLE I
DISTRIBUTION OF THE TRAINING AND VALIDATION SET FOR EACH
DATASET: (1) PLANTVILLAGE, (2) DIGIPATHOS, (3) IPM AND (4)
PL@NTNET.

TABLE II
LISTS AND NUMBER OF IMAGES PROVIDED BY THE INRAE
PHYTOPHATOLOGIST, WHICH IS USED AS A TESTING SET. NOTE THAT, THE

NAMES ARE WRITTEN IN THE FORM ’species

disease‘.

Dataset
PV
Digipathos
IPM
Pl@ntNet
Total

Number of training data
594
1668
4522
3540
10324

Number of validation data
146
345
812
663
1966

Name

Zucchini

P odosphaera xanthii

T omato Cladosporiose

V ine

P lasmopara viticola

T omato

T oM V

Total images
90
82
150
66

dataset containing 54305 number of images. However, PV
images are collected in a constrained environment with a
homogeneous background, and the model trained using these
images does not work well with images captured in a realistic
scenario (such as in ﬁeld conditions). This can be seen from
the huge drop in model performance in [4] when it was
used to predict images captured in environment with cluttered
backgrounds, reﬂecting a real-world scenario. Although the
Digipathos dataset addresses the above problem, the number
of images is too small (less than 5%) compared to the number
of PV images, which is 2326 images. Therefore, in this work,
we create a new dataset on diseases of multiple host species
that contains not only images captured in a homogeneous
background, but also images captured in agricultural ﬁelds,
in order to ﬁt to a real-life scenario.

To build a new dataset, we downloaded the plant disease im-
ages from IPM website (https://www.ipmimages.org/) where
the images were veriﬁed and contributed by the expertise
in plant disease management, and also using a combination
of PV and Digipathos to enlarge the database. From IPM
website, we were able to download a total of 5334 images with
complete information on host species and diseases. Since the
PV dataset contains only images captured under a constrained
background and the total number of images is larger than the
samples that were captured in a real scenario, to avoid biasing
the dataset into PV images constrained by a homogeneous
background, we took only a subset of images (∼20 number
of images) for each PV class. Next, we acquired healthy
images from the Pl@ntNet database (http://identify.plantnet-
project.org/) through a visual veriﬁcation step. Based on these
processes, we obtained a total of 12,290 images with 1146
joint species-disease labels, 311 host species and 289 number
of diseases (288 diseases + 1 healthy label). In addition, it
covers a total of 7163 healthy images and 5122 unhealthy
images. We then randomly separated the images into training
and validation set with a number of 10324 (∼80%) and
1966 (∼20%) respectively. The distribution of the training
and validation set for each dataset is shown in the Table I.
Note that these images composed of different plant organs
such as the leaf, branch, stem and fruit. Although the new
database contains fewer images than the PV database, it is
more complex due to a larger number of classes and more
diverse images, making the task more realistic and difﬁcult.

As for the testing set, we received images collected by

INRAE plant pathologists in the ﬁeld, and we named this
dataset INRAEdi. The collection consists of 4 well-known
plant diseases which are listed in the Table II. By comparing
INRAEdi with the aforementioned database listed in Table I,
we note that the class Zucchini P odosphaera xanthii is
new but its individual species and disease classes exist in the
database listed in Table I. In fact, this condition is somewhat
consistent with the problems encountered in the actual scenario
where complete species and disease data would not always be
available when training a model. Although the INRAEdi data
is not large, it allows us to assess the effectiveness of a model
in transferring knowledge from one disease context to another.

V. EXPERIMENTS AND RESULTS

To test the concept of the CMTL mechanism, we built
our network upon Inception-V3. The ﬁnal activation layer
of Inception-V3 were modiﬁed according to the different
strategies proposed as explained in Sec. III. We used random
cropping of images during pre-processing for training as well
as mirroring and color data augmentation. During model
evaluations, each test image was cropped in the center. All
images were resized to 299 × 299. We trained our models
using the Tensorﬂow library [29]. The networks were trained
with back-propagation, using stochastic gradient descent. For
the training parameter setting, we employed the ﬁxed learning
policy. We set the learning rate to 0.01, and then decreased
it by a factor of 10 until the validation set accuracy stops
improving. The momentum was set to 0.9 and the weight
decay to 0.0001. In all experiments, we used a mini-batch size
of 45. We run the experiments using an NVIDIA GTX1080
graphics card.

Baseline models In this section, we analyzed the classiﬁcation
performance of the proposed models and compared them to
three reference models: (1) Generic MTL (Fig. 2a), (2) single
nets (Fig. 2b) and (3) joint net (Fig. 2c). To model generic
MTL, we replaced the ﬁnal activation layer of Inception-V3
with two fully connected branched layers for the classiﬁcation
of diseases and host species. Speciﬁcally, having the same
shared layers as our proposed models, each task-speciﬁc
layer is composed of an individual
task embedding layer
and a logit layer. On the other hand, single nets are two
distinct models formed with different tasks, the classiﬁcation
of host species and diseases. In this model, we replaced the
ﬁnal activation layer of the Inception-V3 with a new logit

layer corresponding to the respective task. Next, joint net
is a network formed using conventional modeling of joint
species-diseases, which is widely used by [15], [4], [5], [6],
[16]. For this model, we replaced the ﬁnal activation layer of
the Inception-V3 with a new logit layer to classify the joint
species-disease classes. Particularly, in order to obtain a fair
comparison, all trained models were built on Inception-V3
to obtain the same model depth. Next, we also compare our
proposed models to the classiﬁcation model [12] (Fig. 2d)
that was designed to solve two closely related tasks of visual
fashion analysis. In spite of the tasks are not in the ﬁeld of
plant diseases but the characteristic of the targeted problem
aligned with the problem we intended to solve. The details
of this architecture will be explained later in the sub-section
‘Compared to the state-of-the-art’. We called this architecture
Fashion net.

Evaluation methods To measure the model classiﬁcation
performance on the validation set, we used the top-1 accuracy
in our experiments and also the average accuracy per class
(Ave) to assess the performance of every individual class.
Besides evaluating the classiﬁcation performance of each task
(the identiﬁcation of infectious diseases and hosts species)
itself, we also measured the extent to which the models can
correctly predict the conjoint species-disease classes. It should
be noted that with the exception of the joint net with immediate
probability output for each class of joint species-disease, other
modeling techniques require post-calculation to obtain this
conjoint prediction. To do this, we multiply the probability
outputs of the host species and disease, and measure the
ranking based on the 1146 joint species-disease labels. Table
III shows the comparison results.

As for the evaluation of the testing set, the prediction of
models takes into account all possible combinations, which
corresponds to the total number of diseases × the total number
of host species. However, it should be noted that the joint net
prediction outputs are limited to 1146 joint species-disease
classes. Hence, to test the ability of the joint net to identify
all possible combinations of host species and diseases, we
ﬁrst extract prediction for each host species and disease by
calculating the average probability output of the conjoint
classes associated with them, then multiply the probability
outputs of the host species and disease.

Performance analysis on validation set From Table III,
it can be seen that
the conditional FFS-res achieved the
highest accuracy for all predictions. In particular the conjoint
prediction which reached 69.43%, surpassing the joint net
[15], [4], [5], [6], [16], [28] that was widely used before,
which reached only 68.82%. In addition, compared to all
the baseline approaches, the conditional FFS-res showed a
highest accuracy for both diseases and host species. This
indicates that characteristics learned using the conditional
FFS-res are more robust, contributing to the highest optimal
prediction for each individual classiﬁcation task. Next, we
identical mapping (-res) could help improve the
ﬁnd that

TABLE III
CLASSIFICATION RESULTS OF DIFFERENT MODEL CONFIGURATIONS. WE
DENOTE THE NEW METHODS OF CONDITIONAL FEATURE FUSION: SUM
AND CASCADE FUSION BY CONDITIONAL FFS AND FFC RESPECTIVELY,
AND IDENTITY MAPPING IN THE FORM OF ‘RES’.

Model

conditional FFS-res
conditional FFS
conditional FFC-res
conditional FFC
conditional FiLM-res
conditional FiLM
Generic MTL
Single nets
Joint net
Fashion net [12]

Conjoint prediction
Top-1
69.43
67.34
68.06
67.19
68.01
68.62
68.16
68.67
68.82
66.48

Ave
64.79
61.96
62.58
62.55
62.97
64.39
62.91
63.10
64.27
61.53

Diseases
Top-1
82.96
81.59
81.84
81.38
82.15
82.86
82.76
82.25
82.15
81.49

Host species
Top-1
78.64
77.52
77.67
77.11
76.91
77.16
76.96
78.48
76.70
76.09

performance of approaches based on conditional FFS and
FFC. For example, in the case of conditional FFS-res and
FFC-res, each has an increase of 2.09% and 0.87% in
conjoint prediction when compared to the conditional FFS
and conditional FFC respectively. However, this is not the
case of conditional FiLM. This may be due to the fact that
FiLM has introduced a certain amount of conditioning by
means of afﬁne transformation of features. The introduction
of identity mapping after this transformation to deviate the
features again may not produce a better response. More
conditional hidden layers are probably needed as depicted in
[30] before introducing the identity mapping.

Compared to the state-of-the-art Many areas of research
use MTL to improve the application concerned. Among these
areas, the problem addressed in [12] on the classiﬁcation of
clothing categories is more relevant to the problem we intend
to solve. Speciﬁcally, they addressed two classiﬁcation tasks
that consist of classifying clothing categories and clothing
attributes, and these two tasks are strongly related to each
other. Unlike our proposed CMTL and the baseline generic
MTL, the MTL proposed in [12] does not have an individual
task embedding layer before the logits layer. To study the
this architecture, we imply the same concept
impact of
in modeling the identiﬁcation of plant diseases, without
involving the attention mechanism in order to have a fair
comparison to our proposed model, we called it Fashion net.
The Table III shows that with the proposed CMTL methods
and even with the generic MTL, the performances are better
than the Fashion net. This therefore indicates the importance
of task speciﬁc embedding layers for each task.

Prior knowledge assessment In the current CMTL approach,
we assume a unidirectional distribution of prior knowledge,
i.e. information about the species is injected into the disease
the disease characteristics are
layer or we can say that
species-dependent. However,
is possible that from the
it
disease information we can link to possible crops. In order
to determine whether different ways of linking knowledge

TABLE IV
COMPARISON RESULTS OF THE CONDITIONAL FFS-RES APPROACH FOR
DIFFERENT KNOWLEDGE DISTRIBUTION MODELS. NOTE THAT S→D
STANDS FOR DISEASE LAYER CONDITIONED ON SPECIES AND D→S FOR
SPECIES LAYER CONDITIONED ON DISEASE.

Model

S→D
D→S

Conjoint prediction
Top-1
69.43
68.51

Ave
64.79
63.02

Diseases
Top-1
82.96
82.81

Host species
Top-1
78.64
77.01

TABLE V
THE TOP-1 CONJOINT PREDICTION FROM DIFFERENT MODEL
CONFIGURATIONS ON EACH DATASET: (1) PV, (2) DIGIPATHOS, (3) IPM,
(4) PL@NTNET AND (5) INRAEDI

Model
conditional FFS-res
conditional FFS
conditional FFC-res
conditional FFC
conditional FiLM-res
conditional FiLM
Generic MTL
Single nets
Joint net
Fashion net [12]

PV
93.84
91.10
94.52
94.52
91.78
93.15
93.15
93.84
91.10
90.41

Digipathos
85.80
86.09
86.38
84.64
85.22
83.77
85.51
84.35
85.51
84.64

IPM Pl@ntNet
64.16
61.70
61.82
60.47
63.67
65.27
62.68
63.18
65.02
61.70

61.99
59.28
60.33
60.33
59.13
59.43
60.33
61.69
59.88
57.62

INRAEdi
8.76
16.49
16.24
13.40
7.99
9.28
9.54
2.06
6.96
13.40

introduce a difference in performance, we therefore tested
the knowledge transfer of the other cycle, i.e. the injection of
disease information into the host species. Table IV presents
the results of the comparison. It can be seen that that the
performance of S→D modeling is still better compared to
the D→S. This could be due to the fact that the number of
classes for species is higher, resulting in a greater diversity
of learned features in the species layer, which could provide
more information to the disease concept. In addition, it is
also possible that having an initial knowledge of the species
may be easier to infer disease than the other way around.

Performance of individual dataset We compare the perfor-
mance of each dataset detailed in the Sec. IV and show in
Table V. We can see that, for the validation sets, in general,
all models were able to obtain a better classiﬁcation result
(greater than 80%) in Digipathos and PV compared to IPM
and Pl@ntNet. This is due to the fact that the images captured
in Digipathos and PV come mainly from an easy and less noisy
background than in IPM and Pl@ntNet where the images are
mainly captured in ﬁelds cluttered by a complicated and noisy
background.

As for the INRAEdi testing set, we can see that the overall
performance of the models has decreased. We found that most
of the wrongly classiﬁed samples have the prediction results
for the disease classiﬁcation biased in favour of the “healthy”
class because the training images for the healthy class are
comparatively larger compared to the other disease classes.
This inevitably shows that the class imbalance in the training
data had an impact on the generalization of the models.
Besides that, the conjoint host species and disease classes that
has not been seen by the model during training was found

also another factor that affects the classiﬁcation performance.
However, we notice that the overall performance of the host
species is generally much higher than that of the diseases.
This is believed to be due to the fact that the host species
classiﬁer is more generalized and that the characteristics of
the model to differentiate host species are more distinctive
in relation to those of diseases, or conversely, that the visual
appearance of diseases is more variable. Apart from that, it can
be seen that the single net and the joint net are clearly lagging
behind compared to those MTL based models, showing the
importance of MTL in modelling plant disease identiﬁcation to
capture not only individual characteristics but also the mutual
characteristics between each concept/task.

From Table V, although we could not conclude which
CMTL based approaches perform best because each approach
achieved the highest accuracy in different datasets, we show
that CMTL-based approaches generally outperform baselines,
showing a signiﬁcant improvement in the identiﬁcation of
plant diseases.

VI. CONCLUSION

This paper has shown that a multi-task learning approach
is more efﬁcient than the usual CNN modeling method, the
joint net, in plant disease identiﬁcation. Furthermore, with
the CMTL conditional learning mechanism, we could achieve
better performance, which could serve as a reference for
researchers working in the same ﬁeld. The future direction
of our research is to address the problem of class imbalance
that resides in the current dataset and to explore possible
alternatives to improve CMTL methods to deal with it. In
addition, further research will be carried out to explore new
alternatives to solve problems where knowledge of host species
and diseases is limited during training and where unknown
classes may appear during testing. Finally, our new dataset
covering more host species and diseases than the PV [4]
and Digipathos [28] is obviously more challenging, which
encourages researchers in this ﬁeld to continue to venture
further.

ACKNOWLEDGMENT

This research project was supported by Agropolis Fon-
dation, Numev, Cemeb, #DigitAG, under the reference ID
1604-019 through the ”Investissements d’avenir” programme
(Labex Agro:ANR-10-LABX-0001-01). This work was also
supported by the French National Research Agency under
the Investments for the Future Program, referred as ANR-16-
CONV-0004.

REFERENCES

[1] M. B. Riley, M. R. Williamson, and O. Maloy, “Plant disease diagnosis,”

The Plant Health Instructor, vol. 10, 2002.

[2] M. Bhange and H. Hingoliwala, “Smart farming: Pomegranate disease
detection using image processing,” Procedia Computer Science, vol. 58,
pp. 280–288, 2015.

[3] Y. Fang, R. P. Ramasamy, and G. C. Rains, “Current and prospective
methods for plant disease detection,” in Biosensors, vol. 5, no. 3, 2015,
pp. 537–561.

[29] M. Abadi, P. Barham, J. Chen, Z. Chen, A. Davis, J. Dean, M. Devin,
S. Ghemawat, G. Irving, M. Isard et al., “Tensorﬂow: A system for large-
scale machine learning,” in 12th {USENIX} Symposium on Operating
Systems Design and Implementation ({OSDI} 16), 2016, pp. 265–283.
[30] E. Perez, H. De Vries, F. Strub, V. Dumoulin, and A. Courville,
reasoning without strong priors,” arXiv preprint

“Learning visual
arXiv:1707.03017, 2017.

[4] S. P. Mohanty, D. P. Hughes, and M. Salath´e, “Using deep learning for
image-based plant disease detection,” Frontiers in plant science, vol. 7,
p. 1419, 2016.

[5] E. C. Too, L. Yujian, S. Njuki, and L. Yingchun, “A comparative study
of ﬁne-tuning deep learning models for plant disease identiﬁcation,”
Computers and Electronics in Agriculture, 2018.

[6] K. P. Ferentinos, “Deep learning models for plant disease detection and
diagnosis,” Computers and Electronics in Agriculture, vol. 145, pp. 311–
318, 2018.

[7] S. Prospero and M. Cleary, “Effects of host variability on the spread of

invasive forest diseases,” Forests, vol. 8, no. 3, p. 80, 2017.

[8] I. J. Deary, L. Penke, and W. Johnson, “The neuroscience of human
intelligence differences,” Nature reviews neuroscience, vol. 11, no. 3, p.
201, 2010.

[9] M. Cordts, M. Omran, S. Ramos, T. Rehfeld, M. Enzweiler, R. Benen-
son, U. Franke, S. Roth, and B. Schiele, “The cityscapes dataset for
semantic urban scene understanding,” in Proc. of the IEEE Conference
on Computer Vision and Pattern Recognition (CVPR), 2016.

[10] W. Li, R. Zhao, T. Xiao, and X. Wang, “Deepreid: Deep ﬁlter pairing

neural network for person re-identiﬁcation,” in CVPR, 2014.

[11] B. Gong, Y. Shi, F. Sha, and K. Grauman, “Geodesic ﬂow kernel
for unsupervised domain adaptation,” in 2012 IEEE Conference on
Computer Vision and Pattern Recognition.
IEEE, 2012, pp. 2066–2073.
[12] W. Wang, Y. Xu, J. Shen, and S.-C. Zhu, “Attentive fashion grammar
network for fashion landmark detection and clothing category classiﬁca-
tion,” in Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition, 2018, pp. 4271–4280.

[13] S. H. Lee, H. Go¨eau, P. Bonnet, and A. Joly, “New perspectives on
plant disease characterization based on deep learning,” Computers and
Electronics in Agriculture, vol. 170, p. 105220, 2020.

[14] J. Boulent, S. Foucher, J. Th´eau, and P.-L. St-Charles, “Convolutional
neural networks for the automatic identiﬁcation of plant diseases,”
Frontiers in plant science, vol. 10, 2019.

[15] M. Arsenovic, M. Karanovic, S. Sladojevic, A. Anderla, and D. Ste-
fanovic, “Solving current limitations of deep learning based approaches
for plant disease detection,” Symmetry, vol. 11, no. 7, p. 939, 2019.
[16] M. T ¨URKO ˘GLU and D. Hanbay, “Plant disease and pest detection using
deep learning-based features,” Turkish Journal of Electrical Engineering
& Computer Sciences, vol. 27, no. 3, pp. 1636–1651, 2019.

[17] Y. Toda, F. Okura et al., “How convolutional neural networks diagnose

plant disease,” Plant Phenomics, vol. 2019, p. 9237136, 2019.

[18] S. Ruder, “An overview of multi-task learning in deep neural networks,”

arXiv preprint arXiv:1706.05098, 2017.

[19] Y. Zhang and Q. Yang, “An overview of multi-task learning,” National

Science Review, vol. 5, no. 1, pp. 30–43, 2018.

[20] ——,

“A survey

on multi-task

learning,”

arXiv

preprint

arXiv:1707.08114, 2017.

[21] R. Caruana, “Multitask learning: A knowledge-based source of induc-
tive,” In Proceedings of the Tenth International Conference on Machine
Learning., pp. 41–48, 1993.

[22] ——, “Multitask learning,” Machine learning, vol. 28, no. 1, pp. 41–75,

1997.

[23] A. Kendall, Y. Gal, and R. Cipolla, “Multi-task learning using uncer-
tainty to weigh losses for scene geometry and semantics,” in Proceedings
of the IEEE conference on computer vision and pattern recognition,
2018, pp. 7482–7491.

[24] E. Perez, F. Strub, H. De Vries, V. Dumoulin, and A. Courville, “Film:
Visual reasoning with a general conditioning layer,” in Thirty-Second
AAAI Conference on Artiﬁcial Intelligence, 2018.

[25] T. Park, M.-Y. Liu, T.-C. Wang, and J.-Y. Zhu, “Semantic image
synthesis with spatially-adaptive normalization,” in Proceedings of the
IEEE Conference on Computer Vision and Pattern Recognition, 2019,
pp. 2337–2346.

[26] P. Oza and V. M. Patel, “C2ae: Class conditioned auto-encoder for open-
set recognition,” in Proceedings of the IEEE Conference on Computer
Vision and Pattern Recognition, 2019, pp. 2307–2316.

[27] K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image
recognition,” in Proceedings of the IEEE conference on computer vision
and pattern recognition, 2016, pp. 770–778.

[28] J. G. A. Barbedo, L. V. Koenigkan, B. A. Halfeld-Vieira, R. V. Costa,
K. L. Nechet, C. V. Godoy, M. L. Junior, F. R. A. Patricio, V. Talamini,
L. G. Chitarra et al., “Annotated plant pathology databases for image-
based detection and recognition of diseases,” IEEE Latin America
Transactions, vol. 16, no. 6, pp. 1749–1757, 2018.

