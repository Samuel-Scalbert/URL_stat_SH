Limits of Multi-relational Graphs
Juan Aurelio Alvarado, Yuyi Wang, Jan Ramon

To cite this version:

Juan Aurelio Alvarado, Yuyi Wang, Jan Ramon. Limits of Multi-relational Graphs. Machine Learning,
2022. ￿hal-03881631￿

HAL Id: hal-03881631

https://inria.hal.science/hal-03881631

Submitted on 1 Dec 2022

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.

Noname manuscript No.
(will be inserted by the editor)

Limits of Multi-relational Graphs

Juan Alvarado · Yuyi Wang · Jan
Ramon

Received: date / Accepted: date

Abstract Graphons are limits of large graphs. Motivated by a theoretical
problem from statistical relational learning, we develop a generalization of ba-
sic results from graphon theory into the “multi-relational” setting. We show
that their multi-relational counterparts, which we call multi-relational graphons,
are analogically limits of large multi-relational graphs. We extend the cut-
distance topology for graphons to multi-relational graphons and prove its com-
pactness and the density of multi-relational graphs in this topology. In turn,
compactness enables to prove the large deviation principle for Multi-Relational
Graphs (LDP) which enables to prove the most typical random graphs con-
strained by marginal statistics converge asymptotically to constrained multi-
relational graphons with maximum entropy. We show the equivalence between
a restricted version of Markov Logic Network and Multi-Relational Graphons
with maximum entropy.

Keywords Large multigraph · Graphon Theory · Markov Logic Network ·
Large Deviation Principle

1 Introduction

Statistical Relational Learning (SRL, [9]) deals with learning probabilistic
models from relational data. Many popular SRL frameworks, for instance,
Markov Logic Networks (MLNs, Richardson and Domingos [24]), use weighted

(cid:0) J. Alvarado
KU Leuven, Department of Computer Science
E-mail: juan.alvarado@cs.kuleuven.be

Y. Wang
ETH Zurich, Switzerland & CRRC Zhuzhou Institute. E-mail: yuwang@ethz.ch

J. Ramon
INRIA Lille
E-mail: jan.ramon@inria.fr

2

Juan Alvarado et al.

logical formulas to encode statistical regularities that hold for the considered
problem. Typically, maximum (pseudo-)likelihood estimation is used to com-
pute the weights of the formulas based on training data, which is often a
single large example (e.g. a social network). This is problematic because the
weights that are learned from this single training example are in general not
optimal for examples of different sizes. Jain et al. [12] show a detailed example
of a MLN that does not scale on data from different sizes. This turns out to
be a fundamental problem, which cannot simply be solved by rescaling the
weights. Using statistical terminology, the issue is that models such as MLNs
are not projective. Shalizi et al. [26] show that projectivity is essential condi-
tion to ensure consistency of estimated probability distribution along samples
of different sizes. Jaeger et al. [10] shows some examples of non-projective
relational models. An alternative approach to modelling relational structures
using MLNs studied in detail in Kuzelka et al. [15] exploits the fact that MLNs
can be seen as maximum-entropy models constrained by so called relational
marginal statistics. Here, the relational marginal statistics are given by first-
order logic formulas. In particular, given a first-order logic formula α with-
out quantifiers, the respective relational marginal statistic, denoted t(α, ω),
is the probability that a randomly drawn grounding of the formula α will be
satisfied in a given relational structure ω (here, grounding of a formula is a
formula obtained by replacing all its variables by constants). For instance, if
α = friends(x, y) then the respective relational marginal statistic “measures”
the density of the friends relation. Now suppose that we are given formulas
α1, α2, . . . , αm and real numbers t1, t2, . . . , tm and we formulate the following
optimization problem: find the distribution P (ω) on possible worlds over some
given set of domain constants ∆ that (i) satisfies Eω∼P [t(αi, ω)] = ti for each
of the formulas α1, . . . , αm and (ii) has maximum entropy among all distri-
butions satisfying (i). When ω has infinite number of nodes, Radin et al. [23]
show, in the context of Exponential Random Graphs (ERGM), that the most
typical worlds ω of MLN, described by one binary and symmetry relation, are
the graphons with maximum entropy constrained by t(αi, W ) = ti where W
is a graphon.

Equipped with the view of MLNs as maximum-entropy models constrained
by relational marginal statistics, the following problem naturally arises when
approximately modelling very large relational structures. Let us fix a set of first
order-logic formulas α1, α2, . . . , αm and the values t1, t2, . . . , tm and let us
consider the same maximum entropy problem as in the previous paragraph,
however, this time we let |∆| → ∞. What can we say about the resulting
distribution in the limit? It turns out this is a difficult question and at the
moment we do not have much to say about it. However, we can take a look
into the theory of graphons [16] and see what it can offer for problems like this
one.

Graphon theory deals with limits, called graphons, of large dense graphs.
A graphon is any symmetric function W : [0, 1]2 → [0, 1]. From a procedural
point of view, a graphon can be seen as a probabilistic model for graphs. To
sample a random graph G(n, W ) on n vertices from a given graphon W . The

Limits of Multi-relational Graphs

3

set of vertices of the graph is V = {v1, v2, . . . , vn} and it is obtained by picking
n arbitrary objects. The edge set is sampled as follows. Drawing n numbers x1,
x2, . . . , xn from [0, 1] uniformly at random. For every possible edge {vi1, vi2}
we uniformly sample a number yi1,i2 from [0, 1] and if yi1,i2 ≤ W (xi1 , xi2 ),
we add it to the edge set E. At first this may seem to be a very simple and
very restricted model. It may also seem that this model has little to do with
the problem we were talking about. However, the opposite is true. Lovasz and
Szegedy [17] showed a remarkable result, which can be described using the
MLN terminology as follows. Let us consider just one symmetric relation which
will represent edges of undirected graphs. Let us fix a set of constant-free and
quantifier-free first-order logic formulas, representing some small graphs, e.g.
α1 = e(x, y), α2 = e(x, y) ∧ e(y, z), α3 = e(x, y) ∧ e(y, z) ∧ e(z, x). If there is a
sequence of undirected graphs of increasing sizes G1, G2, G3, . . . such that the
limit T = limi→∞(t(α1, Gi), t(α2, Gi), t(α3, Gi)) exists, then there also exists a
graphon W such that EG∼W [(t(α1, G), t(α2, G), t(α3, G))] = T. In fact, Lovasz
and Szegedy showed a stronger result. They showed that graphons are limits
of converging sequences of graphs, but to describe this result precisely, we will
first need to introduce more background (in particular this result only makes
sense after we describe a suitable topology).

Graph homomorphism is the key notion that connects graphons with MLNs.
Any constraint based on a graph homomorphism density and a graph den-
sity number can be translated into a logical formula with a suitable weight
in a MLN. Hence graphons are an alternative for probabilistic modelling of
relational structures constrained by relational marginal statistics. The main
difference is that graphons maximize Boltzmann Entropy and MLNs maxi-
mize Gibbs Entropy. In the parlance of Statistical Mechanics, graphons are
microcanonical ensembles of relational structures and MLNs are canonical en-
sembles. Graphons are also interesting from the computational viewpoint. For
instance, unconditional sampling of graphs from a graphon is extremely easy,
compared to sampling from MLNs.

A crucial limitation of graphons from the knowledge representation per-
spective is that they model only probability distributions over simple undi-
rected unlabeled graphs. In this work, we address this limitation and intro-
duce what we will call multi-relational graphons as a direct generalization of
graphons into the multi-relational setting. Strikingly, we manage to keep both
the simplicity and the theoretical properties of graphons. A multi-relational
graphon turns out to be just a vector of graphons, yet all the elegant proper-
ties of graphons such as topological compactness carry over to multi-relational
graphons. Informally, our main result in the paper is showing the limit of grow-
ing random multi-relational graphs constrained by marginal statistics can be
obtained by solving an optimization problem in the space of multi-relational
graphons.

This potentially opens doors to wider applications of graphons for mod-
elling of large heterogeneous networks: with graphons we could model a net-
work of friends, whereas with multi-relational graphons we can model a net-
work consisting both of friends, acquaintances and families at once. In Section

4

Juan Alvarado et al.

8.3, we show an example of a MLN that is modeled by multi-relational graphon
based on friends and acquaintances relations. Our results may also be poten-
tially useful in the context of the very recently introduced framework called
the AHK model [10], which is a rather general probabilistic model for rela-
tional data. Thus a natural open question would be the generalization of our
results about the limits of constrained sequences of random undirected multi-
relational graphs to arbitrary-arity relational data. This generalization would
give us a principled way to learn AHK models.

This paper is organized as follows. Section 2 introduces Markov logic, multi-
relational graphs, and graphon theory. Section 3 introduces multi-relational
graphon space, graph homomorphism density, and cut-distance topology. Sec-
tion 4 proves the compactness of cut-distance topology. Section 5 is devoted
to prove that the set of multi-relational graphs is dense in the cut-norm
topology. To prove that, we extend the sampling lemmas given by Lov´asz
in his book [16]. Section 6 introduces the large deviation principle for multi-
relational Erd˝os-R´enyi random graphs. This principle enables proving that
the most typical infinite random graphs constrained by any closed region in
the space of multi-relational graphons are solutions of a maximum entropy
problem. Section 7 contains the largest proofs of this paper. In this section,
we need to introduce yet more mathematical preliminaries oriented to show
Alaoglu’s Theorem. This theorem states that the unit ball in the dual space
of any topological vector space is compact. This theorem enables proving an
alternative definition of cut-distance based on couplings. With this alterna-
tive definition, the large deviation principle is proven. Section 8 discusses the
equivalence of probabilistic models based on multi-relational graphons and a
restricted version of MLNs. After that, we show an example of the equivalence
between multi-relational graphons and MLNs. In this section, we also show
why multi-relational graphon models based on Boltzmann entropy are more
natural than maximum entropy models based on Gibbs entropy for modelling
multi-relational data. Section 9 describes the relationship to other works with
multi-relational graphons. First, we show how multi-relational graphs limits
are a special case of Compact Decorated graphs due to Lov´asz and Szegedy
[19]. Second, we show the AHK model is a generalization of multi-relational
graphons. Third we discuss the work of constrained graphons with maximum
entropy done in the field of Statistical Mechanics. These works can be seen as
a special case of constrained multi-graphons with maximum entropy. Finally,
Section 10 gives the conclusions of this paper.

2 Background

In this section we cover the necessary background material. Some basic con-
cepts of Topology and Measure Theory are also reviewed in the appendix.

Limits of Multi-relational Graphs

5

2.1 Basic Notation

We use 1X to denote the indicator function, i.e., if x ∈ X then 1X (x) = 1 else
1X (x) = 0. For any positive integer n, we denote by [n] the set of all positive
integers smaller than or equal to n. We denote by ⌈x⌉ the least integer greater
than or equal to x. For a function f : X × X → Z, we denote by f ⊤ the
function which is its transpose, i.e., ∀x, y ∈ X : f ⊤(x, y) = f (y, x). A sequence
x : N → X is denoted by (xi)∞

i=1.

2.2 First Order Logic

We assume a restricted function-free first-order language defined by a set of
constants ∆, a set of variables V and a set R of binary predicates. Variables
start with lowercase letters and constants start with uppercase letters. A term
is a variable or a constant. An atom is r(a1, a2) with a1, a2 ∈ ∆ ∪ V and
r ∈ R. A literal is an atom or its negation. An expression is ground if it
contains no variables. A substitution is a mapping {a1/t1, . . . , an/tn} where
the ai are distinct variables and the ti are terms. If e is an expression and
θ = {a1/t1, . . . , an/tn} a substitution, then eθ is the expression e where one
has replaced simultaneously the variables ai with the corresponding terms ti.
A possible world ω is represented as a set of ground atoms that are true in
ω. The satisfaction relation |= is defined in the usual way: ω |= α means that
the first-order logic formula α is true in ω. When x is a list of first-order logic
variables then |x| is used to denote the length of this list.

2.3 Markov Logic Networks

A Markov logic network [24] (MLN) is given as a set of weighted first-order
logic formulas (α, w), where w ∈ R and α is a function-free and quantifier-
free first-order formula. The semantics are defined w.r.t. the groundings of the
first-order formulas, relative to a given finite set of constants ∆, called the
domain. An MLN Φ induces the probability distribution over possible worlds
ω ∈ Ω:





pΦ(ω) =

1
Z

(cid:88)

exp



(α,w)∈Φ

w · N (α, ω)

 ,

where N (α, ω) is the number of groundings of α from ∆ satisfied in ω, and Z,
called the partition function, is a normalization constant to ensure that pΦ is
a probability distribution.

In the context of the present paper, we replace N (α, ω) in the definition of

MLNs by the fraction of groundings of α satisfied in ω, i.e.,

Q(α, ω) =

1
|∆||vars(α)|

(cid:88)

1(ω |= αϑ),

ϑ∈Θ(α,∆)

6

Juan Alvarado et al.

where vars(α) is the set of variables occurring in α, Θ(α, ∆) is the set of all
grounding substitutions of α’s variables using constants from ∆ and 1(ω |= αϑ)
is the indicator function, which is equal to 1 when αϑ is true in the possible
world ω, 0 otherwise. Thus, Q(α, ω) is the fraction of the groundings of α
satisfied in ω. With this notation we will write the probability of a possible
world ω ∈ Ω as:

pΦ(ω) =



exp



1
Z

(cid:88)

(α,w)∈Φ



w · Q(α, ω)

 .

The reason this representation is more convenient for us is that Q(α, ω) is
closer to the homomorphism densities used in graphon theory, as we discuss
in Section 2.5.

Another way to look at Markov logic networks is to view them in the max-
entropy framework as a maximum entropy distribution satisfying the given
marginal constraints E[Q(αi, .)] = θi (along the lines of [27]). Assuming we
are given constraints on the expected values of the statistics E[Q(αi, .)] for
a set of formulas Φ = {α1 . . . α|Φ|}, we can define the following max-entropy
problem of finding a maximum entropy distribution satisfying the constraints
on the expected values.

Relational Marginal Problem (Formulation):

min
{Pω : ω∈Ω}

(cid:88)

ω∈Ω

Pω log Pω

s.t.

∀i = 1, . . . , m :

(cid:88)

ω∈Ω

Pω · Q(αi, ω) = θi

∀ω ∈ Ω : Pω ≥ 0,

(cid:88)

ω∈Ω

Pω = 1

(1)

(2)

(3)

Here, the Pω’s are the problem’s decision variables, each of which represents
the probability of one possible world ω ∈ Ω. Line (1) is the maximum Gibbs
entropy criterion, which is shown here as the minimization of the negative
entropy; Line (2) shows the constraints given by the statistics; and Line (3)
provides the normalization constraints for the probability distribution.

(cid:16)(cid:80)

Assuming there is a feasible solution satisfying ∀ω : Pω > 0, the op-
timal solution of the above maximum entropy problem is an MLN Pω =
1
Z exp
where the parameters w = (w1, . . . , wm) are
obtained by maximizing the dual criterion, which also happens to be equiva-
lent to the log-likelihood of the MLN (we refer to [15] for details in the MLN
context).

(αi,wi)∈Φ wi · Q(αi, ω)

(cid:17)

Limits of Multi-relational Graphs

7

2.4 Graphs and Multi-Relational Graphs

An undirected graph G is a pair (V, E) where V is a finite set of vertices and
E ⊆ {e ⊆ V||e| = 2} is a set of edges. Two vertices are said to be adjacent
(in G) if they are connected by an edge (of the graph G). A multi-relational
undirected graph is a triple (V, E, λ), where (V, E) is an undirected graph
and λ : E → 2Σ is a function assigning a set of labels from a finite alphabet
Σ = {l1, . . . , lr} to every element of E. Alternatively, a multi-relational graph
can be represented as a tuple (V, E1, E2, . . . , Er) where Ei consists of the
edges e for which li ∈ λ(e), i.e. which have label li among their labels. We
will use this latter representation in this paper because it will turn out to be
convenient for constructing limits of multi-relational graphs. Note that simple
graphs are a special case of multi-relational graphs. Given a multi-relational
graph G = (V, E1, E2, . . . , Er) we use the notation V(G) = V to refer to the
set of vertices of G. The set of multi-relational graphs is denoted by G[r].
1 , . . . , EF
r

(cid:1) to
a multi-relational graph G = (V, E1, . . . , Er) is a mapping φ : VF → V such
that for all i ∈ {1, 2, . . . , r} it holds that if {u, v} ∈ EF
i then {φ(u), φ(v)} ∈ Ei.
Informally, homomorphisms are mappings that preserve edges and their labels.
The set of all homomorphisms between F and G is denoted Hom(F, G).

A homomorphism from a multi-relational graph F = (cid:0)VF , EF

Next we define homomorphism density of F in G, denoted t(F, G), as:

t(F, G) =

| Hom(F, G)|
|V(G)||V(F)|

.

(4)

2.5 Graphons

A graphon is the limit of a sequence of growing undirected graphs w.r.t. a
certain topology that we describe below. It can be represented as a measurable
function W : [0, 1]2 → [0, 1] satisfying W = W ⊤. The space of graphons W is
defined as

W := {W : [0, 1]2 → [0, 1] | W is measurable and W = W ⊤}.

The space W is a subspace of WR = {W : [0, 1]2 → R | W is measurable and W =
W ⊤}. The space WR is endowed with the topology induced by the cut-norm,

∥W ∥(cid:50) := sup

S,T ⊆[0,1]

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

S×T

W (x, y)dxdy

(cid:12)
(cid:12)
(cid:12)
(cid:12)

.

Let Σ be the set of bijective measure preserving maps σ : [0, 1] → [0, 1]. Let
W ∈ W and let σ ∈ Σ. Then W σ : [0, 1]2 → [0, 1] is defined by W σ(x, y) :=
W (σ(x), σ(y)). The space of unlabeled graphons (cid:102)W, shortly called the graphon
space, is the quotient of the space of graphons W w.r.t. the equivalence relation
∼ on W defined by W ∼ V iff there is σ ∈ Σ such that W = V σ. Hence we
can also write (cid:102)W := W/ ∼.

8

Juan Alvarado et al.

The Unlabeled Graphon Space (cid:102)W is endowed with a topology induced by

the cut-distance:

where V, W ∈ (cid:102)W.

δ(cid:50)(W, V ) = inf
σ∈Σ

∥W − V σ∥(cid:50)

Lov´asz [17] shows that ( (cid:102)W, δ(cid:50)) is a compact topological space. Hence any

sequence (xn)∞

n=1 in (cid:102)W has a convergent subsequence.

2.5.1 Graphons as Random-Graph Models

Graphons can also be seen as non-parametric random graph models. Given a
graphon W and a positive integer n, we can use W to sample random graphs
on n vertices as follows:

1. Let V = {v1, v2, . . . , vn}.
2. Sample uniformly n numbers x1, x2, . . . , xn from the interval [0, 1].
3. For every vi, vj, where i < j, sample uniformly a number yi,j from [0, 1].
4. Let E = {{vi, vj}|i < j and yi,j ≤ W (xi, xj)}.
5. Return G = (V, E).

Hence, intuitively, we can view a graphon as defining a “probabilistic” adja-
cency matrix over an uncountable set of vertices.

2.6 Stepfunctions

Stepfunctions are graphons that can be described by a finite number of pa-
rameters. First, the probability polytope P (m), where m is a positive integer,
is defined by

P (m) :=

(cid:40)

π ∈ [0, 1]m (cid:12)
(cid:12)
(cid:12)

(cid:41)

πi = 1

.

(cid:88)

i

Next we define the notion of m-stepfunction, which will be a central tool in
the next sections,

Definition 1 Let λ be the Lebesgue measure on R, let P = {P1, · · · , Pm} be
a partition of [0, 1], let π ∈ P (m) such that λ(Pi) = πi, let A ∈ [0, 1]m×m be a
symmetric m × m matrix on [0, 1]. Then an m-stepfunction (A, π) : [0, 1]2 →
[0, 1] is a function locally constant on Pi × Pj for all i, j ∈ [m], more precisely

(A, π) :=

m
(cid:88)

i,j=1

Ai,j1Pi×Pj .

The set of stepfunctions is denoted by W (m).

Limits of Multi-relational Graphs

9

3 Multi-Relational Graphons

In this section we introduce multi-relational graphons, which, as we show later,
are limits1 of convergent series of multi-relational graphs. The multi-relational
graphons introduced here can also be seen as special cases of the decorated
graphons given in Lov´asz [19]. However, as we will show, they are simpler to
work with.

3.1 Multi-relational Graphon Space

We start by defining multi-relational graphons, which are the multi-relational
counterparts of graphons. First, let us recall that the space of graphons W
from Section 2.5 is the following

W := {W : [0, 1]2 → [0, 1] | W is measurable, W = W ⊤}

Since every multi-relational graph G can be represented as a vector of graphs
[G1, · · · , Gr] with a common node set, intuitively we might expect that the
limit of a sequence of multi-relational graphs can be represented as a vector of
graphons. Later we will see that this definition makes sense and gives us all the
desired theoretical properties. Hence, we identify the space of multi-relational
graphons, denoted W [r], with the cartesian product of r copies of the graphon
space W:

Definition 2 (Graphon space)

W [r] := {W : [0, 1]2 → [0, 1]r | Wk : [0, 1]2 → [0, 1]
k for all k ∈ [r]}.

is measurable, Wk = W ⊤

Moreover we extend the cut-norm to the multi-relational graphon space by

∥W ∥[r]

(cid:50) =

r
(cid:88)

i=1

∥Wi∥(cid:50).

(5)

Note that when r = 1, W [r] is reduced to the graphon space W. Hereafter, we
assume that every multi-relational graphon is a vector of r graphons.

Moreover later we need some additional notations for graphon and multi-

relational graphon whose values are in [−1, 1].

W[−1,1] := {W : [0, 1]2 → [−1, 1] | W is measurable and W = W ⊤}.

and

W [r]

[−1,1] := {W : [0, 1]2 → [−1, 1]r | W is measurable and for all i ∈ [r]Wi = W ⊤
1 What precisely we mean by being a limit is explained later.

i }.

10

Juan Alvarado et al.

3.2 Unlabeled Multi-Relational Graphon Space

Next we define the space of unlabeled multi-relational graphons, completely
analogously to how the space of unlabeled graphons is defined.

Definition 3 Let W ∈ W [r] and let σ ∈ Σ then the action of σ on W is
defined by,

[W1, · · · , Wr]σ = [W σ

1 , · · · , W σ
r ].

We define the space of unlabeled multi-relational graphons (cid:102)W [r] as the quotient
of W [r] by the equivalence relation ∼ on W [r] defined by W ∼ V iff there exists
an action σ ∈ Σ such that W = V σ, Hence (cid:102)W [r] := W [r]/ ∼.

3.2.1 Multi-Relational Graphons as Probabilistic Models

Like graphons, multi-relational graphons can also be seen as non-parametric
multi-relational random graph models. Given a multi-relational graphon W =
(W1, W2, . . . , Wr) and a positive integer n, we can use W to sample random
multi-relational graphs on n vertices as follows (we highlight the differences
from sampling from simple graphons using text in italics):

1. Let V = {v1, v2, . . . , vn}.
2. Sample n numbers x1, x2, . . . , xn uniformly from the interval [0, 1].
3. For every vi, vj, where i < j, sample r numbers y(1)

i,j . . . , y(r)

i,j , y(2)

i,j uniformly

from [0, 1].

4. For all k ∈ {1, 2, . . . , r}, let Ek = {{vi, vj}|i < j and y(k)
5. Return G = (V, E1, E2, . . . , Er).

i,j ≤ Wk(xi, xj)}.

3.3 Counting Multi-Relational Graph homomorphisms

Let F and G be multi-relational graphs with the same number of relations
r. Additionally, we assume that G has node and edges weights. To compute
|Hom(F, G)|, we extend the formulas given in Section 5.2.1 in Lov´asz [16] to
count graph homomorphism on weighted graphs to the multi-relational case.
For any k ∈ [r] and vertices i, j ∈ V (G), let αi ∈ R+ and let βk,ij ∈ R+ be
non-negative weights.

To every map ϕ : V (F) → V (G), we assign the weights

(cid:89)

αϕ =

αϕ(u)(G)

u∈V (F )

and

|Homϕ(F, G)| =

r
(cid:89)

(cid:89)

k=1

(uv)∈Ek(F)

βk,ϕ(u)ϕ(v).

Moreover, we define

Limits of Multi-relational Graphs

|Hom(F, G)| =

(cid:88)

αϕ|Homϕ(F, G)|.

ϕ:V (F)→V (G)

11

(6)

In the sequel of this paper, unless explicitly stated otherwise we will assume
that αv = 1 for all v ∈ V (G). In particular, if we set the node weights αϕ = 1,
there follows from Equations (4) and (6) that

t(F, G) =

m
(cid:88)

x1=1

1
m

· · ·

m
(cid:88)

xn=1

1
m

r
(cid:89)

(cid:89)

k=1

uv∈Ek(F)

βk,xuxv

(7)

where m = |V (G))| and n = |V (F))|. G can be seen as a vector of step-
functions on the unit square whose value for the relation k at the square
[(i−1)/|V (G)|, i/|V (G)|)×[(j −1)/|V (G)|, j/|V (G)|) is βk,ij for i, j ∈ [|V (G)|].
In this way G is a measurable function, hence when V (G) → ∞ in a converg-
ing sequence we have that G → W converges to a measurable function W by
Lebesgue’s Dominated Convergence Theorem. Hence we arrive to the formula
to compute the density of multi-relational graph homomorphisms,

(cid:90)

t(F, W ) =

r
(cid:89)

(cid:89)

Wk(xu, xv)

(cid:89)

dxu.

(8)

[0,1]|V (F)|

k=1

(uv)∈Ek(F )

u∈V (F)

Note that the above formula computes the density of multi-relational graph ho-
momorphism from F into a multi-relational graph W with uncountable many
nodes from [0, 1].

In this paper, it is convenient to define F as a generalization of signed
graphs from Lov´asz [16] in the context of multi-relational graphs. Suppose
that the edges of each relation Ei of a multi-relational graph F are partitioned
into two sets E+
i . Then the tuple F = (V, E+
r ) will
be called a multi-relational signed graph. The subgraph density of F in a
multi-relational graphon is,

i and E−

1 , · · · , E+

1 , E−

r , E−

(cid:90)

t(F, W ) =

r
(cid:89)

(cid:89)

Wk(xu, xv)

(cid:89)

(1−Wk(xu, xv))

(cid:89)

dxu.

[0,1]|V (F)|

k=1

(uv)∈E+

k (F )

(uv)∈E−

k (F )

u∈V (F)
(9)

3.4 Cut Distance on (cid:102)W [r]

We already have a topology based on the cut norm for the space of multi-
relational graphons W [r] that we defined in (5) above. Now, we use it to also
endow the space of unlabeled multi-relational graphons (cid:102)W [r] with a topology
by defining the cut-distance on it.

Let W, V ∈ (cid:102)W [r]

δ[r]
(cid:50) (W, V ) = inf
σ∈Σ

∥W − V σ∥[r]
(cid:50)

The following lemma shows bounds for δ[r]
(cid:50) .

12

Juan Alvarado et al.

Lemma 1 Let W, V ∈ (cid:102)W [r] be unlabeled multi-relational graphons, then

r
(cid:88)

k=1

δ(cid:50)(Wk, Vk) ≤ δ[r]

(cid:50) (W, V ) ≤ ∥W − V ∥[r]
(cid:50)

Proof Note that

r
(cid:88)

k=1

δ(cid:50)(Wk, Vk) =

r
(cid:88)

k=1

inf
σk∈Σ

∥Wk − V σk

k ∥(cid:50) =

inf
σ1,··· ,σr∈Σ

r
(cid:88)

k=1

∥Wk − V σk

k ∥(cid:50)

≤ inf
σ∈Σ

r
(cid:88)

k=1

∥Wk − V σ

k ∥(cid:50) = δ[r]

(cid:50) (W, V ).

Hence we obtain
r
(cid:88)

k=1

δ(cid:50)(Wk, Vk) ≤ δ[r]

(cid:50) (W, V ) ≤

r
(cid:88)

k=1

∥Wk − Vk∥(cid:50).

Remark 1 Note that the norm ∥ · ∥[r]
(cid:50) is the sum of ∥ · ∥(cid:50). Hence every result
that shows an upper bound for the norm ∥ · ∥ on W for graphons can be
extended easily to an upper bound for multi-relational graphons by the sum
of individual upper bounds.

⊓⊔

4 Compactness on (cid:102)W [r]

In this section we prove that the space ( (cid:102)W [r], δ[r]
(cid:50) ) is compact. To do that we
extend the weak regularity lemma for graphons given Corollary 9.13 in Lov´asz
[16].

4.1 Weak Regularity Lemma for multi-relational Graphons

The weak regularity lemma, which is known to hold for graphons, asserts
that every graphon can be arbitrarily approximated by stepfunctions. Here we
extend the weak regularity lemma to multi-relational graphons.

To state the weak regularity lemma, we need the notion of a stepping
operator. Intuitively, a stepping operator for multi-relational graphons takes
an arbitrary multi-relational graphon and produces a multi-relational graphon
which approximates the original graphon and which is a step function.

Definition 4 (Stepping Operator for graphons) Let P := {P1, · · · , Pm}
be a partition of [0, 1] and W ∈ W. Then TP (W ) is the m-stepfunction defined
by

TP (W )(x, y) =

W (u, v)dudv

(cid:90)

1
λ(Pi)λ(Pj)

Pi×Pj

where (x, y) ∈ Pi × Pj and λ(A) is the Lebesgue measure of A.

Limits of Multi-relational Graphs

13

It is clear that the stepping operator TP is a map from W to W (m) where
m = |P |.

Now we generalize the stepping operator TP (W ) for multi-relational graphons.

Definition 5 (Stepping Operator for Multi-relational graphons) Let
P = [P1, · · · , Pr] be a vector of partitions of [0, 1] and W ∈ W [r] be a multi-
relational graphon then

TP (W ) = [TP1(W1), · · · , TPr (Wr)].

The next theorem from [16] can be proven using the weak regularity lemma

(Lemma 9.9 in Lov´asz [16]).

Theorem 1 (Corollary 9.13 in Lov´asz [16]) For every function W ∈ W
and k ≥ 1 there is a partition P of [0, 1] into at most k sets with positive
measure for which

∥W − TP (W )∥(cid:50) ≤

2
(cid:112)log2 k

Definition 6 Let P = {P1, · · · , Pk} be a partition of [0, 1]. We say that P is
an equipartition P with k classes if λ(Pi) = 1/k for all i ∈ [k].

Lemma 2 (Lemma 9.15 in Lov´asz [16] )
k.

Let W ∈ W[−1,1] and 1 ≤ m <

(a) For every m-partition Q of [0, 1] and k > m there is a partition with k

classes P refining Q such that

∥W − TP (W )∥(cid:50) ≤

2
(cid:112)log2(k/m)

.

(b) For every m-partition Q of [0, 1] and k > m there is an equipartition P

with k classes such that

∥W − TP (W )∥(cid:50) ≤ 2∥W − TQ(W )∥(cid:50) +

2m
k

Definition 7 (ϵ-partition) Let P = [P1, P1, . . . , P1]
(cid:125)

(cid:124)

be a vector of partitions

(cid:123)(cid:122)
r times

of [0, 1] with the same classes. Let ϵ > 0 and let W ∈ W [r]. We say that P is
an ϵ-partition for W if

∥W − TP (W )∥[r]

(cid:50) ≤ ϵ.

The next theorem proves the existence of an ϵ-partition for any W ∈ W [r].

Theorem 2 For every graphon W ∈ W [r] and k ≥ 1 such that k1/r ∈ N.
Then, there exists a partition P such that

∥W − TP (W )∥[r]

(cid:50) ≤

2r3/2
(cid:112)log2 k

.

14

Juan Alvarado et al.

Proof Let k1 ≥ 1 be an integer. By Theorem 1, for every i ∈ [r] there is a
k1-partition Qi of [0, 1] such that

∥Wi − TQi(Wi)∥(cid:50) ≤

2
(cid:112)log2 k1

.

For s ∈ [k1]r let Q∩
the point x is in the si-th partition class of Qi. The set Q∩ = {Q∩
is a partitioning of [0, 1]. Let k = kr
Q∩ is a refinement of Qi for each i ∈ [r], so there holds

s ⊆ [0, 1] be the set of all x ∈ [0, 1] such that for all i ∈ [r]
s | s ∈ [k1]r}
1 = |Q∩| be the number of classes of |Q∩|.

∀i ∈ [r] : ∥Wi − TQ∩(Wi)∥(cid:50) ≤

2
(cid:112)log2 k1

=

2r1/2
(cid:112)log2 k

and hence

∥W − TQ∩(W )∥(cid:50) ≤

2r3/2
(cid:112)log2 k

⊓⊔

4.2 Compactness on (cid:102)W [r]

We have all ingredients to prove compactness of (cid:102)W [r].

Theorem 3 The space ( (cid:102)W [r], δ[r]

(cid:50) ) is compact.

This proof is almost identical to the proof of Theorem 5.1 in Lov´asz [18] except
that we use a vector of stepfunctions instead of a single stepfunction and we
make use of ϵ-partitions.

Proof Let W1, W2, · · · be a sequence of vectors of graphons in W [r]. We will
construct a subsequence that has a limit in (cid:102)W [r].

For each k and n, using Theorem 2, we construct an ϵ-partition Pn,k such
that these partitions and the corresponding stepfunctions Wn,k = TPn,k (W ) ∈
W [r] satisfy the following.

– ∥Wn − Wn,k∥[r]
– |Pn,k| = mk (where mk depends only on k).
– The partition Pn,k+1 refines Pn,k for every k.

(cid:50) ≤ 1/k.

The rest of the proof follows verbatim from the analogous proof of Theorem
5.1 from [18] except that we use a vector of stepfunctions instead of one step-
function.

⊓⊔

Any multi-relational graph G[r] has a natural representation as multi-

relational graphon in terms of adjacency matrices:

Limits of Multi-relational Graphs

15

Definition 8

f G[r]
k

(x, y) =

(cid:40)
1
0

if (v⌈nx⌉, v⌈ny⌉) ∈ Ek(G[r])
otherwise

where n = |V (G[r])|. Hence f G[r]
Eqs. (7) and (8), it is not difficult to verify t(F, G) = t(F, f G).

(x, y) is a representation of G[r] in (cid:102)W [r]. From

k

n )∞

n=1 represented by (f G[r]

Compactness of (cid:102)W [r] ensures that any sequence of growing multi-relational
graphs (G[r]
n )∞
n=1 has at least a subsequence with
a limit. In the next section, we will prove that such limits of sequences of
multi-relational graphons (f G[r]
n=1 constrained to a closed set H ⊂ (cid:102)W [r] are
solutions of a maximum entropy problem.

n )∞

5 Density of multi-relational graphs

The weak regularity lemma shows that the set of stepfunctions ∪m>0W (m) is
dense in W [r] and the set of multi-relational graphs is a subset of W (m) via
the representation G (cid:55)→ f G. To show the space of unlabeled multi-relational
graphons is the appropriate limit space for multi-relational graphs, we need
to prove that the set of multi-relational graphs G[r] is dense in (cid:102)W [r] via the
identification G (cid:55)→ f G. To do that, we extend Theorem 4.7 [4] due to Borgs,
Chayes, Lov´asz, S´os and Vesztergombi to the multi-relational setting. This
theorem states that a sample is close to the original graphon with high prob-
ability.

We start by extending the notion of W -sampling for multi-relational graphons.

5.1 W -sampling for multi-relational graphons

Definition 9 (Sampling weighted multi-relational graphs) Let W ∈
W [r] and let S = {x1, · · · , xn} ⊂ [0, 1] be an ordered set, then we denote by
H(S, W ) the multi-relational weighted graph [H!, · · · , Hr] obtained from W =
[W1, · · · , Wr] by assigning the common node set to V (H(S, W )) = {1, · · · , n}
and the weight for Hk is equal to

βk,ij(H(S, W )) =

(cid:40)

Wk(xi, xj)
0

If i ̸= j
If i = j

.

for all 1 ≤ k ≤ r. If S is a random k-subset of [0, 1] drawn uniformly then we
write H(n, W ) instead of H(S, W ).

Definition 10 (Sampling of random graphs from weighted multi-
relational graphs) Let H be a weighted multi-relational graph. Then G(H)
is a random multi-relational graph obtained by connecting different nodes
i and j by an edge of class k with probability βk,ij(H) ∈ [0, 1] indepen-
dently of the sampling of other edges. Hence, we can construct a random
graph G(S, W ) = G(H(S, W )).

16

Juan Alvarado et al.

Definition 11 (Sampling of random graphs from multi-relational
graphons) Let W ∈ (cid:102)W [r] and let n be a positive integer. Let S be a random
k-subset of [0, 1] sampled uniformly. Then G(n, W ) is a random graph obtained
by G(S, W ).

Note that the sampling from G(n, W ) extends the sampling procedure of
graphs from a graphon given in Section 2.5.1.

Definition 12 (Multi-relational graph parameter) Recall that G[r] is
the set of multi-relational graphs. A multi-relational graph parameter is a
function f : G[r] → R defined on multi-relational, not necessarily loop-free
graphs which is invariant under graph isomorphism. For example any multi-
relational subgraph density t(F, ·) is a multi-relational graph parameter.

Hence it is clear that f (G(n, W )) is a random variable. The next lemma shows
a concentration measure inequality for the multi-relational graph parameters.

Lemma 3 (Lemma 4.1 [4]) Let k be a positive integer, and let C > 0. Let
Z = (Z1, · · · , Zs), where Z1, · · · , Zs are independent random variables, and Zi
takes values in some measure space (Ωi, Ai). Let f : Ω1 × · · · × Ωs → R be a
measurable function. Suppose that |f (x)−f (y)| ≤ C whenever x = (x1, · · · , xs)
and y = (y1, · · · , ys) differ only in one coordinate. Then

P(f (Z) > E[f (Z)] + λC) < exp(−

λ2
2s

)

Remark 2 Let f : G[r] → R be a multi-relational graph parameter and suppose
f is bounded. Let fq : [0, 1]q → R with fq(S) = f (G(S, W )). Then fq satisfies
the condition of the above lemma since there is a C such that |fq(x) − fq(y)| ≤
C whenever x = (x1, · · · , xq) and y = (y1, · · · , yq) differ only in one coordinate.

5.1.1 Sampling Lemmas

The goal of this section is the extension of Theorem 4.7 [4] to the multi-
relational setting. To do that, we extend a set of lemmas from Chapter 10
in [16] and finally extend Theorem 4.7. We name this extension the second
sampling lemma for multi-relational graphons.

Lemma 4 (The First Sampling Lemma for graphons. Lemma 10.6 in
[16]) Let U ∈ W[−1,1] and let X be a random ordered k-subset of [0, 1]. Then
with probability at least 1 − 4 exp(−

k/10),

√

−

3
k

≤ ∥U [X]∥(cid:50) − ∥U ∥(cid:50) ≤

8
k1/4

.

From the first sampling lemma, we prove the following.
Lemma 5 Let k > 1 be a positive integer. Let U ∈ W [r]
random ordered k-subset of [0, 1]. Then,

[−1,1] and let X be a

(cid:104)
∥U [X]∥[r]

(cid:50) − ∥U ∥[r]
(cid:50)

(cid:105)

E

≤

14r
k1/4

.

Limits of Multi-relational Graphs

17

Proof From Remark 1 and the linearity of the expectation, it is sufficient to
prove that

14
k1/4
for any V ∈ W[−1,1]. Let z = ∥V [X]∥(cid:50) − ∥V ∥(cid:50), thus

E [∥V [X]∥(cid:50) − ∥V ∥(cid:50)] ≤

.

E[z] = E

(cid:20)
z(cid:12)
(cid:12) −

3
k

≤ z ≤

(cid:20)
z(cid:12)
(cid:12)z < −

+E

3
k

−

3
k

(cid:18)

(cid:18)

P

(cid:21)

P

(cid:21)

8
k1/4
8
k1/4

≤ z ≤

(cid:19)

8
k1/4

3
k

∨ z ≥

(cid:19)

8
k1/4

∨ z ≥

z < −

In the second term we can bound E (cid:2)z|z < −3/k ∨ z ≥ 8/k1/4(cid:3) ≤ 1 because
z ∈ [−1, 1], and by applying Lemma 4 on V and k > 1 we can bound
√
P (cid:0)z < −3/k ∨ z ≥ 8/k1/4(cid:1) ≤ 4 exp(−
k/10). In the second term, from Lemma
4 we can bound E (cid:2)z| − 3/k ≤ z ≤ 8/k1/4(cid:3) ≤ 8/k1/4 and the probability is at
most 1. There follows

E[z] ≤

8
k1/4

+ 4 exp(−

√

k
10

) ≤

14
k1/4

.

where the last inequality can be verified numerically.

⊓⊔

We also extend a consequence of Lemma 10.11 [16].

Lemma 6 (Lemma 10.11 [16]) For every edge-weighted multi-relational graph
H with k nodes and edge weights in [0, 1], and for every ε ≥ 10/

k, we have

√

P rob(∥G(H) − H∥(cid:50) > ε) ≤ exp(−ε2k2/100).

First we prove a consequence of the above lemma in the setting of simple
graphs.

Lemma 7 For every edge-weighted simple graph H with k nodes and edge
weights in [0, 1], we have

E [∥G(H) − H∥(cid:50)] ≤

11
√
k

Proof By applying Lemma 6 with ε = 10/

√

k, we have

(cid:18)

∥G(H) − H∥(cid:50) >

P

(cid:19)

10
√
k

≤ exp(−k).

(10)

We abbreviate ∥G(H) − H∥(cid:50) by z. Hence

E[z] = E

(cid:20)
z

(cid:12)
(cid:12)
(cid:12) z >

(cid:21)

P

10
√
k

(cid:18)

z >

(cid:19)

10
√
k

+ E

(cid:20)
z

(cid:12)
(cid:12)
(cid:12)z ≤

10
√
k

(cid:18)

(cid:21)

P

z ≤

(cid:19)

10
√
k

18

Juan Alvarado et al.

From (10) and knowing the distance z = ∥G(H) − H∥(cid:50) in bounded by 1, we
have

E[z] ≤ E

(cid:20)
z

(cid:12)
(cid:12)
(cid:12) z >

≤ exp(−k) +

(cid:21)

10
√
k
10
√
k

exp(−k) + E

(cid:20)
z

(cid:12)
(cid:12)
(cid:12) z ≤

(cid:21)

10
√
k

≤

11
√
k

.

⊓⊔

We can extend the above lemma to the multi-relational setting.

Lemma 8 For every edge-weighted multi-relational graph H with k nodes and
edge weights in [0, 1], we have

E(∥G(H) − H∥[r]

(cid:50) ) ≤

11r
√
k

Proof From Lemma 7 and Remark 1, the proof is immediate.

⊓⊔

Lemma 9 Let V ∈ (cid:102)W [r] be a stepfunction of q steps and let k be a positive
integer. Then

E[δ(cid:50)(V, H(k, V ))] ≤ r

(cid:114) q
k

Proof We follow the same ideas as the proof of Theorem 4.7 in [4].

Let V have steps J1, · · · , Jq ⊆ [0, 1], and λ(Ji) = αi. Let X1, · · · , Xk be
independent random variables that are uniformly distributed on [0, 1], and let
Zi be the number of points Xj that fall into the set Ji. Hence we have

E[Zi] = αik,

V ar(Zi) = (αi − α2

i )k ≤ αik.

Construct a partition of [0, 1] into measurable sets J ′
Zi/k and

1, · · · , J ′

q such that λ(J ′

i) =

λ(J ′

i ∩ Ji) = min(αi, Zi/k).

We define a symmetric function V ′ ∈ W such that the value of V ′ on J ′
j is
the same as the value of V on Ji ×Jj. Then V ′ is a step function representation
of H(k, V ), and it agrees with V on the set Q = ∪q
j). Let
∥W ∥[r]
i ∥Wi∥1 be the extension of the L1 norm to W [r]. Thus we have

i,j=1(Ji ∩ J ′

i) × (Jj ∩ J ′

1 = (cid:80)

i × J ′

δ(cid:50)(V, H(k, V )) ≤ ∥V − V ′∥[r]

(cid:50) ≤ ∥V − V ′∥[r]



= r

1 −

(cid:32)

(cid:88)

(cid:18)

min

αi,

1 ≤ r(1 − λ(Q))
(cid:19)(cid:33)2

(cid:32)

 ≤ 2r

1 −

Zi
k

(cid:88)

(cid:18)

min

αi,

(cid:19)(cid:33)

Zi
k

(cid:88)

= r

i

(cid:12)
(cid:12)
(cid:12)
(cid:12)

αi −

i

Zi
k

(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:32)
q

≤ r

(cid:18)

(cid:88)

αi −

i

i

.

(cid:19)2(cid:33)1/2

Zi
k

Limits of Multi-relational Graphs

19

Thus we have

It follows,

δ(cid:50)(V, H(k, V ))2 ≤ qr2 (cid:88)

i

(cid:18)

αi −

(cid:19)2

.

Zi
k

E[δ(cid:50)(V, H(k, V ))2] ≤ qr2 (cid:88)

E

(cid:19)2(cid:35)

(cid:34)(cid:18)

αi −

Zi
k

=

qr2
k2

(cid:88)

i

V ar(Zi)

<

qr2
k2

i

(cid:88)

i

kαi =

qr2
k

.

Because δ(cid:50)(V, H(k, V )) ≥ 0 there follows by Cauchy-Schwartz

E[δ(cid:50)(V, H(k, V ))] ≤ r

(cid:114) q
k

.

⊓⊔

Now, we have all the ingredients to extend the second sampling lemma.

Lemma 10 Extension of Theorem 4.7 in [4] (Second Sampling Lemma for
Multi-Relational Graphons). Let k ≥ 1, and let W ∈ (cid:102)W [r] be a multi-relational
graphon. Then with probability at least 1 − exp(−kr/(2 log2 k)),

δ[r]
(cid:50) (G(k, W ), W ) ≤

36r3/2
(cid:112)log2 k

(11)

One direct consequence of Lemma 10 is that the set of multi-relational graphs
is dense in ( (cid:102)W [r], δ[r]

(cid:50) ).

Theorem 4 The set of multi-relational graphs is dense in ( (cid:102)W [r], δ[r]

(cid:50) ).

Proof It is sufficient to prove that for any W ∈ (cid:102)W [r] and ϵ > 0, there is a
multi-relational graph G such that δ[r]
(cid:50) (G, W ) ≤ ϵ. There is a sufficient large k
log k . Then, from Lemma 10 there holds δ[r]
(cid:50) (G(k, W ), W ) ≤ ϵ
such that ϵ ≥ 37r√
with probability at least 1 − exp(−k/(2 log k)) > 0 so at least one of the multi-
relational graphs which can be obtained by sampling from G(k, W ) has the
⊓⊔
required property.

From the above theorem, any multi-relational graphon can be seen as the limit
of a sequence of multi-relational graphs.

20

Juan Alvarado et al.

6 Large Deviation Principle and the Principle of
Maximum-Entropy

The large deviation principle (LDP) establishes lower and upper bounds for the
limiting behaviour of a sequence of probability distributions. More precisely [7],
let X be a topological space. A sequence of probability distributions (Pn)∞
n=1
satisfies LDP when there is a function I : X → R, called the rate function such
that for every Γ ⊂ X and sequence (ϵn)n∈N with limit ϵn → 0, the probability
measure of the set Γ , Pn(Γ ), satisfies the following inequality. Recall Γ and
Γ ◦ are closure and interior of Γ ⊂ X .

− inf
x∈Γ ◦

I(x) ≤ lim inf
n→∞

ϵn log Pn(Γ ) ≤ lim sup
n→∞

ϵn log Pn(Γ ) ≤ − inf
x∈Γ

I(x).

In this section, we extend the large deviation principle for Erd˝os-R´enyi
random graphs due to Chatterjee and Varadhan [5] to multi-relational Erd˝os-
R´enyi random graphs.

The negative of the rate function can be interpreted as an entropy function.
We will see that −I(W ) is a density of entropy of multi-relational random
graphs sampled from W . Note that if inf x∈Γ ◦ I(x) = inf x∈Γ I(x) then the
limiting probability distribution is the probability distribution with maximum
entropy. We prove this property for any closed region constrained by densities
of multi-relational subgraphs.

Based on the compactness of graphon space, Chatterjee and Varadhan [5]
developed the large deviation principle for limiting behavior of the probability
measure (cid:101)Pn,p induced by Erd˝os-R´enyi random graphs G(n, p) on the unlabeled
graphon space (cid:102)W.

Here, we first need to extend the Erd˝os-R´enyi random-graph model G(n, p)

to multi-relational graphs and define the rate function.

Definition 13 (Erd˝os-R´enyi multi-relational random graphs) Let p ∈
[0, 1]. Then Erd˝os-R´enyi multi-relational random graphs G[r](n, p) are r-tuple
of independent draws of G(n, p), where we identify the vertices across all r
graphs.

Definition 14 (Rate function) Let p ∈ (0, 1). Then the rate function I [r]
p
(cid:102)W [r] → R is defined by,

:

I [r]
p (W ) =

1
2

r
(cid:88)

(cid:90)

k=1

[0,1]2

I0,p(Wk(x, y))dxdy

where I0,p(u) = 1

2 u log u

p + 1

2 (1 − u) log

(cid:16) 1−u
1−p

(cid:17)

.

Remark 3 Note that the negative of I0,p is the entropy of the Bernoulli distri-
bution. Hence −Ip(W ) can be seen as a density of entropy produced by large
random graphs sampled from W . From a statistical mechanics point of view
[23], −Ip(W ) corresponds to the Boltzmann entropy of the microcanonical
ensemble of random edges W .

Limits of Multi-relational Graphs

21

Let Pn,p be the probability measure on W induced by f G(n,p) and more
generally let P[r]
n,p be the probability measure on W [r] induced by f G[r](n,p).
In the same way, let (cid:101)P[r]
n,p be the probability measure on (cid:102)W [r] induced by
(cid:101)f G[r](n,p), where (cid:101)f G is the equivalence class of f G induced by the permutations
of rows/columns on f G.

Now we state our main technical result which is a generalization of the

corresponding large deviation result from [5],

Theorem 5 (Extension of Theorem 2.3 [5]) For each fixed p ∈ (0, 1), the
sequence (cid:101)P[r]
n,p satisfies a large deviation principle in the cut-distance topology.
That is, for every closed set F ⊂ (cid:102)W

lim sup
n→∞

1
n2 log (cid:101)P[r]

n,p(F ) ≤ − inf
W ∈F

I [r]
p (W )

and for any open set U ⊂ (cid:102)W,

lim inf
n→∞

1
n2 log (cid:101)P[r]

n,p(U ) ≥ − inf
W ∈U

I [r]
p (W ).

(12)

(13)

6.1 Constraint systems for quantum graphs

In the context of the present paper, it is convenient to define regions of Multi-
Relations Graphons by linear combinations of multi-relational graph densities.

Definition 15 (Multi-relational quantum graphs) We say that F is a
multi-relational quantum graph if it is the linear combination of a finite number
of multi-relational graphs Fi with real coefficients, more precisely
(cid:88)

F =

αiFi

and αi ∈ R

i

Hence the definition of t(F, W ) extends to multi-relational quantum graphs
linearly, i.e. t(F, W ) = (cid:80)

i αit(Fi, W ).

Quantum graphs generalize the notion of signed multi-relational graph and
offer a convenient way to write succinctly linear combinations of subgraph
densities specially when we represent horn clauses using linear combinations
of conjunctions.

Let F = [F1, · · · , Fk] be a finite vector of multi-relational quantum graphs
and let u ∈ Rk
+. We let correspond to (F, u) a system of constraints ∀i ∈ [k] :
t(Fi, W ) = ui on the multi-relational quantum graphs F1, . . . , Fk, where we
call u the density vector. Then we define the feasible region

(cid:101)S(F, u) = {W ∈ (cid:102)W [r] | t(Fi, W ) = ui, for 1 ≤ i ≤ |F|}

(14)

We also define an approximate feasible region. In particular, for ϵ > 0,

(cid:101)S(F, u, ϵ) = {W ∈ (cid:102)W [r] | |t(Fi, W ) − ui| ≤ ϵ, for 1 ≤ i ≤ |F|}

(15)

22

Juan Alvarado et al.

6.2 The most typical multi-relational graph of (cid:101)S(F, u)

We need an additional ingredient to prove the main result of this section which
is is the extension of the counting lemma of graphons (Lemma 10.23 in [16])
to multi-relational graphons.

Lemma 11 (Counting lemma for multi-relational graphons) Let F be
a multi-relational graph and let W and V be multi-relational graphons, then

|t(F, W ) − t(F, V )| ≤ max

k

|E(Fk)| δ[r]

(cid:50) (W, V )

Thus if F is a quantum multi-relational graph then the map W (cid:55)→ t(F, W ) is
continuous.

We now define the notion of the most typical multi-relational graphs in
(cid:101)S(F, u). Let (G[r](n, 1/2))∞
n=1 be a sequence of multi-relational Erd˝os-R´enyi
random graphs. From Theorem 4 and the compactness of (cid:102)W [r], there is a
subsequence (G[r](ni, 1/2))∞
i=1 with
limi→∞ ϵi = 0 such that G[r](ni, 1/2) ∈ (cid:101)S(F, u, ϵi). By Theorem 4, G[r] is dense
in (cid:102)W [r], hence the condition G[r](ni, 1/2) ∈ (cid:101)S(F, u, ϵi) holds since (cid:101)S(F, u, ϵi)
is open for any ϵi > 0. Therefore the limit of random multi-relational graphs
G[r](ni, 1/2) satisfying the constraints t(Fi, W ) = u ∀i ∈ [k] is defined. We
call these limits as the most typical random multi relational graphs

i=1 and a sequence of positive numbers (ϵi)∞

We prove that any typical multi-relational Erd˝os-R´enyi random graph W ∗
p (W ), where p = 1/2. First we prove the fol-

is a solution of minW ∈ (cid:101)S(F ,u) I [r]
lowing.

Theorem 6 Take any p ∈ (0, 1). Then

inf
W ∈ (cid:101)S(F ,u)◦

I [r]
p (x) =

inf
W ∈ (cid:101)S(F ,u)

I [r]
p (x).

(16)

and

lim
n→∞

1
n2 (cid:101)P[r]

n,p( (cid:101)S(F, u)) = − min

I [r]
p (W ).

W ∈ (cid:101)S(F ,u)

Proof Let δ > 0. Then we define

Uδ = ∩k

i=1{W ∈ (cid:102)W [r] | |t(Fi, W ) − ui| < δ}

and

Vδ = ∩k

i=1{W ∈ (cid:102)W [r] | |t(Fi, W ) − ui| ≤ δ}

From Lemma 11, t(Fi, ·) is continuous under the cut-distance topology, hence
Uδ and Vδ are open and closed sets.
n,p(Uδ) and (cid:101)P[r]

n,p(Vδ) be the probability measure of Uδ and Vδ. From

Let (cid:101)P[r]

Theorem 5, it follows that

lim sup
n→∞

1
n2 log (cid:101)P[r]

n,p(Vδ) ≤ − inf
W ∈Vδ

I [r]
p (W )

Limits of Multi-relational Graphs

23

and

lim inf
n→∞

1
n2 log (cid:101)P[r]

n,p(Uδ) ≥ − inf
W ∈Uδ

I [r]
p (W )

and therefore we may write

− inf

W ∈Uδ

I [r]
p (W ) ≤ lim inf
n→∞

≤ lim sup
n→∞

1
n2 log (cid:101)P[r]

1
n2 log (cid:101)P[r]
n,p(Vδ) ≤ − inf
W ∈Vδ

n,p(Uδ) ≤ lim sup
n→∞

I [r]
p (W ) ≤ − inf

n,p(Uδ)

1
n2 log (cid:101)P[r]
I [r]
p (W )

W ∈Uδ+δ2

By taking the limit δ → 0+, inf W ∈Uδ I [r]
same and Vδ → (cid:101)S(F, u). Thus we have,

p (W ) and inf W ∈Uδ+δ2 I [r]

p (W ) are the

inf
W ∈ (cid:101)S(F ,u)◦

I [r]
p (W ) =

inf
W ∈ (cid:101)S(F ,u)

I [r]
p (W ).

Since (cid:101)S(F, u) is compact and Chatterjee and Varadhan proved the function
I [r]
is lower semi-continuous, it follows that we may replace inf by min (c.f.
p
appendix, Theorem 9) and deduce

lim
n→∞

1
n2 (cid:101)P[[r]

n,p( (cid:101)S(F, u)) = − min

W ∈ (cid:101)S(F ,u)

I [r]
p (W ).

⊓⊔

Theorem 6 shows that the limiting distribution of the most typical multi-
relational Erd˝os-R´enyi random graphs holds the condition

lim
n→∞

1
n2 (cid:101)P[r]

n,1/2( (cid:101)S(F, u)) = − min

I [r]
1/2(W ).

W ∈ (cid:101)S(F ,u)

The next theorem shows that the limiting distribution of the most typical
random graphs is a solution of minW ∈ (cid:101)S(F ,u) I [r]
1/2(W ). To do that, we extend a
concentration inequality for growing sequences (G[r](n, p))∞
n=1 given by Chat-
terjee and Varadhan, Theorem 3.1 in [5].

Theorem 7 (Concentration inequality for constrained and multi-relational
Erd˝os-R´enyi random graphs) Take any p ∈ (0, 1) (in our case p = 1/2).
Let H ⊂ (cid:102)W [r] be a compact set such that the condition of Eq. 16 holds. Let
H ∗ be the subset of H where I [r]
p (·) is minimized. Then H ∗ is non-empty and
compact, and for each n, and each ϵ > 0,

P rob(δ(cid:50)(G[r](n, p), H ∗) ≥ ϵ | G[r](n, p) ∈ H) ≤ exp(−C(ϵ, H)n2)

where C(ϵ, H) is a positive constant depending only on ϵ and H. In particu-
lar, if H ∗ contains only one element h∗, then the conditional distribution of
G[r](n, p) given H converges to the point mass at h∗ as n → ∞.

24

Juan Alvarado et al.

The original statement of the above theorem includes the condition

inf
W ∈ (cid:101)S(F ,u)◦

I [r]
p (x) =

inf
W ∈ (cid:101)S(F ,u)

I [r]
p (x).

(17)

Note that if H is compact the sequence (G[r](n, 1/2))∞

which is proven in Theorem 6. The proof of the theorem is omitted since it is
identical to the proof of Theorem 3.1 found in Chatterjee and Varadhan [5].
n=1|(H) samples uni-
formly random graphs constrained by H. Hence from the above theorem, we
conclude the solutions of minx∈H I [r]
1/2(x) are the most typical infinite multi-
relational random graphs constrained to H.

Finally from Theorems 5 and 6, it is straightforward to prove that

Theorem 8 Let F be a vector of finite vector of multi-relational quantum
graphs F = [F1, · · · , Fk] and let u ∈ Rk be a vector of multi-relational sub-
graph densities. Then the limit W ∗(F, u) of the sequence (G[r](n, 1/2))∞
n=1 of
growing random multi-relational graphs which are uniformly sampled such that
limn→∞ G[r](n, 1/2) ∈ (cid:101)S(F, u) satisfies

W ∗(F, u) = min

W ∈ (cid:101)S(F ,u)

I [r]
p (W )

(18)

7 Technical Results and Proofs

7.1 Proof of the Second Sampling Lemma

Proof of Lemma 10.

Let us abbreviate ∥W − V ∥[r]

(cid:50) by d(cid:50)(W, V ). Recall Theorem 2, for any U

there a stepfunction UP with partition P of q classes such that,

d(cid:50)(U, UP ) ≤

2r3/2
(cid:112)log2 q

We can also write

E[|d(cid:50)(H(k, U ), H(k, UP ))|] ≤ E[|d(cid:50)(H(k, U ), H(k, UP )) − d(cid:50)(U, UP )|] + d(cid:50)(U, UP )

By Lemma 5 and Theorem 2, we have that

E[d(cid:50)(H(k, U ), H(k, UP ))] ≤

14r
k1/4

+

2r3/2
(cid:112)log2 q

Thus

E[δ(cid:50)(H(k, U ), H(k, UP ))] ≤

14r
k1/4

+

2r3/2
(cid:112)log2 q

Limits of Multi-relational Graphs

25

There follows

E[δ[r]

(cid:50) (U, H(k, U ))] ≤ δ[r]

(cid:50) (UP , H(k, UP ))] + E[δ[r]

(cid:50) (H(k, UP ), H(k, U ))]

+ E[δ[r]

(cid:50) (U, UP ) + E[δ[r]
2r3/2
(cid:112)log2 q
14r
k1/4

4r3/2
(cid:112)log2 q

+

≤

=

(cid:50) (UP , H(k, UP )] +

14r
k1/4

+

2r3/2
(cid:112)log2 q

+ E[δ[r]

(cid:50) (UP , H(k, UP )]

Lemma 9 shows an upper bound for E[δ[r]

(cid:50) (UP , H(k, UP )] , thus

E[δ[r]

(cid:50) (U, H(k, U ))] ≤

14r
k1/4

+

4r3/2
(cid:112)log2 q

+ r

(cid:114) q
k

.

By setting q = ⌈k1/4⌉ we get

E[δ[r]

(cid:50) (U, H(k, U ))] ≤

14r
k1/4

+

8r3/2
(cid:112)log2 k

(cid:112)

+ r

k−3/4 + k−1,

hence (since k ≥ 1).

E[δ[r]

(cid:50) (U, H(k, U ))] ≤

24r3/2
(cid:112)log2 k

.

In order to get an upper bound for E[δ[r]

(cid:50) (U, G(k, U ))] we write

E[δ[r]

(cid:50) (U, G(k, U ))] ≤ E[δ[r]

(cid:50) (U, H(k, U ))] + E[δ[r]

(cid:50) (H(k, U ), G(k, U ))]

By Lemma 8 and Eq (19), we have

E[δ[r]

(cid:50) (U, G(k, U ))] ≤

24r3/2
(cid:112)log2 k

+

11r
√
k

≤

35r3/2
(cid:112)log2 k

(19)

(20)

Let f (G) = v(G)δ[r]

(cid:50) (G, W ) be the multi-relational graph parameter. Note
that |f (G) − f (G′)| ≤ r when G and G′ differ in only one edge. Hence we can
apply Lemma 3 on f , by setting C = r, f (Z) = kδ[r]
(cid:50) (G(k, W ), W ), E[f (Z)] =
kδ[r]

(cid:50) (G(k, W ), W ) and s = k.

P(kδ[r]

(cid:50) (G(k, W ), W ) > kE[δ[r]

(cid:50) (G(k, W ), W )] + λr) < exp(−

λ2
2k

)

hence

P(δ[r]

(cid:50) (G(k, W ), W ) > E[δ[r]

(cid:50) (G(k, W ), W )] +

λr
k

) < exp(−

λ2
2k

)

If λ = kr1/2√
log2 k

then we have

P(δ[r]

(cid:50) (G(k, W ), W ) ≤ E[δ[r]

(cid:50) (G(k, W ), W )] +

r3/2
(cid:112)log2 k

) ≥ 1 − exp(−

kr
2 log2 k

).

26

Juan Alvarado et al.

From (20) we know that E[δ[r]

(cid:50) (W, G(k, W ))] ≤ 35r3/2√
log2 k

. Thus there also must

hold

P(δ[r]

(cid:50) (G(k, W ), W ) ≤

35r3/2
(cid:112)log2 k

+

r3/2
(cid:112)log2 k

) ≥ 1 − exp(−

kr
2 log2 k

),

and hence

P(δ[r]

(cid:50) (G(k, W ), W ) ≤

36r3/2
(cid:112)log2 k

) ≥ 1 − exp(−

kr
2 log2 k

).

⊓⊔

7.2 Proof of Counting Lemma for Multi-Relational Graphons

Proof of Lemma 11. This proof follows the same ideas as the proof of Lemma
4.1 in [17]. Let n = |V (F )|. Let E∗ = {(k, i, j) | s ∈ [r] ∧ {i, j} ∈ Ek ∧ i < j} be
the collection of all edges of the multi-relational graph. Number the elements
in E∗ from 1 to e∗ = |E∗| and for s ∈ E∗ we denote the s-th triple in E∗ by
(ks, is, js). We define Xt : [0, 1]n → R as

Xt(x) =

t
(cid:89)

s=1

Wks (xis , xjs )

e∗(cid:89)

s=t+1

Vks (xis, xjs)

Subtracting the integral of two such polynomials for consecutive indices t,

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

(cid:90)

[0,1]n

(cid:12)
(cid:12)
(cid:12)
Xt(x) − Xt−1(x)
(cid:12)
(cid:12)

(cid:90)

t−1
(cid:89)

[0,1]n

s=1

Wks (xis, xjs) |Wkt (xit , xjt) − Vkt (xit, xjt)|

e∗(cid:89)

s=t+1

Vks (xis, xjs)

(cid:90)

[0,1]n

|Wkt (xit, xjt) − Vkt (xit, xjt)|

|Wkt (xit, xjt) − Vkt (xit, xjt)| dxitdxjt

≤

≤

≤

(cid:90) 1

(cid:90) 1

0

0
≤ ∥Wkt − Vkt∥(cid:50).

(cid:12)
(cid:12)
The last inequality follows from the fact that
[0,1]2 Wkt(x, y) − Vkt(x, y)
(cid:12) is
at most the cut norm of Wkt − Vkt (since it uses the rectangle [0, 1]2, rather
than supS×T ). As t(F, W ) = (cid:82)
[0,1]n X0(x), we can

[0,1]n Xe∗ (x) and t(F, V ) = (cid:82)

(cid:12)
(cid:82)
(cid:12)
(cid:12)

Limits of Multi-relational Graphs

27

use the above inequality to bound

|t(F, W ) − t(F, V )| =

≤

≤

=

e∗(cid:88)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
e∗(cid:88)

t=1
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

t=1

(cid:90)

[0,1]n

(cid:90)

[0,1]n

Xt(x) − Xt−1(x)

Xt(x) − Xt−1(x)

(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)
(cid:12)

e∗(cid:88)

t=1
r
(cid:88)

k=1

∥Wkt − Vkt∥(cid:50)

|Ek|∥Wk − Vk∥(cid:50)

≤ max

k

|Ek|∥Wk − Vk∥r[
(cid:50)

Now, noting that t(F, V ) = t(F, V σ) for all σ ∈ Σ, we find

|t(F, W ) − t(F, V )| ≤ max

k

|Ek| inf
σ∈Σ

∥Wk − V σ

k ∥r[
(cid:50) .

⊓⊔

7.3 Proof of the Large Deviation Principle for G[r](n, p)

Here we prove Theorem 5. Our proof technique is inspired by the proof of
Theorem 2.3 in Chatterjee and Varadhan [5].

Proof of the upper bound of Theorem 5

Let (cid:101)B[r]((cid:101)h, η) := {W ∈ (cid:102)W [r] | δ[r]
upper bound (12), it is sufficient to prove that for any (cid:101)h ∈ (cid:102)W [r],

(cid:50) (W, (cid:101)h) ≤ η}. First, we claim that to prove the

lim
η→0

lim sup
n→∞

1
n2 log (cid:101)P[r]

n,p( (cid:101)B[r]((cid:101)h, η)) ≤ −I [r]

p ((cid:101)h).

(21)

Since F is compact, for each η > 0 we can construct a finite cover { (cid:101)B[r]((cid:101)h1, η), . . . , (cid:101)B[r]((cid:101)hk, η)}

where ∪k

i=1 (cid:101)B[r]((cid:101)hi, η) ⊇ F and ∀i : hi ∈ F . Thus

(cid:101)P[r]
n,p(F ) ≤

k
(cid:88)

i=1

(cid:101)P[r]
n,p( (cid:101)B[r]((cid:101)hi, η)).

From (21), there are functions g1, g2 : R≥0 → R such that

1
n2 log (cid:101)P[r]

n,p( (cid:101)B[r]((cid:101)h, η)) ≤ −I [r]

p ((cid:101)h) + g1(η) + g2(n).

28

Juan Alvarado et al.

with limη→0 g1(η) = 0 and lim supn→∞ g2(n) = 0. Hence
(cid:101)P[r]
n,p( (cid:101)B[r]((cid:101)h, η) ≤ exp(−n2(I [r]

p ((cid:101)h) − g1(η) − g2(n)) )

for any n and η > 0. We can thus bound

(cid:101)P[r]
n,p(F ) ≤

≤

k
(cid:88)

i=1

k
(cid:88)

i=1

(cid:101)P[r]
n,p( (cid:101)B[r]((cid:101)hi, η))

exp(−n2(I [r]

p ((cid:101)hi) − g1(η) − g2(n)) )

≤ k max

i

exp(−n2(I [r]
−n2 (cid:16)
(cid:16)

min
i

p ((cid:101)hi) − g1(η) − g2(n)))

I [r]
p ((cid:101)hi) − g1(η) − g2(n)

(cid:17)(cid:17)

.

= k exp

Hence

1
n2 log((cid:101)P[r]

n,p(F )) ≤ min

i

I [r]
p ((cid:101)hi) − g1(η) − g2(n) +

1
n2 log(k).

Note that k is finite for any η > 0 since F is compact. Then by taking the sup
limit n → ∞ when η > 0, we get

1
n2 log((cid:101)P[r]
By taking the limit η → 0, we get

lim sup
n→∞

n,p(F )) ≤ min

I [r]
p ((cid:101)hi) − g1(η)

i

lim sup
n→∞

1
n2 log((cid:101)P[r]

n,p(F )) ≤ inf
(cid:101)h∈F

I [r]
p ((cid:101)h).

Thus we have proven that (21) implies (12).

With B[r]((cid:101)h, η) := {W ∈ W [r] | (cid:102)W ∈ (cid:101)B[r]((cid:101)h, η)}, Eq (21) is equivalent to

lim
η→0

lim sup
n→∞

1
n2 log P[r]

n,p(B[r]((cid:101)h, η)) ≤ −I [r]

p ((cid:101)h).

(22)

Since G[r](n, p) has the distribution of an r-tuple of independent G(n, p) ran-
dom variables, it is not difficult to see that for (cid:101)h ∈ W [r] with (cid:101)h = ((cid:101)h1 . . . (cid:101)hr),
r
(cid:89)

P[r]

n,p((cid:101)h) =

Pn,p((cid:101)hk)

k=1

and hence

(cid:16)

P[r]
n,p(B[r]((cid:101)h, η))

(cid:17)

≤ log

log

≤ log

=

r
(cid:88)

k=1

r
(cid:89)

k=1
r
(cid:89)

k=1

Pn,p

(cid:16)

B((cid:101)hk, η)

(cid:16)

log Pn,p

B((cid:101)hk, η)

(cid:17)

(cid:17)

Pn,p

(cid:16)

prjk

(cid:16)

(cid:17)(cid:17)

B[r]((cid:101)h, η)

Limits of Multi-relational Graphs

29

where prjk(·) is the projection onto the k-th coordinate and B((cid:101)h, η) = {W ∈
W | δ(cid:50)(W, h) ≤ η}. Eq. (11) in the proof of the upper bound of Theorem 2.3
in Chatterjee and Varadhan [5] states that for (cid:101)h ∈ (cid:102)W,

lim
η→0

lim sup
n→∞

1
n2 log Pn,p(B((cid:101)h, η)) ≤ −Ip((cid:101)h)

Combining these two last inequalities, we get

lim
η→0

lim sup
n→∞

≤ lim
η→0

lim sup
n→∞

1
n2 log P[r]
r
1
(cid:88)
n2

k=1

n,p(B[r]((cid:101)h, η))

log Pn,p(B((cid:101)hk, η)))

r
(cid:88)

≤ −

Ip(prjk((cid:101)h))

k=1
= −I [r]
p ((cid:101)h)

This proves Eq (22) and hence the upper bound.

Proof of the lower bound of Theorem 5

It is sufficient to prove for any (cid:101)h ∈ (cid:102)W [r] and arbitrary η > 0 that

Since B[r]((cid:101)h, η) ⊃ (cid:81)r
1
n2 log (cid:101)P[r]

lim inf
n→∞

lim inf
n→∞

n,p( (cid:101)B[r]((cid:101)h, η)) ≥ −I [r]

1
n2 log (cid:101)P[r]
k=1 B((cid:101)hk, η/r), there holds

p ((cid:101)h).

(23)

n,p( (cid:101)B[r]((cid:101)h, η)) = lim inf
n→∞

n,p(B[r]((cid:101)h, η))

1
n2 log P[r]
1
n2 log P[r]

n,p

≥ lim inf
n→∞

(cid:33)

B((cid:101)hk, η/r)

(cid:32) r
(cid:89)

k=1

=

k
(cid:88)

k=1

lim inf
n→∞

1
n2 log Pn,p

(cid:16)

(cid:17)
B[r]((cid:101)hk, η/r)

Applying the lower bound of Theorem 2.3 in Chatterjee and Varadhan [5] we
get that for each k;

1
n2 log Pn,p
Combining these inequalities, we get

lim inf
n→∞

(cid:16)

B[r]((cid:101)hk, η)

(cid:17)

≥ −Ip((cid:101)hk)

lim inf
n→∞

1
n2 log (cid:101)P[r]

n,p( (cid:101)B[r]((cid:101)h, η)) ≥ −

r
(cid:88)

k=1

Ip(hk) = −I [r]

p (h)

This proves Eq (23) and hence the lower bound of the theorem.

30

Juan Alvarado et al.

8 Markov Logic Networks and Multi-Relational Graphons: Two
Maximum-Entropy Models

In this section, we discuss the translations between probabilistic models rep-
resented in first-order logic and models represented in the multi-relational
graph formalism. In particular, we focus on models constrained by relational
statistics Q(α, ω) (the FOL setting) and homomorphism densities (the multi-
relational graph setting). As explained in Section 2.2, MLNs are maximum
entropy models constrained by expected values of the statistics Q(α, ω).

8.1 From Multi-Relational Graph Representations to FOL Representations

There is a simple relationship between homomorphism densities t(F, G) and
the statistics Q(α, ω) that we introduced for Markov logic networks in Section
2.2. First, we show that any multi-relational graph G = (V, E1, . . . , Em) can
be trivially represented as a first-order logic possible world ω. This is done as
follows. We identify the domain ∆ with the set of vertices, i.e. ∆ = {v|v ∈ V}.
Then we set

ωG = {λi(v1, v2)|v1, v2 ∈ ∆ and {v1, v2} ∈ Ei and i ∈ {1, 2, . . . , m}}.

The possible world ωG plays the same role in the statistic Q(α, ω) as G plays
in the homomorphism density t(F, G). It remains to show how to construct a
formula α as a counterpart of the graph F. One way to construct such an α is
as follows. Given a graph F = (VF, EF
m), we define α as a conjunction
of the following set of first-order logic atoms

1 , . . . , EF

A = {λi(xv, xw)|v, w ∈ VF and {v, w} ∈ EF
Indeed, it is not difficult to see that if we let αF = (cid:86)

a∈A a, then

i and i ∈ {1, 2, . . . , m}}.

Q(αF, ωG) = t(F, G).

Remark 4 For Markov logic networks, it is more common to use formulas in
the form of a disjunction of atoms rather than a conjunction. If we construct
F = (cid:87){¬a|a ∈ A} then it follows that Q(α′
α′
F, ωG) = 1 − t(F, G). Hence, we
can express the same type of constraints using also disjunctions.

It follows from the discussion above that for any set of constraints expressed
using homomorphism densities of multi-relational graphs, we can formulate an
equivalent set of constraints using first-order logic conjunctions or disjunctions.

8.2 From FOL Representations to Multi-Relational Graph Representations

Next we discuss the other direction. We describe when it is possible to rep-
resent constraints in the “world” of relational structures by constraints on
multi-relational graphs. One obvious restriction is that we can only represent

Limits of Multi-relational Graphs

31

constraints on possible worlds where all relations are symmetric, irreflexive
and binary. That is we will only be able to model distributions over possi-
ble worlds where the following first-order logic sentences are satisfied for all
relations r that we use:

∀x : ¬r(x, x) (irreflexivity)

∀x, y : r(x, y) ⇒ r(y, x) (symmetry) .

From now on we will assume that all possible worlds ω satisfy these two con-
straints and we will not always state this explicitly if there is no risk of con-
fusion.

Let α be a conjunction of first-order logic atoms without constants and ω
be a possible world on a domain ∆ which satisfies the irreflexivity and sym-
metry constraints. We first show how to construct graphs Fα and Gω such that
Q(α, ω) = t(Fα, Gω). We define VF = {vx|x is a FOL variable contained in α}
and VG = {vc|c ∈ ∆}. Then we define

Fα = (VF, {{vx, vy}|λ1(x, y) ∈ α or λ1(y, x) ∈ α}, . . . ,

{{vx, vy}|λm(x, y) ∈ α or λm(y, x) ∈ α})

Gω = (VG, {{vx, vy}|λ1(x, y) ∈ ω or λ1(y, x) ∈ ω}, . . . ,

{{vx, vy}|λm(x, y) ∈ ω or λm(y, x) ∈ ω})

Next we illustrate the above outlined translation on an example.

Example 1 Let

and

α = friends(x, y) ∧ friends(y, z)

ω = {friends(Alice, Bob), friends(Bob, Alice), friends(Alice, Eve),

friends(Eve, Alice), friends(Bob, Eve), friends(Eve, Bob)}.

We now construct the respective graphs Fα and Gω, following the steps out-
lined above. For Fα we get

VF = {vx, vy, vz}
EF = {{vx, vy}, {vy, vz}},

and for Gω:

VG = {vAlice, vBob, vEve}
EG = {{vAlice, vBob}, {vAlice, vEve}, {vBob, vEve}}.

It is easy to check that Q(α, ω) = t(F, G) = 12/27, as expected.

32

Juan Alvarado et al.

So far we have only explained how to represent constraints which are
specified using conjunctions of positive first-order logic literals. It is not dif-
ficult to also represent constraints specified by formulas in the form of dis-
junctions of negative first-order logic literals. If we are given a constraint
E[Q(¬a1 ∨ . . . ¬am, .)] = t, where a1, . . . , am are first-order logic atoms, then
we can replace it by E[Q(a1 ∧ · · · ∧ am, .)] = 1 − t, which we already know how
to represent using multi-relational graphs.

Finally, what remains is to show how to encode constraints represented
using either disjunctions or conjunctions of first-order logic literals without
the restriction that the literals in them must be all negative or positive, re-
spectively. For this we can exploit the inverse Moebius transform (see e.g. [16,
13,25], in particular for homomorphism densities, see Eq. 7.11 in Lov´asz [16]).
Let α = ¬a1 ∧ · · · ∧ ¬al ∧ al+1 ∧ · · · ∧ am be a conjunction of first-order logic
literals. We now need to show how to represent Q(α, ω) in the graph domain.
r , E−
r ) be a signed multi-relational graph
where VF is defined above, E+
i = {{vx, vy}|λi(x, y) ∈ α or λi(y, x) ∈ α} and
E−
i = {{vx, vy}|¬λi(x, y) ∈ α or ¬λi(y, x) ∈ α}. With this notation we can
then write: Q(α, ω) = t(Fα, Gω), where t is the subgraph density of signed
multi-relational graphs defined in Eq. 9 and Gω is defined above.

Let Fα = (VF, E+

1 , · · · , E+

1 , E−

In conclusion, we have shown that for every constraint that we can write
using function-free quantifier-free first-order logic formulas, we can write the
equivalent constraint in the graph domain. Note, however, that we restrict
ourselves to possible worlds represented over symmetric non-reflexive binary
relations.

8.3 An example on how a MLN is represented by Multi-relational Graphons

Using the equivalence between MLN and multi-relational graphs, we transform
a MLN Φ into multi-relational graphons with maximum entropy. Φ contains
two binary and symmetric relations f riends(x, y) and acquitances(x, y) with
the following formulas,

∞ : f riends(x, y) ⇒ f riends(y, x)

∞ : acquitances(x, y) ⇒ acquitances(y, x)

∞ : ¬f riends(x, x)

∞ : ¬acquitances(x, x)
w1 : f riends(x, y) ∧ f riends(y, z) ⇒ f riends(x, z)
w2 : f riends(x, y) ∧ acquitances(y, z) ⇒ acquitances(x, z)

(24)

(25)

where w1, w2 ∈ R. The probability distribution of the possible worlds ω of Φ
is the Gibbs distribution is given by,

pΦ(ω) =

1
Z

exp(w1 · Q1(ω) + w2 · Q2(ω))

Limits of Multi-relational Graphs

33

Fig. 1 Two signed muulti-relational graphs. The blue edges correspond to ’friends’ relations
and the red one is ’acquitances’ relation.

Instead, multi-relational graphons enables to formulate a new semantics for Φ
by picking the most typical possible worlds of Φ if we assume that ∆ = [0, 1].
Hence the possible worlds where the predicates f riends(x, y) and acquitances(x, y)
can be satisfied are 2-relational graphons. To pick the most typical possible
worlds, we solve the optimization problem.

I [2](W ) subject to

min
W ∈ (cid:102)W [r]

u1 = 1 − t(F1, W ) and u2 = 1 − t(F2, W )

where E[Q(α1, .)] = u1 and E[Q(α2, .)] = u2 where α1 is the formula given
by Eq. 24 and α2 is the formula given by Eq. 25, and F1 and F2 are signed
multi-relational graphs which are shown in Figure 1. Note that the constraints
ui = 1−t(Fi, W ) i = 1, 2 come from the Boolean identity p ⇒ q = 1−(p∧¬q).

i t(Fϕ, W ∗

Once the optimization problem is solved, computing marginal probability
of a logical formula ϕ, which is represented by the signed graph Fϕ, is easy. It is
just to compute 1
i ) where M is the number of global minimizers
M
W ∗

(cid:80)
i of the above optimization problem.
The key point in the estimation of the most typical worlds from a given set
of formulas is to solve the optimization problem in the space of multi-relational
graphons. This is a problem posed in a space of infinite many dimensions.
Although it is not clear that the problem is computable, prior work on con-
strained graphons with maximum entropy described in Section 9.3, found by
numerical experiments that the global solutions of the maximum entropy prob-
lem seem to be stepfunctions.

8.4 Maximum Entropy Distributions

As described in Section 2.3, MLNs are maximum entropy models. In particular
they are the model with given statistics Q(α, .), that maximize Gibbs entropy.
As we described in detail in the previous sections, constraints equivalent to
those on the statistics Q can be also represented in the graph domain using
homomorphism densities. If we fix the number of vertices and find the model

34

Juan Alvarado et al.

that maximizes Gibbs entropy in the graph domain, we end up with a multi-
relational variant of exponential random graph model2 [29]. However, we are
not interested in finite graphs and finite relational structures since the large
deviation principle shows that graphons maximize the Boltzmann entropy. Let
us consider some first-order language with binary relations and denote by Ωn
the set of all possible worlds on a domain of size n, for which the binary
relations are symmetric and non-reflexive. It follows from the large deviation
principle that if we select from the relational structures Ωn that violate the
given Q-statistics constraints the least and then pick one of them uniformly at
random, the limit of this sequence will be a multi-relational graphon that has
maximum Boltzmann entropy among the graphons satisfying the constraints
that we obtain by transforming the Q-constraints into the graph domain. This
is an important result on its own because it justifies the use of maximum-
Boltzmann-entropy models for modelling multi-relational data. It could also
be potentially relevant as an answer to a question raised in Jaeger and Schulte
[10] asking which distributions, satisfying some given constraints one should
choose. We answer this question (for undirected multi-relational graphs): one
should choose the multi-relational graphons that maximize Boltzmann entropy.

9 Related Work

9.1 Multi-Relational Graphs as Compact Decorated Graphs

Compact Decorated Graphs (CDG) are a generalization of simple graphs due
to Lov´asz and Szegedy [19]. CDG are defined as follows.

Definition 16 (Compact decorated graphs) Let K be a compact sepa-
rable topological space such that K contains an element ˆ0 representing no
edge. A graph decorated with K is a symmetric function G : [n] × [n] → K.
Equivalently, CDG is a complete graph Kn with each edge by an element of
K. The set of all F-decorated graphs with n nodes is denoted by Gn(F) and
G(F) = ∪n>0Gn(F).

Definition 17 (K-graphon) Let P (K) be the set of Borel probability mea-
sures on K. We denote by W(K) the set of symmetric functions W (K) :
[0, 1]2 → P (K). The elements of W(K) are called K-graphons.

Intuitively, the idea of K-decorated graph is to model complex relations for
every pair of nodes. Hence the element of K associated with an edge can be
seen as a random variable and as the number of nodes goes to infinity, the
distribution of the random variable between two nodes x, y ∈ [0, 1] converges
to W (x, y) ∈ P (K).

2 Exponential random graph models are very similar to Markov logic networks.

Limits of Multi-relational Graphs

35

9.1.1 Graph homomorphism density on W(K)

Graph homomorphism densities on W(K) may be defined using C-decorated
graphs. Let C be the set of functions K (cid:55)→ R. Hence a C -decorated graph
F = (V, E) is a simple graph on which each edge ij is associated with a
function Fij : K → R.

Definition 18 Let W be a K-graphon and let f ∈ C. Define Wf : [0, 1]2 → R
by Wf (x, y) = (cid:82)

K f dW (x, y).

The graph homomorphism density on W(K) is computed by,

tCDG(F, W ) =

(cid:90)

(cid:89)

[0,1]k

1≤i≤j≤k

WFij (xi, xj)

(cid:89)

dxi

i∈V (F )

(26)

where F is a C-decorated graph with k nodes and W is a K-graphon. Note
that (26) is generalizing the earlier formula (8) when r = 1.

9.1.2 Convergence on CDG

Lov¨asz in [16] shows that any graphon can be seen as the limit of a sequence
of growing graphs such that (Gn)∞
n=1
converges to t(F, W ) for every simple graph F . For CDG, there is a similar
result. Instead of simple graphs, it uses the notion of Generation system of
decorated graphs.

n=1 converges to W ∈ (cid:102)W iff (t(F, Gn))∞

Definition 19 (Generation system. (Definition 2.2 in [19])) We say
that a set F ⊆ C is dense if for every ϵ > 0 and f ∈ C there is a g ∈ F such
that |g(x) − f (x)| ≤ ϵ for every x ∈ K. We say that F ⊆ C is a generating
system if the linear space generated by the elements of F is dense.

Theorem 9 (Convergence on CDG Theorem 2.6 in [19]) Let F be a
countable generating set and let (Wn)∞
n=1 be a sequence of F-graphons such
that (t(F, Wn)) is a convergent sequence for every F ∈ G(F). Then there is a
F-graphon W such that t(F, Wn) → t(F, W ) for every F ∈ G(C).

Note that in graphon space the graphs converge to a graphon function W such
that W (x, y) ∈ [0, 1] for all x, y ∈ [0, 1]2 and in F-graphon space, the CDG
converge to a Borel probability measure on F instead a number in [0, 1].

9.1.3 Multi-Relational Graphs as Compact Decorated Graphs

Any multi-relational graph can be represented as a compact K-decorated
graph. As follows, Lov´asz and Szegedy describe a special case of CDG, Parallel
Colored Graphs (P CG) where K = {0, 1}r, shown in Example 2.10 [19]. Each
edge of a P CG is a general probability distribution on {0, 1}r. From Theorem
9, the limits of growing P CG are K-graphons, W : [0, 1]2 → [0, 1]2r−1 since a

36

Juan Alvarado et al.

probability distribution on {0, 1}r can be represented using a vector in [0, 1]k
for k = 2r − 1.

A multi-relational graphon can be seen as a restricted version of the limit
of a sequence of P CGs in which the probability distribution for every W (x, y)
is the product of r independent Bernoulli distributions. Hence the limit object
of a convergent sequence of growing multi-relational graphs is a symmetric
and measurable function W : [0, 1]2 → [0, 1]r.

Remark 5 The formula for subgraph density on multi-relational graphons (8)
can be obtained from the formula for homomorphism density of a CDG (26).
We use two F-decorated graphs,

F = {g1, g2 : [0, 1]r → [0, 1] | g1(x) =

xk and g2(x) = 1}

(cid:89)

k

where g1 and g2 decorate every edge and non-edge. To see that, this yields the
subgraph density formula for multi-relational graphs let F CDG be the multi-
relational graph F in the form of a F-graph. By a simple computation we
have

WF CDG

ij

(x, y) =

(cid:40)(cid:81)r

k=1 Wk(x, y)

1

if ij is connected in F CDG
otherwise

Hence it is easy to see that tCDG(F CDG, W ) = t(F, W ).

9.2 The AHK Model

The AHK Model given in Jaeger and Schulte [11] is an infinite exchangeable ar-
ray which characterizes the probability distributions that are projective on re-
lational structures. A probability distribution is projective when the marginal
of the distribution for size-n structures on induced sub-structures of size k < n
is equal to the given distribution for size-k structures. More precisely AHK is
defined as follows.

Definition 20 Let [n]d
Let ⟨n⟩d be the set of d-tuples with distinct and ordered entries from [n]d.

̸= be the set of d-tuples with distinct entries from [n]d.

Definition 21 Let ω be a relational structure with maximal arity(ω) = a ≥
1. Let Dm(ω) m = 1, · · · , a be the arity-m data of ω. Dm(ω) can be seen
as a collection of adjacency matrices referring the connections of m distinct
elements. Let Dm(ω ↓ i) be the projections of Dm(ω) in terms of i ∈ ⟨n⟩m
distinct elements where n is number of elements of ω. Let Tm be the space of
possible values of Dm(ω ↓ i) when |i| = m.

Example 2 Figure 2 shows an example of AHK model.

a) The relational structure ω : symmetric and irreflexive relations

Limits of Multi-relational Graphs

37

Fig. 2 a) shows a relational structure with 2 unary predicates and 2 binary relations. The
circles represent the elements of the domain, boxes attached to the nodes indicate the values
of the unary relations, and edges (with arrows) represent the binary relations.

b) The projection of ω of the unary relation D1(ω)
c) The projection of ω of the binary relation D2(ω)
d) The possible values for the unary relation T1
e) The possible values for the binary relation T2.

Definition 22 (AHK model) Let S be a relational signature with maximal
arity(S) = a ≥ 1. Let ⟨N⟩m be the set of tuples from Nm in which the tuples
are distinct and ordered. An AHK model for S is given by

1. A family of i.i.d. latent random variables {Ui | i ∈ ⟨N⟩m, m = 0, · · · , a},

where each Ui is uniformly distributed on [0, 1].

2. A family of random variables {Di | i ∈ ⟨N⟩m, m = 0, · · · , a}. For i ∈ ⟨N⟩m

the variable Di takes values in Tm.

3. For each m = 1, · · · , a a measurable function fm : [0, 1]2m

→ Tm so that

– For i = (i1, · · · , im) ∈ ⟨N⟩m the value of Di is defined as fm(Ui), where

Ui = (U∅, Ui1, · · · , Uim, U(i1,i2), · · · , U(im−1,im), · · · , U(i1,··· ,im))

(27)

is a vector containing all Ui′-variables with i′ ⊂ i in lexicographic order.
– fm is invariant under permutations, in the sense that for any permuta-

tion σ : [m] → [m] of [m]

fm(U σ

i ) = fm(Ui)σ

where U σ
is the new multi-dimensional array obtained from Ui where
i
the dimensions i are replaced by the ordered tuple whose entries are
(σ(i1), · · · , σ(im)).

38

Juan Alvarado et al.

9.2.1 Relation between AHK model and Multi-Relational Graphons

Recall that G(n, W ) was mentioned in the Introduction and it is the random
graph of n vertices from a given graphon W sampled by picking n numbers
x1, x2, . . . , xn from [0, 1] uniformly at random and connecting every possible
edge xi and xj with probability W (xi, xj).

Let X = G(n, W ). The random variable Xi1i2 can be written as

Xi1i2 = g(U∅, Ui1, Ui2)

(28)

where U∅, Ui1, Ui2 ∈ [0, 1] are uniform random variables and

gW (x0, x1, x2) =

(cid:40)

1 x0 ≤ W (x1, x2)
otherwise
0

.

Note that (28) omits the random variable U(i1i2) so that X is a general 2-
dimensional random array. This is because the sampling process of G(n, W )
does not consider the combination of values of i1 and i2 to sample Xi1i2.

For multi-relational random graphs X = G[r](n, W ) where W ∈ (cid:102)W [r], Xi1i2
can be represented by the vector (gW1(U∅, Ui1, Ui2), · · · , gWr (U∅, Ui1, Ui2)).
Hence it is clear that any multi-relational graphon is an AHK model with
maximum arity 2 where the random variable Ui1i2 in the representation is
omitted.

9.3 Prior work on constrained graphons with maximum entropy

Radin et al. [23] proposed graphons with maximum entropy to model large
graphs constrained by subgraph density. Radin et al. [22] showed through nu-
merical experiments that graphons with maximum entropy constrained sub-
graph densities of edges and triangles are stepfunctions.

Kenyon et al. [14] prove rigorously the optimal constrained graphon are
stepfunctions when the constraints are on subgraph densities of edge and k-
star graphs.

Aristoff et al. [1] prove the large deviation principle for random directed

graphs when the constraints are on edge and outward p-star densities.

However it is an open problem to prove that the conjecture is correct. If
the conjecture is true, then the maximum entropy graphons can be obtained
by solving a finite dimensional non-linear optimization problem.

10 Conclusions

The Large Deviation Principle for Erd˝os-R´enyi multi-relational graphs enables
proving the Principle of Maximum Entropy (PME) for multi-relational graphs.
This principle states that the most typical random multi-relational graphs
constrained by any closed region in the space of multi-relational graphons are

Limits of Multi-relational Graphs

39

multi-relational graphons with maximum Boltzmann entropy. These Boltz-
mann entropy maximizers, unlike MLN which are Gibbs entropy maximizers,
are a projective model. Thus, multi-relational graphons with maximum en-
tropy are consistent statistical models, in the sense that when the number of
nodes of an observed multi-relational network goes to infinity then the network
converges to a multi-relational graphon. We show that PME on multi-relational
graphs enables the notion of the most typical worlds of a MLN by picking the
global solutions of an optimization problem. If Radin’s conjecture holds, the
optimal computation of the most typical graphons (worlds), constrained by the
expectation of logical formulas, can be obtained by a non-linear optimization
of finite dimension.

As a candidate theory for MLNs, multi-relational graphon theory has two
main issues. The first one is that there is no a rigorous proof of the conjec-
ture raised by Radin et al. in [22], neither for graphons nor multi-relational
graphons. However this conjecture has been proved for a special case [14]. The
second limitation is that Multi-relational graphon theory is only for symmetric
and binary relations. We think that it is possible to extend Multi-relational
graphons to higher order relations as long as the relations are symmetric. For
non-symmetric relations, the problem is more difficult since it is not clear what
is a suitable limiting space for sequences of growing non-symmetric relations
[20].

Declarations

Acknowledgements. This work is partially supported by a PhD student scholar-
ship from SENESCYT (Ecuador) and by ERC-StG 240186 MiGraNT: Mining
Graphs and Networks, a theory-based approach. The authors would like to
thank Ondrej Kuzelka and all the anonymous reviewers for reviewing this
work and providing very insightful comments.

References

1. Aristoff, D., Zhu, L.: Asymptotic structure and singularities in constrained directed

graphs. Stochastic Processes and their Applications 125(11), 4154–4177 (2015)

2. Aubin, J.P.: Optima and equilibria: an introduction to nonlinear analysis, vol. 140.

Springer Science & Business Media (1998)

3. Bollob´as, B., Riordan, O.: Metrics for sparse graphs. arXiv preprint arXiv:0708.1919

(2007)

4. Borgs, C., Chayes, J.T., Lov´asz, L., S´os, V.T., Vesztergombi, K.: Convergent sequences
of dense graphs i: Subgraph frequencies, metric properties and testing. Advances in
Mathematics 219(6), 1801–1851 (2008)

5. Chatterjee, S., Varadhan, S.: The large deviation principle for the erd˝os-r´enyi random

graph. European Journal of Combinatorics 32(7), 1000–1017 (2011)
6. Conway, J.B.: A course in functional analysis, vol. 96. Springer (2019)
7. Dembo, A., Zeitouni, O.: Large deviations techniques and applications, vol. 38. Springer

Science & Business Media (2009)

8. Dudley, R.M.: Real analysis and probability, vol. 74. Cambridge University Press (2002)

40

Juan Alvarado et al.

9. Getoor, L., Taskar, B.: Introduction to statistical relational learning, vol. 1. MIT press

Cambridge (2007)

10. Jaeger, M., Schulte, O.: Inference, learning, and population size: Projectivity for SRL
models. Eighth International Workshop on Statistical Relational AI (StarAI (2018)
11. Jaeger, M., Schulte, O.: A complete characterization of projectivity for statistical rela-

tional models. arXiv preprint arXiv:2004.10984 (2020)

12. Jain, D., Kirchlechner, B., Beetz, M.: Extending Markov logic to model probability
In: KI 2007: Advances in Artificial Intelligence,

distributions in relational domains.
30th Annual German Conference on AI, KI 2007, pp. 129–143 (2007)

13. Kennes, R., Smets, P.: Computational aspects of the mobius transform. arXiv preprint

arXiv:1304.1122 (2013)

14. Kenyon, R., Radin, C., Ren, K., Sadun, L.: Multipodal structure and phase transitions
in large constrained graphs. Journal of Statistical Physics 168(2), 233–258 (2017)
15. Kuˇzelka, O., Wang, Y., Davis, J., Schockaert, S.: Relational marginal problems: Theory
and estimation. In: Proceedings of the Thirty-Second AAAI Conference on Artificial
Intelligence (AAAI-18) (2018)

16. Lov´asz, L.: Large networks and graph limits, vol. 60. American Mathematical Soc.

(2012)

17. Lov´asz, L., Szegedy, B.: Limits of dense graph sequences. Journal of Combinatorial

Theory, Series B 96(6), 933–957 (2006)

18. Lov´asz, L., Szegedy, B.: Szemer´edi’s lemma for the analyst. GAFA Geometric And

Functional Analysis 17(1), 252–270 (2007)

19. Lov´asz, L., Szegedy, B.: Limits of compact decorated graphs.

arXiv preprint

arXiv:1010.5155 (2010)

20. Neˇsetˇril, J., de Mendez, P.O.: First-order limits, an analytical perspective. European

Journal of Combinatorics 52, 368–388 (2016)

21. Pedersen, G.K.: Analysis now, vol. 118. Springer Science & Business Media (2012)
22. Radin, C., Ren, K., Sadun, L.: The asymptotics of large constrained graphs. Journal of

Physics A: Mathematical and Theoretical 47(17), 175001 (2014)

23. Radin, C., Sadun, L.: Phase transitions in a complex network. Journal of Physics A:

Mathematical and Theoretical 46(30), 305002 (2013)

24. Richardson, M., Domingos, P.: Markov logic networks. Machine Learning 62(1-2), 107–

136 (2006)

25. Schulte, O., Khosravi, H., Kirkpatrick, A.E., Gao, T., Zhu, Y.: Modelling relational

statistics with bayes nets. Machine Learning 94(1), 105–125 (2014)

26. Shalizi, C.R., Rinaldo, A.: Consistency under sampling of exponential random graph

models. Annals of statistics 41(2), 508 (2013)

27. Wainwright, M.J., Jordan, M.I.: Graphical models, exponential families and variational

inference. Foundations and Trends in Machine Learning 1, 1—305 (2008)

28. Walters, P.: An introduction to ergodic theory, vol. 79. Springer Science & Business

Media (2000)

29. Wasserman, S., Pattison, P.: Logit models and logistic regressions for social networks:
I. an introduction to markov graphs andp. Psychometrika 61(3), 401–425 (1996)

Appendix

In this section we provide the necessary concepts from topology, measure the-
ory and compactness on vector spaces. We mostly follow notation and defini-
tions from [8] and [21], except for the definitions of measure preserving map
from [28].

Some concepts of topology

Definition 23 (Topological Closure and Interior of a set) Let X be a
topological space and let A ⊂ X . The topological closure of A and denoted by

Limits of Multi-relational Graphs

41

A is the intersection of all closed sets that contain A. The interior of A and
denoted by A◦ is the union of all open sets are contained in A.

Now we define compact spaces which are a type of topological spaces.

Definition 24 (Compact space) Let X be a topological space. We say that
i=1 in X there is a subsequence (xni)∞
X is compact if for every sequence (xi)∞
i=1
that is convergent.

Another alternative definition for compactness is the following. We say that
the family of open sets {Oi} is an open cover for A ⊂ X if A ⊂ ∪iOi. Then A
is compact if for any cover {Oi} of A, it is always possible to pick a subfamily
of {Oi} such that A ⊂ ∪n

j=1Oij .

Compactness of a space S ensures the existence of limit points i.e. limits of
convergent subsequences of any sequence on S. For instance, every closed and
bounded subset of Rn is compact.

Definition 25 (Lower-continuity) We say that a function f is lower semi-
continuous if

lim inf
x→x0

f (x) ≥ f (x0).

Lower-continuity is a sufficient condition to state that inf x∈X f (x) and minx∈X f (x)
are equivalent when X is a compact set.

Theorem 10 (Corollary 1.2 [2]) If f is a lower-semi continuous and X ⊂ X
is compact set then inf x∈X f (x) = minx∈X f (x) ∈ f (X).

Some concepts of measure theory

Next we define σ-algebras, which are building blocks of probability theory.

Definition 26 (σ-Algebra) Let X be a set. We say that a collection of
subsets of X, AX ⊂ P(X), is a σ-algebra on X if (i) AX includes ∅, (ii) is
closed under complement, and (iii) is closed under countable unions.

Having defined σ-algebras, we now define the following notions that we
will need in the technical arguments in this paper: measure functions, outer
measures and measurable sets, measure spaces, measure functions and measure-
preserving maps.

Definition 27 (Measure function) Let AX be a σ-algebra on X. We say
that a function µ : AX → R≥0 ∪ {+∞} is a measure function if
– µ(∅) = 0
– If A ∈ A then µ(A) ≥ 0
– For all countable collections of An ∈ A such that Ai ∩ Aj = ∅ for i ̸= j it

holds that

µ(∪∞

i=1Ai) =

∞
(cid:88)

i=1

µ(Ai).

42

Juan Alvarado et al.

Definition 28 (Outer measure) Let AX be a σ-algebra and let µX be a
measure on X. For E ⊂ X the outer measure of E is defined by,

µ∗

X (E) := inf






(cid:88)

1≤n<∞

µ(An) | An ∈ AX , E ⊆ ∪nAn






.

(Here we note that the infimum of an empty set is +∞.)

Next we define measurable sets using the just introduced notion of outer-

measure.

Definition 29 (Measurable set) We say set F ⊂ X is a µ∗-measurable,
where µ∗ us an outer-measure, iff for every set E ⊂ X, we have

X (E) = µ∗
µ∗

X (E ∩ F ) + µ∗

X (E \ F )

X ) be the collection of sets in X that are measurable. Then MX (µ∗)
Let MX (µ∗
is σ-algebra and µ∗ is a measure function on it (see e.g. Lemma 3.1.8 [8]): hence
(X, MX (µ∗

X ) is a measure space.

X ), µ∗

Definition 30 (Measure space) We say that the triple (X , A, µ) is a mea-
sure space if X a topological space, A is the Borel σ-algebra generated by the
open sets of X , and µ is a measure function on A.

Definition 31 (Measurable function) Let (Xi, Ai, λi), i = 1, 2 be measure
spaces. Then f : X1 → X2 is a measurable function if for any Borel set A ∈ A2
then its preimage f −1(A) is a Borel set.

Definition 32 (Measure preserving map) Let (Xi, Ai, λi), i = 1, 2 be
two measure spaces. Then the measurable function σ : X1 → X2 is a measure
preserving map or Measure preserving transformation if for any Borel set A ∈
A2 we have λ1(σ−1(A)) = λ2(A).

