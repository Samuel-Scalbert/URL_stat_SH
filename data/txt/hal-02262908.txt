MuSCA: a multi-scale source-sink carbon allocation
model to 2 explore carbon allocation in plants. An
application on static apple-tree
Francesco Reyes, Benoit Pallas, Christophe Pradal, Federico Vaggi, Tagliavini

Marco, Evelyne Costes, Damiano Zanotelli, Damiano Gianelle

To cite this version:

Francesco Reyes, Benoit Pallas, Christophe Pradal, Federico Vaggi, Tagliavini Marco, et al.. MuSCA: a
multi-scale source-sink carbon allocation model to 2 explore carbon allocation in plants. An application
on static apple-tree. Annals of Botany, 2020, 126 (4), pp.571-585.
￿hal-
02262908￿

￿10.1093/aob/mcz122￿.

HAL Id: hal-02262908

https://inria.hal.science/hal-02262908

Submitted on 2 Aug 2019

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.

Distributed under a Creative Commons Attribution 4.0 International License

Original Article 

MuSCA: a multi-scale source-sink carbon allocation model to 

explore carbon allocation in plants. An application on static apple-tree 

structures. 

F. Reyes1,2,3,*, B. Pallas4, C. Pradal4,5, F. Vaggi6, D. Zanotelli3, M. Tagliavini3, D. Gianelle2, E. 

Costes4 

1 DAFNE, 01100 University of Tuscia, Viterbo, Italy, 2DASB, CRI, Fondazione E. Mach, 38010 San Michele 

all'Adige, Italy, 3Faculty of Science and Technology, Free University of Bozen-Bolzano, 39100 Bolzano, Italy, 4AGAP, 
Univ. Montpellier, CIRAD, INRA, SupAgro, Montpellier, France, 5CIRAD, UMR AGAP & Inria Zenith, Montpellier, 
France, 6Amazon, 98100 Seattle, USA, 7INRA, UMR 547 PIAF, F-63000 Clermont-Ferrand, France 

Running title: MuSCA multi-scale carbon allocation model 
*For correspondence. Email reyes.francesco@protonmail.com 

1 

2 

3 

4 

5 

6 

7 
8 
9 
10 
11 
12 

13 

1 

 
 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

ABSTRACT 

Background and aims 

Carbon allocation in plants is usually represented at a topological scale, specific to each model. 

This  makes  the  results  obtained  by different  models,  and  the  impact  of  their  scales of 

representation, difficult to compare. In this study, we developed a Multi Scale Carbon 

Allocation model (MuSCA) that allows using different, user-defined, topological scales 

of  a  plant,  and  assessing  the  impact  of  each  spatial  scale  on  simulated  results  and 

computation time. 

Methods 

Model multi-scale consistency and behavior were tested on three realistic apple tree structures. 

Carbon allocation was computed at five scales, spanning from the metamer (the finest 
scale,  used  as  a  reference)  up  to  1st  order  branches,  and  for  different  values  of  a  sap 

friction coefficient. Fruit dry mass increments were compared across spatial scales and 

with field data. 

Key Results 

The model was able to represent effects of competition for carbon assimilates on fruit growth. 

Intermediate friction parameter values provided results that best fitted field data. Fruit 

growth simulated at the metamer scale differed from about 1% at growth unit scale up 

to 60% at first order branch and fruiting unit scales. Generally, the coarser  the spatial 

scale  the  more  predicted  fruit  growth  diverged  from  the  reference.  Coherence  in  fruit 

growth  across  scales  was  also  differentially  impacted,  depending  on  the  tree  structure 

considered.  Decreasing  the  topological  resolution  reduced  computation  time  by  up  to 

four orders of magnitude. 

Conclusions 

MuSCA revealed that the topological scale has a major influence on the simulation of carbon 

allocation. This suggests that the scale should be a factor which is carefully evaluated 

when using a carbon allocation model, or when comparing results produced by different 

models.  Finally,  with  MuSCA,  trades-off  between  computation  time  and  prediction 

accuracy can be evaluated by changing topological scales. 

Keywords: MuSCA, multi scale, carbon allocation, plant growth, tree growth, functional-structural 

plant modeling, FSPM, multiscale tree graph, source, sink, apple, plant architecture 

2 

 
1 
2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

34 

INTRODUCTION 

Carbon allocation is the process by which carbon assimilated by leaves, or stored in the form 

of carbohydrates, is transferred, via the conductive vessels (or phloem tissue) to other plant parts, 

where it is used primarily for respiration and growth. It is generally accepted that the phloem sap 

moves  as  a  consequence  of  osmotically  generated  pressure  gradient,  as  described  by  the  Munch 

theory  (Münch  1930).  Gradients  are  generated  by  the  differences  in  the  concentrations  of  carbon 

(C) assimilates between C-sources (mainly leaves, where C-assimilates are loaded into the phloem) 

and sinks (where C-assimilates are unloaded from the phloem). The Münch theory has been refined 

over time (e.g. with the introduction of the leakage-retrieval mechanism (Thorpe  et al. 2005) and 

complementary  hypotheses  have  been  proposed  to  explain  the  lack  of  fit  with  experimental 

evidences (e.g. sieve tubes decomposed in shorter, overlapping components, at the edge of which 

solutes are transported at the expense of internal energy) (De Schepper et al. 2013). The underlying 

principles,  however,  are  still  considered  as  valid.  As  such,  the  C-allocation  process  is  thought  to 

depend primarily on the amount and distribution of the available C-supplies, on demands along the 

plant structure and on the possibility of C-supplies to flow via the phloem (Ryan and Asao 2014). In 

models  of  small  plants,  however,  the  simplifying  assumption  that  distance  has  no  effect  on  C-

availability  or  phloem  osmotic  potential  (known  as  the  ‘common  assimilate  pool’)  can  be  made 

(Heuvelink 1995; Guo et al. 2006; Luquet et al. 2006; De Swaef et al. 2003). 

When  plant  topology  increases  in  complexity,  the  modeling  approaches  to  C-allocation 

present  in  the  literature  can  be  organized  in  four,  partly  overlapping,  categories  (Thornley  and 

Johnson 1990; Lacointe 2000; Le Roux et al. 2001; Génard et al. 2008): models based on empirical 

relationships between plant parts and/or the environment; teleonomic models representing the plant 

as moving towards an a priori defined specific state; source–sink driven models, in which different 

plant components are supposed to attract C-assimilates with different strengths and lastly transport 

resistance  and  biochemical  models,  which  represent  phloem  transport  as  starting  from  osmotic 

gradients  and  biochemical  conversions.  The  most  mechanistic  models,  which  represent  osmotic 

flows  as  starting  from  osmotic  gradients,  imply  complex  formalizations  and  highly  detailed  plant 

descriptions  and  therefore  received  relatively  limited  attention  (Bancal  2002).  The  modest 

mathematical  complexity  of  source  sink  models  has  led  to  them  becoming  the  focus  of  a  much 

larger  number  of  studies.  In  all  cases  the  representation  of  C-allocation  on  large  tree  structures 

described  at  high  resolution  remains  computationally  intractable  (Balandier  et  al.  2000;  Bancal 

2002). 

Each model represents the plant structures, and the process of carbon allocation, at a specific 

scale.  The  choice  of  scale  may  be  driven  by  management  or  research  needs,  by  the  computation 

3 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

time needed for the simulations and by the resolution at which the calibration and testing data was 

obtained. Such scales range from the individual metamer (M) (Allen  et al. 2005) to collections of 

metamers that, grouped according to criteria such as their age, position or organ type (Kang  et al. 

2008), constitute larger portions of a tree structure, such as branches, main axis or even whole plant 

compartments (Lakso and Johnson 1990; Kang et al. 2008). 

By way of example, the L-PEACH model (Grossman and DeJong 1994; Allen et al. 2005) is 

a  reference  for  completeness  of  the  described  processes  and  represents  tree  growth  over  multiple 

years. This uses a transport resistance analogy to mimic C-transport at the M scale (internode, leaf, 

fruit). The SIMWAL model represents the growth of a young walnut tree across several years. This 

is  organized  in  axes,  which  are  divided  into  growth  units  (GU,  the  scale  of  C-allocation), 

themselves  composed  of  internodes  and  nodes  (Balandier  et  al.  2000).  A  GU  is  an  organisation 

level typical of plants with rhythmic growth. It corresponds to a portion of axis developed without 

interruption during an elongation period, and can be visually identified as bounded by two zones of 

scales that had protected the apical meristem in the bud during resting period. The QualiTree model 

represents  growth  and  quality  of  fruits  on  a  peach  tree  structure,  at  the  fruiting  unit  (FU)  scale, 

during a single growth season (Lescourret et al. 2011, Pallas et al. 2016).  A FU includes the set of 

shoots born from a common section of one year old wood. In this model all the different types of 

organs in a FU are considered similar with respect to assimilates exchange, which depends on their 

respective distances only. 

The  computation  of  C-allocation  by  a  model  is  affected  by  both  the  formalism  used  to 

describe the physiological processes and the discretization of the plant. Because of this, identifying 

what causes differences in results produced by different models can be difficult. 

The  present  work  proposes  a  new,  source-sink,  Multi-Scale  Carbon  Allocation  model 

(named  MuSCA),  whose  aim  is  to  allow  for  a  flexible  definition  of  topological  plant  scales 

concomitant  with  the  simulation  of  carbon  allocation.  The  model  relies  on  the  use  of  Multi-scale 

Tree  Graph  (MTG)  (Godin  and  Caraglio  1998),  a  formalism  inspired  by  the  observation  of  the 

multi-scale  organization  of  plant  structures  (Barthélémy  1991;  Barthélémy  and  Caraglio  2007; 

Balduzzi  et  al.  2017).  MTG  allows  for  the  topological  description  of  a  plant  at  multiple,  nested, 

spatial  scales  on  the  same  graph.  In  addition  to  the  connections  and  boundaries  of  the  described 

topological scales, intensive (e.g. organ type) or extensive (e.g. geometrical features) properties can 

be assigned to the individual plant component at any scale. MTG has been previously used in plant 

architecture  analyses  (Costes  et  al.  2003),  in  radiation  interception  (Da  Silva,  Han,  and  Costes 

2014),  as  well  as  to  simulate  physiological  processes  (Fournier  et  al.  2010;  Ndour  et  al.  2017; 

4 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

Barillot  et  al.  2018)  or  model  plant-pathosystems  (Garin  et  al.  2014,  2018;  Robert  et  al.  2018) 

(albeit by using a single scale at a time). 

In  this  paper,  we  provide  an  overview  of  the  MuSCA  model,  define  its  scope  and  inputs, 

present  the  formalisms  used  to  compute  C-allocation  and  to  move  across  scales.  The  model  is 

calibrated for the apple tree (Malus x domestica Borkh.), Fuji cultivar, for C-demands. It is linked to 

a radiative model for the estimation of C-assimilates by leaves. The model is then applied on three 

contrasted apple tree structures and for different values of an empirical sap friction parameter, and 

the  effects  of  competition  for  C-assimilates  on  fruit  growth  are  analyzed.  Field  observations  are 

then  compared  to  the  fruit  growth  distribution  simulated  on  one  tree  structure  to  retain  the  sap 

friction parameter values that might best represent sap flow dynamics. The ability of the multi-scale 

formalism to produce similar results across scales and the influence of the scale of representation on 

the  simulated  carbon  allocation  are  analysed.  Finally,  the  trade-off  between  computational 

efficiency and accuracy are discussed, also in respect to the possible interactions between  specific 

tree structure and the topological scale used. 

15 

MATERIALS AND METHODS 

16 

Model Description 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

Overview 

MuSCA  is  a  generic,  functional  structural  plant  model  (FSPM)  (Vos  et  al.  2010) 

representing  the  carbon  allocation  and  organ  growth  of  a  plant  at  different,  user-defined,  spatial 

scales,  while  taking  into  account  competition  and  distances  between  carbon  sinks  and  supplies 

present on the plant (Fig.1). The model has a modular architecture and each module is generalized 

so that only a few of them are specific to a given cultivar or species (Table 1, Table 2). The model 

is integrated in the open-source OpenAlea environment (Pradal et al. 2008, 2015) and implemented 

in  the  Python  language.  The  model  reuses  existing  OpenAlea  components,  such  as  the  MTG 

dynamic  data-structure  (Godin  and  Caraglio  1998;  https://github.com/openalea/mtg),  used  to 

represent the multiscale topology of plant structures, the PlantGL library (Pradal et al. 2009) used to 

represent  the  3D  geometry,  and  the  RATP  radiative  model  (Sinoquet  et  al.  2001).  The  MuSCA 

model simulates biomass accumulation over a single vegetative season. 

Input plant structures and creation of new scales 

5 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

The  input  plant  structures  of  MuSCA  are  MTGs  where  individual  plant  components  are 

characterized by qualitative or quantitative information. Qualitative information refers to the organ 

type  or  the  type  of  connection  between  vertex  and  parent  (i.e.  branching  or  succession). 

Quantitative information may include parameters such as the geometry or age of a plant component. 

This  information  can  be  used  to  create  criteria  defining  the  membership  of  individual  plant 

components to larger groups of adjacent plant components. 

Movement of carbon 

The  movement  of  the  available  carbon  (Fij),  from  a  C-supply  (i)  to  a  C-sink  (j),  is 

represented as a function of the C-available in the supply (ACPi), the sink C-demand (Demandj) (eq. 

1a),  and  is  inversely  related  to  the  distance  (dist)  between  source  and  sink  and  to  a  sap  friction 

parameter  (h)  (eq.  1b),  along  the  plant  topology.  The  h  factor  is  an  empirical  friction  parameter, 

proposed in previous source-sink carbon allocation models (Balandier et al. 2000; Lescourret et al. 

2011).  Larger values  of this parameter amplify  the effects of distance resulting in  relatively large 

amounts of C allocated next to the source, while a value of zero implies no effect of distance. This 

equation is inspired by a previously defined equation (SIMWAL model, Balandier et al. 2000). 

(cid:1832)(cid:3036)(cid:3037) =

(cid:3005)(cid:3032)(cid:3040)(cid:3028)(cid:3041)(cid:3031)(cid:3285)∗(cid:3033)(cid:4666)(cid:3031)(cid:3036)(cid:3046)(cid:3047)(cid:3284)(cid:3285),ℎ(cid:4667)∗(cid:3004)(cid:3284)
∑
(cid:3005)(cid:3032)(cid:3040)(cid:3028)(cid:3041)(cid:3031)(cid:3286)∗(cid:3033)(cid:4666)(cid:3031)(cid:3036)(cid:3046)(cid:3047)(cid:3284)(cid:3286),ℎ(cid:4667)


(cid:3286)=1

(cid:1858)(cid:4666)(cid:1856)(cid:1871)(cid:1872)(cid:3036)(cid:3037), ℎ(cid:4667) =

 (cid:2869)

(cid:4666)(cid:2869)+(cid:3031)(cid:3036)(cid:3046)(cid:3047)(cid:3284)(cid:3286)(cid:4667)ℎ   

(eq. 1a) 

(eq. 1b) 

If  in  excess,  the  C-allocated  to  a  plant  component  will  just  fulfill  its  C-demand,  while the 

excess will be stored in a reserve pool for this compartment and be considered as a supply provided 

by that component on the following time-step (Balandier et al. 2000). However, since simulations 

in this study lasted for only one day, this phenomena never occurred. 

The  carbon  allocated  to  a  topological  element  is  eventually  divided  among  the  different 

organs  that  constitute  it  (at  the  metamer  scale:  fruit,  leaf,  internode),  proportionally  to  their 

individual carbon demand. 

Calculation of distances 

A representation of the C-allocation process coherent at multiple topological scales requires 

the  definition  of  an  equation  for  the  calculation  of  distances,  independent  of  the  scale  of 

representation. 

6 

 
 
 
 
   
 
 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

34 

Modeling  C-allocation  is  computationally  demanding  as,  in  a  source-sink  formulation,  it 

requires  to  compute  the  distance  between  all  pairs  of  carbon  sinks  and  sources  in  the  tree.  In  a 

MTG, sources and sinks are represented by vertices in a tree graph. The complexity of computing 
the  distance  between  all  pairs  is  quadratic,  i.e.  requires  around  n2  operations,    for  a  tree  of  n 

vertices.  We  thus  designed  an  algorithm,  based  on  the  multi-scale  organization  of  plants,  which 

allows  to  reduce  the  number  of  operations  by  reducing  the  number  of  independent  plant  vertices 

that must be compared. 

Each  MTG  vertex  (i)  is  characterized,  among  other  properties,  by  three  dimensional 

coordinates (basal and top), the possibility to have a parent (named i-1), and one or multiple sons 

(the vertex i is the son of its parent). In a MTG, a vertex at a coarser scale (I, called complex) is 

composed  of  one  or  more  vertices  at  the  finer  scale  (called  components  of  I),  as  in  the  case  of  a 

shoot composed of several internodes. 

The distance (disti,j) among two vertices (i, j) in a MTG depends on the sequence of vertices 

that connect i and j (called topological path). It corresponds to the sum of i) the semi-lengths of the 

extremities i and j, and ii) the length of the topological path between the bases of i and j (eq. 2a, 2b 

Fig.2).  The  semi-length  of  an  element  at  different  scales  is  computed  as  the  distance  between  its 

base and barycenter. 

In  order  to  assess  the  length  of  this  path,  it  is  necessary  to  identify  the  Greatest  Common 

Ancestor (GCA) of vertices i and j (Fig.2). Given the two paths connecting the tree root to i and j, 

the Greatest Common Ancestor of vertex i and vertex j, GCA(i,j), is identified as the vertex that is 

contained in both paths and that is the closest to i and j. The topological path between i and j is the 

union  of  the  vertices  between  i  and  GCA(i,j)  and  the  path  between  j  and  GCA(i,j)  with  GCA(i,j) 

(Fig.2). The length of the path  (disti,j)  is computed as the sum of the length of each of its internal 

elements plus the semi-lengths of its extremities, minus twice the length of the GCA (Fig.2, eq.2a). 

In  addition,  the  distance  between  the  basis  of  the  first  two  elements  of  the  path,  that  are  directly 

inserted in the GCA(i,j) and are not connected with each other, is added (eq.2a). This is the case at 

corser scale when different ramifications are connected to the trunk at different location. When the 

GCA is either i or j, the length is just the sum of the length of all its internal elements plus the semi-

length of its extremities (eq.2b). 

(cid:1856)(cid:1871)(cid:1872)(cid:3036),(cid:3037) = (cid:1871)(cid:1865)(cid:1864)(cid:1872)ℎ(cid:3036) + (cid:1856)(cid:1871)(cid:1872)(cid:3036),(cid:3004) + (cid:1856)(cid:1871)(cid:1872)(cid:3037),(cid:3004) + (cid:1871)(cid:1865)(cid:1864)(cid:1872)ℎ(cid:3037) − 2(cid:1864)(cid:1872)ℎ(cid:4666)(cid:1833)(cid:1829)(cid:4667) +

(cid:1856)(cid:1871)(cid:1872)(cid:4666)(cid:1854)(cid:1853)(cid:1871)(cid:3046)(cid:3042)(cid:3041)(cid:4666)(cid:3004)(cid:4667)(cid:3036), (cid:1854)(cid:1853)(cid:1871)(cid:3046)(cid:3042)(cid:3041)(cid:4666)(cid:3004)(cid:4667)(cid:3037)(cid:4667)  (eq. 2a) 

where (cid:1871)(cid:1867)(cid:4666)(cid:1833)(cid:1829)(cid:4667)(resp. j) is the first descendant in the path(i,GCA(i,j)) (resp. j). 

7 

 
 
 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

if GCA is i or j,   

(cid:1856)(cid:1871)(cid:1872)(cid:3036),(cid:3037) = (cid:1856)(cid:1871)(cid:1872)(cid:3036)−(cid:2869),(cid:3037)−(cid:2869) + (cid:1871)(cid:1865)(cid:1864)(cid:1872)ℎ(cid:3036) + (cid:1871)(cid:1865)(cid:1864)(cid:1872)ℎ(cid:3037) 

(eq. 2b) 

The calculation of the spatial coordinates of the basis and barycenters depends on the scale 

(Fig.2B).  At  M  scale,  the  basal  coordinates  of  a  vertex  correspond  to  the  top  coordinates  of  its 

parent vertex (eq. 3a). For the basal vertex of the MTG, the only without a parent, coordinates  are 

stored in the complex of the same vertex. Barycenter coordinates are obtained as the mean of its top 

and base coordinates (eq. 3b). 

At  coarser  scales,  the  basal  coordinates  of  a  vertex  I  are  the  basal  coordinates  of  its  first 

component at the metamer scale i.e. the one whose parent does not belong to I (eq. 3c). These basal 

coordinates are inherited from top coordinates of its parent (see eq. 3a). 

Regarding the coordinates of the barycentre of a coarse scale vertex, these are calculated as 

the  mean  of  the  coordinates  of  the  barycenters  of  its  components,  weighted  by  their  individual 

lengths (as in eq. 3d for the x coordinate). 

At metamer scale: 

(cid:1854)(cid:1853)(cid:1871)(cid:3036) = (cid:1872)(cid:1867)(cid:1868)(cid:3043)(cid:3028)(cid:3045)(cid:3032)(cid:3041)(cid:3047)(cid:4666)(cid:3036)(cid:4667)   

(cid:1854)(cid:1853)(cid:1870)(cid:1855)(cid:1872)(cid:1870),(cid:3036) =

(cid:3047)(cid:3042)(cid:3043),(cid:3284)+(cid:3029)(cid:3028)(cid:3046)(cid:3032)
(cid:2870)

At coarse scales: 

∀ i ⊆ I | parent(i) not ⊆ I: 

 (cid:1854)(cid:1853)(cid:1871) = (cid:1872)(cid:1867)(cid:1868)(cid:3043)(cid:3028)(cid:3045)(cid:3032)(cid:3041)(cid:3047)(cid:4666)(cid:3036)(cid:4667)   

(cid:1854)(cid:1853)(cid:1870)(cid:1855)(cid:1872)(cid:1870), =

∑ (cid:3029)(cid:3028)(cid:3045)(cid:3030)(cid:3032)(cid:3041)(cid:3047)(cid:3032)(cid:3045),(cid:3284)∗ (cid:3039)(cid:3032)(cid:3041)(cid:3034)(cid:3047)ℎ(cid:3284)
∑ (cid:3039)(cid:3032)(cid:3041)(cid:3034)(cid:3047)ℎ(cid:3284)

Up- and down- scaling 

(eq. 3a) 

(eq. 3b) 

(eq. 3c) 

(eq. 3d) 

In  MuSCA,  some  of  the  plant  properties  available  at  one  scale  are  used  to  provide  a 

description  of  the  same  properties  at  a  coarser  (up-scaling)  or  finer  (down-scaling)  scale.  This  is 

done  in  simulations  running  at  coarse  scales,  prior  and  after  the  calculation  of  carbon  flows, 

respectively  by  calling  up-  and  down-  scaling  functions  (except  for  the  initial  calculation  of 

biomasses,  see  part  From  geometry  to  biomass).  The  up-scaling  of  properties  such  as  biomass, 

carbon  supplies  and  demands  of  plant  parts  is  simply  done  by  summing  up  the  property  values 

8 

 
 
 
 
 
 
 
 
 
 
  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
1 

2 

3 

4 

5 

6 
7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

stored  in  all  the  vertices  that  are  contained  within  the  topological  boundaries  of  the  coarser  scale 

component.  Conversely,  down-scaling  the  same  properties  from  a  coarse  scale  component  to  its 

constituting  elements  requires  some  assumptions.  In  particular,  when  the  carbon  allocated  to  a 

coarse scale component is down-scaled, it is assigned proportionally to the relative carbon demands 

of its constituent elements. 

Application to realistic tree structures: the case of apple (Malus x domestica Borkh) 
In  order  to  assess  the  ability  of  the  model  to  simulate  similar  growths  across  multiple  scales,  to 

represent competition for C-assimilates and the effect of the scale on computation time, we applied 

MuSCA on different tree structures of apple trees, represented at multiple topological scales). These 

were MTGs of three apple trees simulated by the MAppleT architectural model (Costes et al. 2008). 

MAppleT combines markovian models for the simulation of growth unit succession and branching 

with  a  biomechanical  model  for  axis  bending.  Along  growth  units,  individual  leaf  area  was 

simulated  based  on  a  logistic  function  and  assuming  different  final  values  of  leaf  areas  for  the 

preformed  (7  leaves)  and  neoformed  parts  of  the  GU  (Da    Silva  et  al.,  2014a).  This  model  was 

previously calibrated on Fuji cultivar (Costes et al., 2008) and so that it could be used to generate 

one four year old ‘Fuji’ tree that was used in this study. Moreover, two other trees were simulated 

by initiating simulations using two different sequences of lateral types along the trunk observed on 

trees originated from a  bi-parental population, as  previously proposed by Da Silva et al. (2014b). 

These two trees were selected within the population in order to test our C allocation model on trees 

displaying contrasted architectures. Simulations were run for each individual tree on a single day, so 

that the direct effect of changing the topological scale could be analyzed while excluding possible 

retroactions  and  cumulative  effects  (such  as  the  re-use  of  C  delivered  in  excess  to  a  plant 

component).  A  partly  cloudy  day  of  late  June  (day  of  the  year  =  182)  was  chosen  to  drive 

photosynthesis. This allowed on the one hand C-limiting conditions to occur (the use of very sunny 

days resulted in C-allocation generally satisfying the whole fruit C-demand), and on the other hand 

to represent trees in which shoot elongation, and thus the creation of new internodes, ended. Initial 

fruit dry weight was set to be identical for all fruits and equal to 8 g (Reyes et al. 2016). 

For  the  application  of  the  carbon  allocation  model  on  tree  structures,  we  developed  a  few 

modules containing some species specific parameters and allometric relationships (Table 1, Table 

2).  These  were  needed,  firstly  to  convert  the  geometric  descriptions  of  the  trees  contained  in  the 

MTGs  into  values  of  biomass  (Supplementary  Information:  Input  tree  structures),  and  then  to 

estimate the values of carbon demands for dry matter accumulation (see Source and Sink strengths). 

Source and Sink strengths 

9 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

In MuSCA, the amount of C-assimilates available from photosynthesis in individual leaves 

is estimated with a radiative model: RATP: (Sinoquet et al. 2001) integrated within the OpenAlea 

platform  and  running  on  MTG  structures  (see  also  Supplementary  Information:  Inputs  of  the 

MuSCA model). In RATP the tree structure is first discretized into voxels of user-defined size. The 

voxel specific mean leaf area density (turbid medium assumption) is calculated based on the plant 

3D representation in space. This is then used to compute the direct and diffused PAR and NIR light 

intercepted in each voxel, and its related photosynthesis, every 30 minutes, across the whole day. 

The C-assimilation estimated per leaf unit surface is first associated to each leaf and integrated over 

the whole day, and then converted into dry matter uptake per leaf per day. In this study, a previous 

calibration of RATP for the apple trees, Fuji cultivar (Massonnet et al. 2006), was used. 

Sink  strengths  were  calculated  as  the  sum  of  the  carbon  demands  for  dry  matter 

accumulation into the plant structure and the carbon lost by respiration (Table 2). The first term was 

assumed  to  follow  maximum  potential  relative  growth  rates.  Maximum  potential  growth  curves 

were  obtained  by  fitting  thermal-time-dependent  gompertz  functions  to  organ-type-specific 

maximum dry weights (Grossman and DeJong 1995) of proleptic and epicormic shoots, and fruits 

of  apple  Fuji  trees  growing  in  conditions  where  competition  for  carbohydrates  was  minimized 

(Reyes  et  al.  2016).  Their  normalized  derivatives  (Hunt  1982;  Grossman  and  DeJong  1995) 

represent  the  seasonal  patterns  of  organ  type  specific  activities  (or  maximum  potential  relative 

growth rates). Regarding the old wood, the slope of a linear relationship fitted through the logarithm 

of  the  relative  growth  rate  of  the  old  wood  biomass  vs  growing  degree  days  (GDD)  obtained  by 

Reyes et al. (2016) was used. Values of sink activities of the current days were then used, together 

with the organ dry weight and the Growing Degree Days (GDD), to estimate the C-demand for dry 

matter accumulation ((cid:1830)(cid:1830)(cid:1865)(cid:1853)(cid:1856)(cid:3037)) of the same day (eq.4) (Marcelis 1996) at the metamer scale. 

(cid:1830) (cid:1830)(cid:1865)(cid:1853)(cid:1856)(cid:3037) = (cid:1871)(cid:1863) (cid:1856)(cid:1870) (cid:1875)ℎ(cid:1872) ∗ (cid:1871)(cid:1863) (cid:1853)(cid:1855)(cid:1872)(cid:1874)(cid:1872)(cid:4666)(cid:1833)(cid:1830)(cid:1830)(cid:4667)(cid:3042)(cid:3045)(cid:3034)(cid:3028)(cid:3041)(cid:3047)(cid:3043)(cid:3032) ∗ (cid:1833)(cid:1830)(cid:1830)(cid:3031)(cid:3028) (eq.4) 

Respiration was split into maintenance and growth components as proposed by Lescourret et 

al. (2011) and Pallas et al. (2016). The maintenance components was modeled as proportional to dry 

mass, a Q10 law, and a maintenance respiration parameter. Growth respiration was considered as 

proportional  to  the  growth  respiration  coefficient  and  to  the  sum  of  the  carbon  demanded  for 

maintenance respiration and for the dry matter increase. Parameter values provided by Pallas et al., 

2016  were used. 

Definition of topological scales 

10 

 
 
 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

Five  biologically  relevant  scales  of  representation  of  trees  were  used.  Two  of  them  are 

commonly used in MTG (metamer and growth unit) and three are newly defined (trunk, branches 
and shoots; 1st order branch and inter-branches; fruiting unit) (Fig.3). New scales were defined by 

setting criteria for the identification of edges, along the plant topology, among which all elements 

could be considered as belonging to the same group. The finest scale considered was the metamer 

(M)  (or  phytomer)  that  is  composed  of  a  node  and  its  leaf(ves)  and  axillary  bud(s)  plus  the 

subtending  internode.  This  scale  was  considered  as  a  reference  for  the  representation  of  carbon 

allocation in this study. The second scale corresponds to the GU (Barthélémy 1991). The third scale 

corresponded to the discretization of the tree in main trunk, first order branches originating from it 

and  the  leafy  shoots  (Trunk,  Branches  and  Shoots,  TBS).  The  fourth  scale  corresponded  to  first 

order  branches  originating  from  the  main  trunk,  but  without  considering  the  individual  shoots 

separately (BR1). The fifth scale corresponded to the FU. In all scales, the root was considered as a 

compartment in itself. 

Simulation of fruit growth 

We run simulations for the three apple tree structures represented at the five topological scales 

defined above. In  order to  identify a biologically sensible value of the friction parameter (h), this 

was varied across a range of almost two orders of magnitude (0.5-16).  

We tested the model ability to simulate competition for the available C among tree organs at M 

scale. This was done by analysing the growth of individual fruits in relation to both the fruit load 

and the carbon assimilated in the surrounding of the analysed fruit. In particular, a neighborhood of 

the analyzed fruit is defined as the set of metamers for which the geometrical distance between their 

barycenter and the barycenter of the metamer containing the fruit is lower than a given threshold. 

Considered a growing fruit, the ratio between the amount of C-assimilated and the number of fruits 

present in its neighborhood represents a comfort index with respect to the availability of C for fruit 

growth  and the  occurrence  of  competition  with  other  fruits. As  such,  the  correlation  between this 

ratio and the simulated growth of individual fruits belonging to the same neighborhood illustrates 

whether  fruit  growth  is  affected  by  the  competition  for  C-assimilates  occurring  within  the  area 

around  the  analysed  fruit.  Based  on  these  considerations,  the  values  of  C-assimilated  and  the 

number of other fruits in the surrounding of individual fruits present on each tree was calculated for 

neighborhoods of incremental radii (radii of 5, 15, 25, 35, 45, 55, 65, 75, 95, 115, 135 cm) and for 

different friction parameters. Then, a correlation between the ratio (C-assimilated/number of fruits) 

and the simulated growth  of individual fruits belonging  to the same neighborhood was calculated 

for each radius and friction parameter value. Significance of the correlations was then adjusted for 

11 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

multiple comparisons with the Bonferroni correction (i.e. dividing the significance level of the test, 

p-value = 0.05, by the number of correlations for which significance was tested: eleven distances). 

Biological  relevance  was  also  tested  by  comparing  the  simulated  growth  on  the  Fuji  tree 

structure  and  harvested  fruit  size  distribution  on  field  trees  of  the  same  age  (four  years  old)  and 

cultivar. Based on the assumption that fruit weight obtained in early growth stages is correlated to 

the  fruit  weight  at  harvest  (Stanley  et  al.  2000),  we  compared  the  distributions  of  the  normalized 

values  of  the  carbon  allocated  in  our  simulations  with  fruit  weight  measured  at  harvest  (Costes, 

unpublished data). Similarity among distributions was also assessed in terms of Root Mean Squared 

Error  (RMSE)  between  distribution  counts.  Based  on  these  results,  a  narrower  range  of  friction 

parameter values was identified as more biologically relevant and used in further analysis. 

The coherence of simulations across scales was tested by correlating the fruit growth obtained at 

each coarse scale with the one at M scale, used as a reference. Results obtained for equal friction 

parameter and same tree structure were considered together. For each coarse scale component, the 

average of the fruit growth obtained at M scale within the boundaries of the coarse scale component 

was  computed.  As  such,  a  one-to-one  comparison  was  possible  between  mean  growth  at  M  and 

other  (coarser)  scales.  Deviations  between  M  and  the  other  scales  were  assessed  visually  on 

correlation plots, and by means of the coefficient of variation of the root mean squared error (CV 

RMSE). 

The  effect  of  using  different  topological  scales  on  the  number  of  plant  components  and  on 

simulation time was also analyzed. All simulations were run on a computer equipped with an Intel 

i7-6700HQ 2.59 Ghz CPU, 8Gb RAM; OS: Windows 10 Home, 64bit. 

22 

RESULTS 

23 
24 

25 

26 

27 

28 

29 

30 

31 

32 

Testing physiological assumptions 

Relative growth rate (RGR) of shoots in the Fuji tree structure at M scale increased with the 

values of the friction parameter while, for fruits and old wood, it increased for h values from 0.25 to 

respectively 4 and 2, and then decreased until a value of 16 (Table 3). In other terms, the higher the 

values of the friction parameter the higher was the growth occurring close to the C-source. RGRs of 

old wood and shoots were comprised between normal growth observed in the field and maximum 
potential growth data used for calibration of sink demands (between 5.3*10-3 and 3.1 *10-2 mg/g for 

the  old  wood,  between  0.4  and  1.2  mg/g  for  shoots;  Reyes  et  al.  2016).  Conversely,  fruit  growth 

was  between  35%  and  51%  lower  in  respect  to  the  fruit  growth  observed  in  the  normal  field  

conditions (1.9 and 2.8 mg/g for fruits). 

12 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 
19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

34 

Simulation results at M scale show the impact of the friction parameter (h) in determining 

the  area  around  an  individual  fruit  within  which  this  competes  for  C-assimilates  with  other  fruits 

(Fig.4A, B). As shown by the significant correlations among fruit growth and comfort index (ratio 

between  C-assimilated  and  number  of  fruits),  the  neighborhood  within  which  fruit  growth  is 

affected by competition for C is relatively large (>0.9 m) for small values of the friction parameter 

(0.5 - 4). This means that the within-tree variability in fruit growth is mostly related to C-sources 

located  far  from  it.  In  other  terms,  a  large  part  of  the  tree  structure  affects  the  growth  of  each 

individual  fruit.  Conversely,  for  high  friction  parameter  values  (8,  16),  fruit  growth  is  affected 

mainly  by  the  C  provided  by  close  leaves  and  possibly  the  competition  with  neighboring  fruits 

(neighborhood < 0.9 m) (Fig.4B). 

The normalized fruit dry weight simulated on the four-year  old  Fuji tree was compared to 

that  of  fruits  measured  at  harvest  in  a  two  similar  trees,  in  order  to  evaluate  what  range  of  the 

friction  parameter  best  fit  the  observed  fruit  size  distribution  (Fig.4C).  The  lowest  RMSE  values 

were obtained with h parameter values between 4 and 16. High values, however, produced skewed 

distributions with variability larger than the one obtained in the field (h = 16). Conversely, for low h 

values (0.5, 1) distributions had a consistently lower variability than in the field. Similar variability 

and low RMSE values were obtained with the friction parameter values of four and eight. 

C-allocation at multiple scales 

Changing the scale of representation of the tree from M to coarser scales sharply decreased 

the number of represented topological components of the tree structures. Trees at GU, TBS, BR1 

and FU scales contained respectively about 12.7%, 8.6%, 1.6%, and 1.2% the elements they had at 

M scale (Table 4). 

Changing topological scale had also a significant impact on fruit growth. In order to ease the 

interpretation,  and  based  on  the  above  fitted  values,  only  results  for  the  best  friction  parameter 

values  (2  <=  h  <=  8)  are  presented.  Fruit  growth  at  GU  and  TBS  scales  was  more  correlated  to 

results  at  M  scale  than  at  coarser  scales  (BR1,  FU)  (Fig.5).  Generally,  in  simulations  at  coarse 

scales, fruit growth predictions was lower in respect to the M scale. For instance, when running the 

simulations at FU scale, differences in mean fruit dry weight compared to those obtained at M scale 

(used in the PEACH model, Allen et al. 2005) went up to 60% in terms of coefficient of variation of 

the RMSE (Fig.6B). 

As  expected,  multiple  fruits  belonging  to  the  same  coarse  scale  component  had  the  same 

growth (size of spheres on Fig.3). This was due to the facts that that all fruits at the beginning of the 

simulation  had  identical  weight  and  that  the  carbon  allocated  to  a  coarse  scale  component  is 

proportionally  divided  according  to  individual  metamer  carbon  demand.  As  a  consequence,  the 
13 

 
1 

2 

3 

4 

5 

6 

7 
8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

higher the resolution in representing the plant structure (Metamer > Growth Unit > TBS > 1st order 

Branching ≈ Fruiting Unit), the higher number of different fruit growth achieved (Fig.5). Globally, 

the  lower  the  friction  parameter  the  lower  the  range  of  fruit  growth  variability,  in  all  the  tree 

structures and at all topological scales (Fig.4C, Fig.5D). The corollary of these observations is high 

values of the friction parameters result in a relatively wide range of fruit growth at all scales, but 

with lower within-tree variability when moving from a M to a coarse scale. 

Simplification of the tree structures and computation efficiency 

Computation  time  was  found  as  a  third  order  polynomial  function  of  the  number  of 

components  in  the  plant  (Supplementary  Information  -  Fig.1).  The  reduction  in  the  number  of 

represented  plant  components,  obtained  by  changing  scale  from  M  to  FU  (down  to  0.8%)  in  the 

presented  simulations,  resulted  in  a  gain  in  computation  time  of  up  to  four  orders  of  magnitude 

(down to 0.2%) (Table 4). 

The  reduction  in  computation  time  associated  with  the  use  of  coarser  scales  (Table  4) 

corresponded  to  an  increased  discrepancy  (in  terms  of  the  Coefficient  of  Variation  of  the  Root 

Mean Squared Error: CV RMSE) in the results obtained between M and other scales (Fig.6B). Error 

varied from values next to zero at low friction parameters at GU scale, to values up to sixty percent 

for  higher  frictions  and BR1  or  GU  scales,  and  was  generally  higher  for  higher  fiction  parameter 

values. There were however minor exceptions to this general behavior, with low friction parameter 

values  occasionally  providing  slightly  higher  discrepancies  than  higher  values    (e.g.  for  h  =  4  at 

BR1 scale in the Ap-05 and Ap-10 tree structure, in respect to h = 8). 

21 

DISCUSSION 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

Multi-scale coherence, impact on predictions and computation time 

To  our  knowledge,  MuSCA  is  the  first  C-allocation  model  that  allows  simulating  C-

allocation  at  multiple  topological  scales  within  a  plant  representation.  Simulation  results  revealed 

that the model was able to produce results which are highly correlated with the M scale, especially 

when running at GU scale (Fig.5). As a rule of thumb, the deviation between predictions obtained at 

M and other scales increased when up-scaling and for increasing friction parameter values (Fig.5, 

Fig.6). 

Differences in C allocated to fruits at M and other scales are due to two factors. Firstly, after 

allocation,  the  C  received  by  the  different  plant  parts  belonging  to  a  component  is  no  longer 

influenced  by  their  individual  positions.  As  such,  the  model  represents  the  effects  of  distances 

among the components at the coarse scale selected for the simulation, but not among its constituting 

14 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

elements at the finer scale. Second, while the top and basal coordinates of a coarse scale component 

are  inherited  from  the  finer  scale  components  present  at  its  extremities,  the  coordinates  of  its 

barycentre  are  not.  Indeed  these  are  computed  as  the  mean  of  the  coordinates  of  its  components, 

weighted  by  their  individual  lengths.  When  distances  and  C-flows  are  calculated,  this  generates 

deviations in respect to the M scale 

The deviations between M and other scales were also affected by the specific plant structure 

(Fig.5).  This  is  likely  related  to  the  non-linearity  of  the  simulated  process  and  its  relation  to  the 

different discretization of the plant. In trees, the different contribution in respect to the available C 

of annual organs (leaves and fruits) and the presence of the moderate C-sink of woody organs may 

create contrasting patches in terms of C-supplies and C-sinks (Fig.4). When the tree is discretized at 

different scales, the distances between patches of sources and sinks and their constituting elements 

are modified. By changing discretization, the set of distances to which the non-linear function (eq. 

1) is applied to compute C flows also changes, implying sharp differences in C-allocation. Changes 

are thus related to the geometry of the tree structure as well as to the specific friction parameter, as 

they  determine  the  spatial  domain  and  the  impact  of  the  C-allocation  rule.  In  this  regard,  further 

research would be required to explore the impact of commonly applied equations for C-allocation 

(e.g.  eq.  1,  equations  in  Balandier  et  al.  2000;  Lescourret  et  al.  2011)  on  tree  architectures 

contrasting in terms of distributions of sinks and supplies in relation to their discretization. 

Changing  topological  scale  also  had  a  strong  impact  on  the  computation  time.  This  is  an 

important  limiting  factor  for  the  simulation  of  carbon  allocation  in  complex  tree  structures,  and 

consequently simulations of tree growth at high spatial detail tends to be limited to relatively young 

plants  (Balandier  et  al.  2000;  Pallas  et  al.  2016).  Computation  time  in  MuSCA  closely 

approximates  a  third  order  polynomial  function  of  the  number  of  represented  plant  components 

(Supplementary  Information  -  Fig.1),  suggesting  the  need  to  reduce  plant  complexity  to  simulate 

plant growth with this type of source-sink model. In this study, the GU scale was able to reproduce 

values and fruit growth distributions almost identical to M, while saving computation time (Fig.5, 

Fig.6). It is possible that the optimal scale of representation may be influenced by tree size. Because 

of the exponential increase in tree topological complexity with tree age, relatively small variations 

in C-dynamics in early growth stages may have important consequences for the development of the 

tree structure at later stages. We propose the hypothesis that intermediate scales comprised between 

M  and  GU  may  further  decrease  the  deviations  in  respect  to  M  scale.  We  further  suggest  that  a 

mixed use of high and relatively low topological resolutions, respectively for young and older trees, 

may optimize prediction accuracy while still allowing for simulations on mature trees. 

15 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 
24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

34 

Testing physiological assumptions 

The formalization used in MuSCA to calculate C-allocation (eq. 1a) (Balandier et al. 2000) 

represented the impact of C-availability and competition among sinks, such as the fruits (Fig.4) on 

fruit growth variability. 

RGRs at compartment level was lower range of field observations. This is due to the choice 

for  simulations  of  a  partly  cloudy  day,  in  which  C-assimilation  could  limit  growth,  resulting  in 

enhanced competition for C (whereas simulations in very sunny days resulted in higher growth and 

reduced fruit growth variability, data not shown). 

In MuSCA, the considered friction parameter (h, eq. 1) is empirical and does not correspond 

to a clear biological process. As in previous studies, this parameter has been estimated by trial and 

error  (Balandier  et  al.  2000).  Nonetheless,  the  comparison  between  the  simulated  and  harvested 

normalized  fruit  growth  distribution  suggests  that  h  values  should  be  between  four  and  eight 

(Fig.4C).  This  suggests  that  neither  a  common  assimilate  pool  (Heuvelink  1995)  of  carbon  nor  a 

shoot  or  branch  autonomy  (Sprugel  et  al.  1991)  was  adequate  for  accounting  for  assimilate 

partitioning within a fruit tree as observed in previous experimental studies (Walcroft  et al. 2004; 

Volpe et al. 2008). Moreover, fluxes from parts of trees with high carbon supply to parts with a low 

one have already been used for modeling the within-tree variation in fruit size in peach and apple 

trees  (Lescourret  et  al.  2011;  Pallas  et  al.,  2016).  Nevertheless,  it  has  also  been  observed  that the 

level  of  shoot  or  branch  autonomy  can  vary  depending  on  the  phenological  date  with  a  higher 

branch  autonomy  during  summer  period  compared  to  winter  (Lacointe  et  al.  2004).  Further 

simulations  and  analyses  with  MuSCA  performed  by  dynamically  tuning  the  friction  parameter 

values could help testing such behaviors. 

Advantages of flexible C-allocation at multiple-scales 

By making a dynamic use of MTG (Godin and Caraglio 1998) the presented model allows 

us  modifying  the  type  of  “individual  entities”  considered  in  source-sink  exchanges  within  a  plant 

structure  on  the  fly.  This  is  also  made  possible by  formalisms  which  are  equally  applicable  at  all 

scales  (Fig.2,  eq.  2,  3)  and  inherit,  from  fine  to  coarse  scales,  the  spatial  (coordinates  of  scale 

boundaries) and extensive (C-demands and supplies, Up- and down- scaling) properties necessary 

for the calculation of C-flows. 

The flexibility related to the multi-scale features of the model provides several opportunities. 

While  the  topological  scale  typically  represented  in  a  plant  models  mirrors  the  interests  of  a 

particular group of model users, changing the scale of representation makes the model of practical 

interest  for  multiple  objectives.  As  showed  in  this  study,  the  model  can  be  used  to  assess  the 

implications of using specific scales. From our results, in most cases and for trees of this size, the 
16 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

32 

33 

GU scale would be a robust alternative to M, while allowing much faster simulations. Comparisons 

of  results  among  C-allocation  models could  be  facilitated by  adapting  the  scale  of  representation. 

For  instance,  the  individual  fruit  growth  simulated  at  the  FU  scale  can  be  compared  with  results 

obtained by QualiTree (Lescourret et al. 2011). 

In this study, MuSCA was applied on MTGs issued from the MAppleT architectural model 

(Costes  et  al.  2008).  However,  MTGs  coming  from  other  sources,  such  as  the  several  models 

present  in  the  OpenAlea  environment,  could  also  be  used,  given  their  compliance  with  certain 

prerequisites. Also, the detail in the description of the plant could be less detailed since, technically, 

a representation at metamer resolution is not strictly necessary. Indeed, in order to run MuSCA, the 

plant description should simply allow for the identification of the organ types (via the presence of 

leaves  and  fruits),  their  geometrical  sizes  (length  and  radiuses)  and  their  topological  connections 

(succession, branching). This makes the model applicable on tree structures acquired in the field by 

methods such as the Terrestrial Laser Scanner (TLS), followed by topological reconstruction of the 

plant (Raumonen et al. 2013; Boudon et al. 2014; Reyes 2016). In addition, field data collected at 

various  topological  scales  might  still  be  suitable  for  model  testing.  Indeed,  by  using  the  up-  and 

down-scaling, results simulated at any spatial scale can be brought to the scale at which the data for 

validation are available. 

Model limitations and further developments 

MuSCA  still  neglects  to  represent  some  important  physiological  implication  of  the 

distribution of sinks along the plant topology. In particular, the influence of individual sinks present 

in the path between sources and sinks on the C-flow is not fully described, as in models based on an 

electric analogy and the L-system formalisms (Allen et al. 2005; Cieslak et al. 2011). Indeed, two 

identical  C-sinks  (D1,  D2)  present  at  the  same  distance  from  a  source  (S)  will  receive  form  this 

source an identical amount of C, no matter if along the path between S and D1 there are stronger or 

more abundant C-sinks than along the path between S and D2. Nevertheless, simple models as our 

have  the  advantage  to  require  the  calibration  of  one  parameter  only  compared  to  these  previous 

approaches. 

It is important to remember that like other carbon allocation models applicable to large plant 

structures, MuSCA makes use of an empirical parameter (the friction parameter). In this study we 

identified  a  range  of  possibly  sound  parameter  values,  but  more  appropriate  ones  could  be 

experimentally  estimated  from  measurements  of  the  sap  flow  through  marked  isotopic  carbon 

(Hansen 1967), as well as measurements of fruit growth in simple tree structures with modified fruit 

loads. 

17 

 
1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

24 

25 

26 

27 

28 

29 

30 

31 

The MuSCA model could be further refined by using the MTG properties to increase the 

computational efficiency without losing prediction accuracy. For instance, when running at coarse 

scale, the direction of origin of C-assimilates might be used to account for distance also within the 

boundaries of the coarse scale component. 

The  creation  of  new  metamers  should  be  included  in  order  to  allow  for  the  simulation  of 

plant growth during elongation and growth periods (on not-fixed structures). In addition, given the 

influence  of  pruning  on  the  distribution  and  emergence  of  carbon  sinks,  the  implementation  of  a 

module  describing  reactions  to  this  management  practice  (e.g.  DeJong  et  al.  2012)  would 

significantly extend the applicability of the model to a broader range of real cases. Further, a more 

detailed  description  of  the  root  would  be  the  starting  point  to  investigate  water  and  nutrient 

limitations at the soil interface. 

Regarding the use of MuSCA in the larger context, its generality can ease its adaptation to 

different species. In addition, the modular implementation of MuSCA in the OpenAlea environment 

facilitates  the  integration  with  other,  previously  developed,  models,  as  it  was  the  case  for  the 

connection  with  the  MAppleT  (Costes  et  al.  2008)  and  the  RATP  models  (Da  Silva,  Han,  and 

Costes 2014). 

CONCLUSIONS 

In this study we presented MuSCA, to our knowledge the first C-allocation model allowing 

to simulate C-allocation at multiple topological scales of representation of the plant. The presented 

model provides topologically-based methods to re-interpret/simplify the topological scale at which 

the  process  of  carbon  allocation  is  simulated.  The  simulations  revealed  a  major  impact  of  the 

topological scale, used to discretize C-sources and sinks, on the predicted C-allocation, even when 

other C-allocation rules (equation for C-allocation and friction parameter) were kept constant. The 

model can be used to identify which degree of simplification is acceptable for the representation of 

plant structures without compromising the accuracy in the computation of carbon allocation. It can 

be used on large plants, being aware of the trades-off in terms of computation time and prediction 

accuracy. In addition, the flexible representation of the plant topology facilitates matching the needs 

of different users, while using the same model. For instance, a relatively coarse scale (e.g. branch) 

could  be  more  suited  for  a  farmer  interested  in  fruit  thinning,  than  a  fine  one  (e.g.  metamer)  that 

could be the target of a modeler interested in investigating the local drivers of individual fruit size 

variability. 

18 

 
1 
2 

3 

4 

5 

6 

7 

8 
9 

ACKNOWLEDGEMENTS 

We  acknowledge  Jerome  Ngao  and  Marc  Saudreau  from  UMR  PIAF,  INRA  at  Clermont-

Ferrand respectively for their help in linking RATP to MAppleT and in linking MTG and RATP, in 

the  OpenAlea  platform.  F.  Boudon  from  UMR  AGAP,  Cirad  at  Montpellier,  for  some  tips  on 

Python  coding.  The  authors  thank  also  Roberto  Zampedri  and  Mr  Mauro  Cavagna  for  field 

assistance,  Maddalena  Campi  for  useful  discussions,  and  Gareth  Linsmith  for  supervision  on  the 

English language and kinship. 

FUNDING INFORMATION 

This  work  was  financed  by  the  FIRST  FEM  doctoral  school,  which  is  funded  by  the 

10 

Autonomous Province of Trento, Italy. 

11 

12 
13 
14 

15 
16 
17 

18 
19 

20 
21 

22 
23 
24 
25 

26 
27 

28 
29 

30 
31 

32 
33 
34 

LITERATURE CITED 

Allen MT, Prusinkiewicz P, DeJong TM. 2005. Using L-systems for modeling source-sink 
interactions, architecture and physiology of growing trees: the L-PEACH model. New Phytologist 
166: 869–880. 

Balandier P, Lacointe A, Le Roux X, Sinoquet H, Cruiziat P, Le Dizès S. 2000. SIMWAL: a 
structural-functional model simulating single walnut tree growth in response to climate and pruning. 
Annals of Forest Science 57: 571–585. 

Balduzzi M, Binder BM, Bucksch A, et al. 2017. Reshaping plant biology: qualitative and 
quantitative descriptors for plant morphology. Frontiers in Plant Science 8. 

Bancal P. 2002. Source-sink partitioning. Do we need Munch? Journal of Experimental Botany 53: 
1919–1928. 

Barillot R, Chambon C, Fournier C, Combes D, Pradal C, Andrieu B. 2018. Investigation of 
complex canopies with a functional–structural plant model as exemplified by leaf inclination effect 
on the functioning of pure and mixed stands of wheat during grain filling. Annals of Botany 123: 
727–742. 

Barthélémy D. 1991. Levels of organization and repetition phenomena in seed plants. Acta 
Biotheoretica 39: 309–323. 

Barthélémy D, Caraglio Y. 2007. Plant architecture: a dynamic, multilevel and comprehensive 
approach to plant form, structure and ontogeny. Annals of Botany 99: 375–407. 

Boudon F, Preuksakarn C, Ferraro P, et al. 2014. Quantitative assessment of automatic 
reconstructions of branching systems obtained from laser scanning. Annals of Botany 114: 853–862. 

Cieslak M, Seleznyova AN, Hanan J. 2011. A functional–structural kiwifruit vine model 
integrating architecture, carbon dynamics and effects of the environment. Annals of Botany 107: 
747–764. 

19 

 
1 
2 

3 
4 
5 

6 
7 

8 
9 
10 

11 
12 

13 
14 

15 
16 
17 
18 
19 

20 
21 

22 
23 
24 

25 
26 
27 

28 
29 

30 
31 

32 
33 
34 

35 
36 

37 
38 

Costes E, Sinoquet H, Kelner JJ, Godin C. 2003. Exploring within‐tree architectural development 
of two apple tree cultivars over 6 years. Annals of Botany 91: 91–104. 

Costes E, Smith C, Renton M, Guédon Y, Prusinkiewicz P, Godin C. 2008. MAppleT: 
simulation of apple tree development using mixed stochastic and biomechanical models. Functional 
Plant Biology 35: 936. 

Da Silva D, Han L, Costes E. 2014. Light interception efficiency of apple trees: A multiscale 
computational study based on MAppleT. Ecological Modelling 290: 45–53. 

Da Silva D, Han L, Faivre R, Costes E. 2014. Influence of the variation of geometrical and 
topological traits on light interception efficiency of apple trees: sensitivity analysis and 
metamodelling for ideotype definition. Annals of Botany 114: 739–752. 

Davidson RL. 1969. Effect of root/leaf temperature differentials on root/shoot ratios in some 
pasture grasses and clover. Annals of Botany 33: 561–569. 

De Schepper V, De Swaef T, Bauweraerts I, Steppe K. 2013. Phloem transport: a review of 
mechanisms and controls. Journal of Experimental Botany 64: 4839–4850. 

De Swaef T, Driever SM, Van Meulebroek L, Vanhaecke L, Marcelis LFM, Steppe K. 2013. 
Understanding the effect of carbon status on stem diameter variations. Annals of Botany 111: 31-46 

DeJong TM, Negron C, Favreau R, et al. 2012. Using concepts of shoot growth and architecture 
to understand and predict responses of peach trees to pruning. Acta Horticulturae: 225–232. 

Fournier C, Pradal C, Louarn G, et al. 2010. Building modular FSPM under OpenAlea: concepts 
and applications In: Davis, CA, United States, 109–112. 

Garin G, Fournier C, Andrieu B, Houlès V, Robert C, Pradal C. 2014. A modelling framework 
to simulate foliar fungal epidemics using functional–structural plant models. Annals of Botany 114: 
795–812. 

Garin G, Pradal C, Fournier C, Claessen D, Houlès V, Robert C. 2018. Modelling interaction 
dynamics between two foliar pathogens in wheat: a multi-scale approach. Annals of Botany 121: 
927–940. 

Génard M, Dauzat J, Franck N, et al. 2008. Carbon allocation in fruit trees: from theory to 
modelling. Trees 22: 269–282. 

Godin C, Caraglio Y. 1998. A multiscale model of plant topological structures. Journal of 
Theoretical Biology 191: 1–46. 

Grechi I, Vivin Ph, Hilbert G, Milin S, Robert T, Gaudillère J-P. 2007. Effect of light and 
nitrogen supply on internal C:N balance and control of root-to-shoot biomass allocation in 
grapevine. Environmental and Experimental Botany 59: 139–149. 

Grossman YL, DeJong TM. 1994. PEACH: a simulation model of reproductive and vegetative 
growth in peach trees. Tree Physiology 14: 329–345. 

Grossman YL, DeJong TM. 1995. Maximum fruit growth potential and seasonal patterns of 
resource dynamics during peach growth. Annals of Botany 75: 553–560. 

20 

 
 
1 
2 

3 
4 

5 
6 

7 
8 

9 
10 

11 
12 

13 
14 
15 

16 
17 

18 
19 

20 
21 

22 
23 

24 
25 
26 

27 
28 

29 
30 
31 

Guo Y, Ma Y, Zhan Z, et al. 2006. Parameter optimization and field validation of the functional–
structural model GREENLAB for maize. Annals of Botany 97: 217–230. 

Hansen P. 1967. 14C-Studies on Apple Trees. II. Distribution of Photosynthates from Top and 
Base Leaves from Extension Shoots. Physiologia Plantarum 20: 720–725. 

Heuvelink E. 1995. Dry matter partitioning in a tomato plant: one common assimilate pool? 
Journal of Experimental Botany 46: 1025–1033. 

Hunt R. 1982. Plant growth curves: the functional approach to plant growth analysis. London: 
Edward Arnold. 

Kang M, Evers JB, Vos J, de Reffye P. 2008. The derivation of sink functions of wheat organs 
using the GREENLAB model. Annals of Botany 101: 1099–1108. 

Lacointe A. 2000. Carbon allocation among tree organs: a review of basic processes and 
representation in functional-structural tree models. Annals of Forest Science 57: 521–533. 

Lacointe A, Deleens E, Ameglio T, et al. 2004. Testing the branch autonomy theory: a 13C/14C 
double-labelling experiment on differentially shaded branches. Plant, Cell and Environment 27: 
1159–1168. 

Lakso AN, Johnson RS. 1990. A simpified dry matter production model for apple using automatic 
programming simulation software In: Acta Horticulturae.141–148. 

Le Roux X, Lacointe A, Escobar-Gutiérrez A, Le Dizès S. 2001. Carbon-based models of 
individual tree growth: a critical appraisal. Annals of Forest Science 58: 469–506. 

Lescourret F, Moitrier N, Valsesia P, Génard M. 2011. QualiTree, a virtual fruit tree to study the 
management of fruit quality. I. Model development. Trees 25: 519–530. 

Lobet G, Pound MP, Diener J, et al. 2015. Root system markup language: toward a unified root 
architecture description language. Plant Physiology 167: 617–627. 

Luquet D, Dingkuhn M, Kim H, Tambour L, Clement-Vidal A. 2006. EcoMeristem, a model of 
morphogenesis and competition among sinks in rice. 1. Concept, validation and sensitivity analysis. 
Functional Plant Biology 33: 309–323. 

Marcelis LFM. 1996. Sink strength as a determinant of dry matter partitioning in the whole plant. 
Journal of Experimental Botany 47: 1281–1291. 

Massonnet C, Regnard JL, Costes E, Sinoquet H, Ameglio T. 2006. Parametrization of the 
functional-structural model for apple trees. Application to simulate photosynthesis and transpiration 
of fruiting branches In: Acta Horticulturae. Denmark: ISHS, . 

32 

Münch E. 1930. Die Stoffbewegunen in der Pflanze. Jena. 

33 
34 

35 
36 
37 

Ndour A, Vadez V, Pradal C, Lucas M. 2017. Virtual plants need water too: functional-structural 
root system models in the context of drought tolerance breeding. Frontiers in Plant Science 8. 

Pallas B, Da Silva D, Valsesia P, et al. 2016. Simulation of carbon allocation and organ growth 
variability in apple tree by connecting architectural and source–sink models. Annals of Botany 118: 
317–330. 

21 

 
1 
2 

3 
4 
5 

6 
7 

8 
9 

10 
11 

12 
13 

14 
15 
16 

Pradal C, Boudon F, Nouguier C, Chopard J, Godin C. 2009. PlantGL: a Python-based 
geometric library for 3D plant modelling at different scales. Graphical models 71: 1–21. 

Pradal C, Dufour-Kowalski S, Boudon F, Fournier C, Godin C. 2008. OpenAlea: a visual 
programming and component-based software platform for plant modelling. Functional Plant 
Biology 35: 751. 

Pradal C, Fournier C, Valduriez P, Cohen-Boulakia S. 2015. OpenAlea: scientific workflows 
combining data analysis and simulation. ACM SSDBM 15: 11–17. 

Raumonen P, Kaasalainen M, Åkerblom M, et al. 2013. Fast automatic precision tree models 
from terrestrial laser scanner data. Remote Sensing 5: 491–520. 

Reyes F. 2016. Carbon allocation of the apple tree: from field experiment to computer modelling. 
PhD Thesis, University of Bolzano, Italy. 

Reyes F, DeJong T, Franceschi P, Tagliavini M, Gianelle D. 2016. Maximum growth potential 
and periods of resource limitation in apple tree. Frontiers in Plant Science 7. 

Robert C, Garin G, Abichou M, Houlès V, Pradal C, Fournier C. 2018. Plant architecture and 
foliar senescence impact the race between wheat growth and Zymoseptoria tritici epidemics. Annals 
of Botany 121: 975–989. 

17 

Ryan MG, Asao S. 2014. Phloem transport in trees. Tree Physiology 34: 1–4. 

18 
19 
20 

21 
22 

23 
24 
25 

Sinoquet H, Le Roux X, Adam B, Ameglio T, Daudet FA. 2001. RATP: a model for simulating 
the spatial distribution of radiation absorption, transpiration and photosynthesis within canopies: 
application to an isolated tree crown. Plant, Cell and Environment 24: 395–406. 

Sprugel DG, Hinckley TM, Schaap W. 1991. The theory and practice of branch autonomy. 
Annual Review of Ecology and Systematics 22: 309–334. 

Stanley CJ, Tustin DS, Lupton GB, Mcartney S, Cashmore WM, Silva HND. 2000. Towards 
understanding the role of temperature in apple fruit growth responses in three geographical regions 
within New Zealand. The Journal of Horticultural Science and Biotechnology 75: 413–422. 

26 

Thornley JHM, Johnson IR. 1990. Plant and crop modelling. NY: The Blackburn Press. 

27 
28 
29 

30 
31 

32 
33 
34 

35 
36 
37 

Thorpe M, Minchin P, Gould N, McQueen J. 2005. 10 - The stem apoplast: a potential 
communication channel in plant growth regulation In: Zwieniecki MA, ed. Physiological Ecology. 
Vascular Transport in Plants. Burlington: Academic Press, 201–220. 

Volpe G, Lo Bianco R, Rieger M. 2008. Carbon autonomy of peach shoots determined by 13C-
photoassimilate transport. Tree Physiology 28: 1805–1812. 

Vos J, Evers JB, Buck-Sorlin GH, Andrieu B, Chelle M, de Visser PHB. 2010. Functional–
structural plant modelling: a new versatile tool in crop science. Journal of Experimental Botany 61: 
2101–2115. 

Walcroft AS, Lescourret F, Genard M, Sinoquet H, Le Roux X, Dones N. 2004. Does 
variability in shoot carbon assimilation within the tree crown explain variability in peach fruit 
growth? Tree Physiology 24: 313–322. 

22 

 
1 
2 
3 
4 
5 
6 
7 
8 
9 
10 
11 
12 
13 
14 

15 
16 
17 
18 
19 
20 
21 
22 
23 
24 
25 
26 
27 
28 

29 
30 
31 
32 
33 
34 

35 
36 
37 
38 
39 
40 
41 
42 
43 

44 
45 
46 
47 
48 
49 

Fig.1: Conceptual workflow of the model: (A) General framework for the application of the model; (B) the 
core of MuSCA. (A): A multi-scale tree graph representing a plant structure at a given developmental stage 
is provided. This is used, together with the Growing Degree Days (GDD), allometric relationships and plant 
geometric information to compute initial volumes and biomasses of plant components at metamer (M) scale. 
Carbon demands are estimated at metamer scale by making use of species specific seasonal sink activities, 
biomasses and GDD at the current time step. The position of individual leaves on the plant structure is used 
by the radiative model RATP to compute light interception and, together with meteorological conditions, the 
individual leaf photosynthesis. (B): The workflow follows different paths depending on the selected scale:  
M scale (solid lines) and coarser scales (dashed lines). The scale at which the plant is represented determines 
up- and down-scaling processes. In case a coarse scale is chosen, carbon demands and supplies are up-scaled. 
Carbon allocation is then computed among the plant components at the chosen scale. After allocation, if the 
selected scale was a coarse one, the carbon allocated to each component is divided among its constituent 
elements. Biomass of individual elements is eventually updated prior to moving to the next time-step. MTG: 
Multi-scale Tree Graph. In italics are the steps containing species specific parameters. 

Fig.2:  Workflow  and  graphical  representation  of  the  calculation  of  distances.  (A)  Workflow  for  the 
calculation  of  the  distance  between  two  vertices  i,  j:  top  coordinates  of  vertices  are  used  to  compute 
coordinates  of  basis  and  barycenters  for  the  whole  topology.  Given  two  vertices  i,  j,  their  distance  is 
calculated in three steps: the Greatest Common Ancestor (GCA) of i, j is identified; an iterative process sums 
the  length  of  the  vertices  connecting  GCA  to  i  and  j;  the  semi-lengths  of  i  and  j  are  also  summed.  (B) 
Graphical representation of the: calculation of coordinates of basis and barycenters at (above) metamer (M) 
scale. The base of a vertex corresponds to the top of its parent; coordinates of the barycentre of a vertex are 
calculated from the ones of its top and base. (Middle) the base of a coarse scale vertex (capital I) corresponds 
to  the  base  of  its  first  component  (lowercase  i),  which  is  inherited  from  the  top  of  its  parent  at  M  scale 
(lowercase  i-1);  coordinates  of  the  barycenter  of  a  coarse  scale  vertex  are  obtained  as  the  mean  ofthe  
coordinates of its own components at M scale, weighted by their lengths. (Below) calculation of the semi-
length of a vertex, identification of GCA and computation of distances along a path connecting two vertices 
i,  j.  Data  used  as  input  of  calculations  are  indicated  by  red  rhombi  and  are  connected  by  arrow  to  the 
respective output represented by green crosses. 

Fig.3:  Simulation  of  carbon  allocation  and  fruit  growth  on  a  tree  structure  represented  at  different  spatial 
scales during one day. Upper panels: tree parts represented with the same color belong to the same scale, i.e. 
trees  with  an  higher  number  of  colors  are  made  of  a  higher  number  of  components.  The  number  of 
components at each scale is indicated in the corresponding low left corner. Lower panels: the volume of the 
represented  spheres  is  proportional  to  the  normalized  increment  in  fruit  dry  weight  within  the  tree. 
Simulations were run with a friction parameter equal to eight. 

Fig.4: Physiological responses in simulations at M scale, in respect to different tree structures and friction 
parameters (h). A: Three dimensional representation of the tree structures with fruit growth (obtained with h 
parameter equal to 8). B: correlation between individual fruit growth and the ratio between carbon 
assimilated and number of fruits evaluated in neighborhoods of increasing radiuses. C: Distributions of the 
normalized simulated fruit growth (red, coloured bars) superposed with the normalized fruit dry weight 
measured at harvest (black, empty bars), in the 4 years old simulated and observed Fuji trees for different 
friction parameters. The Root Mean Squared Error (RMSE) between distribution counts for different friction 
parameters is provided. The upper parts of the histograms for h < 2 are cut off in order to allow better 
visualization of results on the vertical axis. 

Fig.5:  Mean  daily  fruit  dry  weight  increment  and  its  distribution  (in  Fuji  apple  cultivar)  depending  on  the  
topological scales (from left to right), tree structure (from top to bottom) and friction parameters h (symbols). 
Correlation  between  carbon  allocated  to  fruits  per  day  at  the  selected  coarse  scale  (y  axes)  vs  carbon 
allocated  to  fruits  per  day  at  M  scale  and  averaged  for  all  metamers  belonging  to  a  same  component  at 
coarser scale (x axis) in A: Fuji, B: Ap-05, C: Ap-10. D: Fruit growth distribution in the Fuji tree structure 
(dashed for h=2, dotted for h=4, solid for h=8). 

23 

 
Fig.6: Trade-off between computation time and prediction error. The logarithm of the computation time and 
the Coefficient of Variation of the Root Mean Squared Error (CV RMSE) between fruit growth at different 
topological scales in respect to the M scale, on three tree structures and for different friction parameters (h). 
A: Fuji, B: AP-05, C: AP-10. 

Supplementary Information - Fig.1: Computation time in respect to the number of represented structure 
components. 

1 
2 
3 
4 

5 
6 

7 

24 

 
 
1 

2 
3 
4 
5 

6 
7 
8 
9 

Description 

Table 1: Model parameters and equation for estimation of biomasses. 
Parameter 
dry_mass_to_C_mass  Ratio to convert carbon assimilated into biomass uptake  2.105263158 
wood_density 
spec_leaf_surface 
dry_to_fresh_DWratio  Ratio to convert apple fruit fresh to dry weight 
shoot_to_root_growth  Vegetative shoot to root biomass ratio 

Old wood density 
Per unit surface leaf dry mass 

- 
700  Kg/m3 
0.08  Kg/m2 
- 
0.15 
- 
4.5 

Value/range  Unit 

Generalized linear model to estimate shoot biomass (g) from length (cm) and termal time (°C) 
Dry weight = exp ( a + b * log( length ) + c * GDD + d * length + e * log ( length * GDD) ) 

a 
b 
c 
d 
e 

-3.073409537 
0.706724497 
5.78E-05 
0.020013707 
9.81E-05 

Table 2: Model parameters and equations for the estimation of carbon demand for dry matter 
increase 
Parameter 
trunk_activity 

Value/range  Unit 

0.000031  g * g^-1 * C^-1 

Description 
Sink activity for old wood 
Range of values for leaf activity (from Look Up 
Table) 

 0 to 1.9*10^-3  g * g^-1 * C^-1 

leaf_activity 

Gompertz equation for fruits and shoots 
Dry weight = a * exp(b * exp(c * GDD) 

Normalized derivative 
Relative Growth Rate = 
(a * b * c * exp(b * (exp(c * GDD)) + c * GDD))/ (a * exp(b * exp(c * GDD)) 

Parameters 
A 
B 
C 
GDD: Growing degree days after bloom, after cutoff of base temperature of 4.5 °C. 

Fruit  Proleptic shoot 
2.406 
-2.84 
-0.00165 

63.703 
-4.896 
-0.00104 

Table 3: Relative growth rate at metamer scale for different friction parameter values (h) on the Fuji apple 
cultivar. Figures are reported with five decimals in order to see RGR differences when using different h 
values. 

Relative growth rate (mg g-1 dd-1) 

h 
0.25 
0.5 
1 
2 
4 
8 
16 

Old wood 

0.016 
0.016 
0.018 
0.019 
0.018 
0.015 
0.009 

Shoot 
0.50 
0.50 
0.50 
0.51 
0.54 
0.63 
0.63 

Fruit 
1.19 
1.20 
1.20 
1.22 
1.23 
1.17 
0.93 

25 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
  
  
 
 
 
 
 
 
  
  
 
  
  
 
 
 
  
 
 
1 
2 

3 

4 

Table 4: Number of components included in tree structures at different scales. 

Tree 

structure  Scale 

Fuji 

Ap-05 

Ap-10 

M 
GU 
TBS 
BR1 
FU 
M 
GU 
TBS 
BR1 
FU 
M 
GU 
TBS 
BR1 
FU 

Number of 
components  % 
100 
15.5 
9.5 
0.9 
2 
100 
11.7 
8.8 
2.5 
0.8 
100 
11 
7.4 
1.4 
0.9 

3355 
521 
320 
29 
67 
4579 
535 
402 
115 
36 
4083 
449 
302 
59 
36 

Computation 
time (min) 
175.6 
1.0 
0.6 
0.4 
0.4 
313.8 
1.5 
1.1 
0.7 
0.7 
246.4 
1.1 
0.8 
0.6 
0.6 

% 
100.0 
0.6 
0.4 
0.2 
0.2 
100.0 
0.5 
0.4 
0.2 
0.2 
100.0 
0.4 
0.3 
0.2 
0.2 

26 

 
 
 
 
 
 
  
 
 
 
  
 
 
 
  
 
1 

2 
3 

4 
5 

6 
7 

8 

9 

10 

11 

12 

13 

14 

Supplementary Information 

Supplementary Information: Inputs of the MuSCA model. 

Variable 

Description 

Unit 

Multi-scale Tree Graph description of a plant (.mtg) 

Coordinates of the centre of the top of a plant 
component 
tree component apical radius 
leaf area surface 
fresh fruit biomass 

XX, YY, ZZ 
radius 
leaf_area 
fruit 
observation  organ type: trunk, other types 

Topologica
l connector 
Scale 
boundary 

“>” for succession; “+” for branching 

“/” for boundary across scales 

m 
m 
m^2 
Kg 
- 

- 

Meteorological file for the RATP model (.mto) 
day 
hour 
PARglob 
PARdif 
NIRglob 
NIRdif 
Ratmos 
Tsol 
Tair 
Eair 
CO2air 
Wind 

day 
day of the year 
index of the current semi-hour from midnight 
30 min 
global incident Photosynthetically Active Radiation  W m^-2 
W m^-2 
diffused Photosynthetically Active Radiation 
W m^-2 
global incident Near Infrared Radiation 
W m^-2 
diffused Near Infrared Radiation 
W m^-2 
Total incoming radiation 
°C 
mean soil temperature 
°C 
mean air temperature 
Pa 
H2O partial pressure 
Pa 
CO2 partial pressure 
m s^-1 
wind speed above tree 

Supplementary Information: Input tree structures 

In  the  current  application,  input  tree  structures  were  MTGs  produced  by  the  MAppleT 

model  (Costes  et  al.  2008).  MAppleT  includes  (i)  Markov  models  for  simulating  annual  shoot 

branching and successive growth across years, (ii) a biomechanical model simulating the change in 

branch form over time, and (iii) a modified pipe-model to estimate axis radial growth. The leaf area 

and internode length depend on their rank along the shoot (Da Silva, Han, and Costes 2014). The 

MTGs  output  produced  by  MappleT  are  apple  trees  structures  at  a  certain  stage  of  development 

(given date of the year), represented at two scales, the growth unit and metamer. Metamer attributes 

are its apical and basal 3D coordinates, stem diameter, leaf area and fruit weight (if present). 

27 

 
 
 
  
 
 
 
 
 
 
 
 
  
 
 
At the beginning of the simulation, the model uses the geometrical description of the plant 

and some species specific parameters (Reyes et al. 2016, in-field observations) to estimate the 

initial dry weight of each plant component at the metamer scale (see Supplementary Information: 

Inputs of the MuSCA model). In particular: dry weight of old wood and vegetative internodes are 

computed as functions of their geometrical description (lengths and radiuses), and of a constant 

(wood density) or a function of thermal time, respectively; fruits dry weight is calculated from fresh 

weight and a constant (dry to fresh fruit dry weight ratio); leaf dry weight is calculated from surface 

and a constant (per unit surface leaf dry mass) (Table 1). Dry mass of individual internodes is 

calculated as follows: volumes of internodes are first computed as truncated cones, summed up to 

provide the volume of individual shoots and stored at a “current year shoot” coarse scale. The 

length of current year shoots is then obtained by summing the lengths of their internodes, and used 

to estimate shoot biomass by means of a thermal-time dependent allometric relationship (Table 1) 

(Reyes et al. 2016). Finally, the dry biomass of individual internodes is calculated as their 

individual volumetric fraction in the shoot to which they belong, multiplied by the shoot dry 

biomass. 

Regarding  the  root,  a  rough  representation  of  this  compartment  was  added  to  the  plant.  A 

root mass, defined as proportional to the total mass of the current year shoots, is added to the root 

metamer  following  the  shoot/root  functional  balance  assumption  (Davidson  1969;  Grechi  et  al. 

2007). The length of the roots is represented as equal to half the average distance between the soil 

and  the  vegetative  shoots.  The  root  basal  coordinates  are  thus  defined  equal  to  the  tree  basal 

coordinates,  except  for  the  vertical  (z  axis)  component,  to  which  the  calculated  distance  is 

subtracted (downward translation). 

1 

2 

3 

4 

5 

6 

7 

8 

9 

10 

11 

12 

13 

14 

15 

16 

17 

18 

19 

20 

21 

22 

23 

28 

 
 
A 

Topological and 
geometrical  
representation  
of a plant (MTG) 

GDD of current 
timestep 

Accumulated 
GDD 

Day of the year 

RATP model 

Light  
interception 

Estimate 
volumes and  
biomasses 

Allometric 
relationships 

Seasonal sink  
activities 

Meteorological  
conditions 

Photosynthesis  
& C-supplies 

C-demands for: 
Dry matter increase 
Maintenance respiration 
Growth respiration 

•
•
•

Core of multi-scale model 

Organs 
growth 

C-allocation at 
fine scale 

B 

Core of multi-scale model 

C-supplies 

MTG 

C-demands 

Choose scale  
of representation 

Use of  
fine scale? 

no 

Define boundaries of the 
new coarser scale 

Compute distances 
among plant components 

finest scale 
coarser scales 

Up-scaling 

Sum C-demands  
and supplies from  
fine to coarse scale 

yes 

C-allocation among 
components 
at selected scale 

Down-scaling 

C-allocation at 
fine scale 

Divide carbon allocated at coarse scale  
among fine scale components 

A 

Top coordinates 
of vertices 

base 

barycentres 

Coordinates  
of basis 

Variables 

functions 

Coordinates of 
barycenters 

vertices 
semi-
length 

i,j vertices in 
topology 

Identify 
GCA 

GCA of i, j 

Vertices i,j  
semi-lengths 

Compute 
distance 

Distances 
GCA-i,  
GCA-j 

Sum lengths 
in path 

Distance between  
vertices i, j 

top 

barycenter 

base 

Input 

Output 

Components in a coarse scale vertex 

Lengths 

x 

barycenter i 

∑ 

x 

x 

/∑ l(cid:1872)ℎ(cid:1871) 

barycenter I 

j 

Dist i,j 

Independent of the scale 

j 

barycenter 

semi-length 

base 

i 

insertion points 
in GCA(i,j) 

GCA 

GCA 

i 

son(GCA) in  
path i-GCA(i,j) 

B 

Metamer scale 

base 

top 

Coarse scales 

I 

i 

base I 
top i-1 

