Reconstructing Genotypes in Private Genomic
Databases from Genetic Risk Scores
Brooks Paige, James Bell, Aurélien Bellet, Adrià Gascón, Daphne Ezer

To cite this version:

Brooks Paige, James Bell, Aurélien Bellet, Adrià Gascón, Daphne Ezer. Reconstructing Geno-
24th International Confer-
types in Private Genomic Databases from Genetic Risk Scores.
ence On Research In Computational Molecular Biology (RECOMB 2020), 2020, Virtual, Italy.
￿10.1101/2020.01.15.907808￿. ￿hal-03100032￿

HAL Id: hal-03100032

https://inria.hal.science/hal-03100032

Submitted on 6 Jan 2021

HAL is a multi-disciplinary open access
archive for the deposit and dissemination of sci-
entific research documents, whether they are pub-
lished or not. The documents may come from
teaching and research institutions in France or
abroad, or from public or private research centers.

L’archive ouverte pluridisciplinaire HAL, est
destinée au dépôt et à la diffusion de documents
scientifiques de niveau recherche, publiés ou non,
émanant des établissements d’enseignement et de
recherche français ou étrangers, des laboratoires
publics ou privés.

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstructing Genotypes in Private Genomic
Databases from Genetic Risk Scores(cid:63)

Brooks Paige1,2[0000−0002−4797−1563], James Bell1[0000−0003−4493−4297], Aur´elien
Bellet3[0000−0003−3440−1251], Adri`a Gasc´on1,4, and Daphne
Ezer1,4,5[0000−0002−1685−6909]

1 The Alan Turing Institute, London, UK
2 Department of Computer Science, UCL, London, UK
3 Inria, France
4 University of Warwick, Coventry, UK
5 Department of Biology, University of York, York, UK {daphne.ezer}@york.ac.uk

Abstract. Some organisations like 23andMe and the UK Biobank have
large genomic databases that they re-use for multiple diﬀerent genome-
wide association studies (GWAS). Even research studies that compile
smaller genomic databases often utilise these databases to investigate
many related traits. It is common for the study to report a genetic risk
score (GRS) model for each trait within the publication. Here we show
that under some circumstances, these GRS models can be used to re-
cover the genetic variants of individuals in these genomic databases—a
reconstruction attack. In particular, if two GRS models are trained using
a largely overlapping set of participants, then it is often possible to de-
termine the genotype for each of the individuals who were used to train
one GRS model, but not the other. We demonstrate this theoretically
and experimentally by analysing the Cornell Dog Genome database. The
accuracy of our reconstruction attack depends on how accurately we can
estimate the rate of co-occurrence of pairs of SNPs within the private
database, so if this aggregate information is ever released, it would dras-
tically reduce the security of a private genomic database. Caution should
be applied when using the same database for multiple analysis, especially
when a small number of individuals are included or excluded from one
part of the study.

Keywords: Genomic privacy · Genetic risk scores · GWAS

1 Introduction

In a survey of genomic privacy experts, the long-term privacy of genomic infor-
mation was deemed both the most important and the most challenging problem

(cid:63) This project was funded by the Alan Turing Institute Research Fellowship under
EPSRC Research grant (TU/A/000017); EPSRC/BBSRC Innovation Fellowship
(EP/S001360/1), and under the EPSRC grant EP/N510129/1. It was also partly
funded by a grant from CPER Nord-Pas de Calais/FEDER DATA Advanced data
science and technologies 2015-20

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

2

B. Paige et al.

to overcome [11]. If an individual’s password or ID number gets leaked, then it
is always possible to change it. However, it is impossible for a person to change
their genetic code and they will pass part of it onto their children, so any in-
formation leaks can have long-term impacts on both the individual and their
descendants. While much of the research focus on long-term privacy of genomic
databases rests on the longevity of the encryption scheme [7], it is also important
to remember that these genomic databases are not just sitting on a server some-
where, but are being continually utilised for making new scientiﬁc discoveries.
Each time these databases are accessed and the scientiﬁc results are published,
there is a risk that information will be leaked and that eventually this would
enable an attacker to reconstruct private information held in the database.

Genomic researchers are already aware that some forms of aggregate data
from their databases should not be released publicly, because there is a risk that
an attacker may be able to determine whether a particular individual is a member
of the database (a membership inference attack). For instance, such attacks have
already been developed for summary statistics about the frequency of single
nucleotide polymorphisms (SNPs) [2, 5, 15]. Membership inference attacks have
also been developed for the case where a person is allowed to repeatedly query a
database to learn if at least one individual contains a particular SNP [13, 14, 16].
These kinds of aggregate statistics about the frequency or presence/absence of
a particular SNP might be useful to release to the broader research community,
but it is not an essential output of the research process. However, the main
research ﬁndings — i.e. the SNPs associated with the trait of interest and their
strength of association — are essential to publish since the entire purpose of
these genomic research projects is to uncover the relationship between genetic
variants and phenotypic traits. Moreover, knowledge of these SNPs can lead
to new diagnosis procedures or new potential drug targets, so their release is
important for the public interest [18]. Yet, even this information can potentially
leak private information about individuals in the database. For instance, [8]
found that information about individuals in a genomic database is leaked when
studies publish whether each SNP is correlated or anti-correlated to the trait of
interest. It is important to quantify how much information is leaked by publishing
these research ﬁndings, so that scientists can make informed decisions about
when to publish their results and whether it is worth risking the privacy of the
participants.

In this manuscript, we demonstrate that the kind of research output that is
published from genome-wide association studies (GWAS) has the potential to
leak enough information to recover the SNPs of individuals in the database (a
reconstruction attack), under speciﬁc circumstances. In particular, we focus on
the release of Genetic Risk Scores (GRS), a common research output for ﬁnding
genetic associations with continuous traits [1, 3, 4, 10, 12, 20]. We also focus on
cases where a database is repeatedly used to perform a GWAS analysis, but not
all the individuals are part of all the analyses. This could be the case because
some individuals drop out of the study or skip speciﬁc survey questions. Al-
ternatively, some databases, such as 23andMe, may grow in size over time and

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

3

Fig. 1. We investigate the
case where two GWAS stud-
ies are performed on two
data sets that mostly con-
tain the same individuals.
We reconstruct the genotype
of those individuals added to
the second study, using the
GRS from each study and an
estimate of SNP frequencies.

allow several GWAS to be performed within a short period of time. Under these
circumstances, we demonstrate that it is possible to completely reconstruct the
SNPs of an individual using a custom Expectation-Maximisation (EM) algo-
rithm. We also provide suggestions for avoiding this kind of attack.

To be clear, this manuscript focuses on the simpler case in which the exact
same trait is investigated in multiple GWAS studies; however, we expect that
some version of this attack may be developed in the near future for the case of
multiple highly correlated traits.

1.1 Overview of scenarios that will be investigated

We demonstrate a series of reconstruction attacks that enable us to infer the
genotypes of individuals in private genomic databases, based on publicly released
GRS. These attacks will initially be deployed on a very favorable scenario, but
the scope of the attack will be subsequently expanded, building up to the scenario
shown in Figure 1. It is worth noting that the reconstruction attacks that we
will describe do not depend on (i) how the SNPs were initially ﬁltered or (ii)
how strongly they associate with the trait of interest.

We will begin by investigating a simple scenario: two GWAS studies are
performed to identify SNPs associated with the same trait, and the two studies
use the same set of participants, except that the second study includes one extra
individual. In addition, we will assume that we know the frequencies of each
SNP and the frequencies that pairs of SNPs co-occur in the same individual.
We assume that both studies publish the coeﬃcients associated with the GRS
models that they infer as part of the analysis.

Next, we will consider the case in which the second study includes more than
one additional participant and demonstrate that in many circumstances this still
allows us to easily reconstruct the individual genotypes of all the individuals that
are found in the second study but not the ﬁrst (see Section 3.2).

Afterwards, we will demonstrate that we do not need to know the precise
frequencies of SNPs and frequencies of co-occurring SNPs, as long as we have a
reasonable estimate of these values from public databases (see Section 3.3).

Private data set 1+Private data set 2Public data setPublicly known:Genetic Risk ScoresGenetic Risk ScoresFrequencies of SNPs and frequencies of pairs of SNPs co-occurring in the same individualAttacker reconstructs genotype of additional individuals in data set 2GWASGWAS("#!)("#!"#)(%)(&#)bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

4

B. Paige et al.

We also brieﬂy discuss how loosening additional restrictions would impact
our ability to predict individual genotypes. In particular, we analyse the case
where the two sets of SNPs that are used by the two studies are not identical.
These results imply that if two sets of GRS are released on two genetic data
sets with largely overlapping populations, it may be possible to reconstruct the
genotypes of those individuals who participated in one study but not the other
(Figure 1).

2 Methods

Genetic risk score (GRS) models describe the relationship between a particular
phenotype of interest and particular SNPs. These models are ﬁt in a two-stage
process: ﬁrst, a reduced set of SNPs is selected from a potentially very large
pool of candidates; then, this reduced set is used as the independent variables
in a linear regression analysis. The set of SNPs is selected by ﬁrst ﬁltering for
those that signiﬁcantly correlate to the trait of interest, after controlling for
other covariates. These SNPs are then further ﬁltered to ensure that they are
far apart from one another, in order to decrease the correlation between them.
In this setting, we suppose M individuals have taken part in a study, and N
SNPs have passed the ﬁltration steps to be used in a linear model. Let yM be
the vector of M real-valued phenotypes, and XM be an M × N binary matrix,
where XM [i, j] = 1 if individual i has SNP j. To include an intercept term in
the linear model, we deﬁne a design matrix ΦM to be the M × (N + 1) matrix
ΦM = (cid:2) XM 1M

(1)

(cid:3) .

The GRS model parameter βM is just the coeﬃcient vector of the linear model

yM = ΦM βM + (cid:15),

(2)

where (cid:15) is independent Gaussian noise. Given ΦM and phenotypes yM , the max-
imum likelihood estimate of this parameter has a closed form
ˆβM (cid:44) 1
M

K −1(Φ(cid:62)

M yM ),

(3)

where we have deﬁned the symmetric (N + 1) × (N + 1) matrix K as

K =

1
M

Φ(cid:62)

M ΦM .

(4)

Now, suppose a second study is run, targeting the same phenotype, which
adds a single extra individual with SNPs represented by the N length vector
x0. This corresponds to adding the row φ(cid:62)
0 1 ] to the design matrix, and
extending y with the additional phenotypic value y0 for the new individual. The
updated estimator (i.e. the GRS values for the second study) is given by

0 = [ x(cid:62)

ˆβM +1 = (Φ(cid:62)

M ΦM + φ0φ(cid:62)

0 )−1(Φ(cid:62)

M yM + y0φ0).

(5)

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

5

We assume that both GRS models ˆβM and ˆβM +1 are released publicly. An
attacker aims to use this knowledge to reconstruct φ0 (the genotype of the added
individual). Through algebraic re-arrangement we ﬁnd that:

φ0 =

1
C

K( ˆβM +1 − ˆβM )

(6)

where C is a scalar, speciﬁcally C = 1
scalar multiple of K( ˆβM +1 − ˆβM ).

M (y0 − φ(cid:62)

0

ˆβM +1). This means that φ0 is a

Our approach thus centers on the use of the vector we deﬁne as d1,

d1 (cid:44) K( ˆβM +1 − ˆβM ) = Cφ0,

(7)

corresponding to a rescaled copy of the input SNP data in the design matrix φ0,
which can be easily computed from the two parameter vectors if the matrix K
is known. As we will see in Section 3.1, we can use d1 to exactly reconstruct the
added individual with 100% accuracy.

We additionally consider the case where m additional individuals have been
included in the second study, yielding a new GRS model ˆβM +m including these
M + m participants. The extra rows of the design matrix now form a matrix
Φm of size m × (N + 1), where each row is an individual that was added to the
second study and each column is a SNP (and the last column contains only 1).
The corresponding analog to Eq. (7) for multiple individuals, which we derive
in Appendix B, is

dm (cid:44) K( ˆβM +m − ˆβM ) = Φ(cid:62)

mCm,

(8)

where Cm is a vector of length m. For suﬃciently small m (relative to N ), exact
reconstruction of all m added individual genomes is also possible in this setting,
following the algorithm we will introduce in Section 3.2.

The previous examples have focused on cases in which the participants in
the ﬁrst study are a subset of the individuals in the second study. In Appendix
C we consider the case in which the ﬁrst study has some participants that are
not found in the second study and vice versa. We show that the same strategies
for reconstructing the genome can be used as in the previous scenario that we
discussed, in which multiple participants are added to the second study.

2.1 Estimation of K

As it turns out, the entries of matrix K correspond to simple population-level
statistics of the SNPs, which could either be inadvertently released (under the
assumption they would be safe to share), or could be estimated from another
sample from the same population. In fact, the entries of K depend only on the
SNP frequencies and SNP co-occurrence frequencies in the dataset:

– For i = 1, . . . , N : Kii estimates the probability that SNP i has value 1 (i.e.

the frequency of the SNP in the population).

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

6

B. Paige et al.

– For i = 1, . . . , N − 1 and j > i: Kij = Kji estimates the probability that
SNP i and SNP j are both 1 simultaneously (i.e. the frequency of SNP i and
SNP j co-occurring in the same individual).

– For i = 1, . . . , N and j = N + 1: Kij = Kji also estimates probability that

SNP i has value 1, i.e. Ki,N +1 = KN +1,i = Kii.

– Finally, KN +1,N +1 = 1.

Thus, knowledge of SNP frequencies and pairwise co-frequencies from the orig-
inal study are all that is required in order to compute K. In the following Sec-
tions 3.1 and 3.2, we consider adding one and multiple individuals at once,
respectively, in the setting where this matrix K can be estimated exactly.

However, while ˆβM , ˆβM +1 and M are likely to be published along with the
study, an attacker would often need to estimate K from other publicly available
data. Most studies will report some information about the study population
(such as whether the study focused on individuals from a speciﬁc continent),
which can help with estimating K. From this information, we can estimate the
value of K in similar populations as those used in the study using publicly
available data, e.g. from the HapMap project. Our additional experiments in
Section 3.3 use a custom EM algorithm to ﬁnd maximum likelihood estimates
of φ0 when the matrix ˆK ≈ K is estimated from independent public data. The
derivation of this EM algorithm is given in Appendix D.3, and a formal analysis
of the reconstruction error of φ0 given the error in ˆK is found in Appendix D.1.

3 Results

The key observation from the previous section is that the vectors d1 and dm,
derived from the change in parameter vectors ˆβ from a ﬁrst study to a second
study, take only a ﬁnite number of values thanks to the fact that the design
matrices Φ contain only zeros and ones. In particular, when m new individuals
are added to the second study, each entry of the vector dm can only take at most
2m values, and a zero value corresponds to the setting where all individuals have
the most common variant for that SNP.

This section describes algorithmically how these vectors can be used to re-
cover the genomes of the additional individuals, as well as empirical tests which
use the Cornell Dog Genome dataset as a case study [6]. More details on the
experimental setup can be found in Appendix A.

3.1 Complete reconstruction of one individual’s genotype when

SNP frequency information is known

The ﬁrst, most straightforward case is when only one participant is added be-
tween the ﬁrst and second studies, i.e. where ˆβM is the GRS for the ﬁrst study
(containing M participants), and ˆβM +1 is the GRS for the second study as de-
scribed in Eq. (3) and (5). Both of these are vectors of length N + 1, where
the ﬁrst N indices correspond to the relationship between each SNP and the

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

7

Fig. 2. (A) We have perfect accuracy in reconstructing the genotype when K is
known (using 200 random SNPs to estimate average breed weight in the Cornell Dog
Database). (B) We can reconstruct all the genotypes of multiple dogs that are added
to the second study and (C) this works in practice using the data from the Cornell
Dog Database, as in (A).

trait and the last element is the intercept of the linear model. For now, we also
assume we are in the setting where the matrix K is known, e.g. because the SNP
frequency information has been publicly released.

Given K, ˆβM +1 and ˆβM , we can use d1 (a vector of length N + 1) to precisely
determine the genotype of the individual who was added to the database. For
each i = 1, . . . , N , the ith entry of d1 is either equal to 0 if φ0 contains a 0 (i.e.
the individual does not have the SNP at that index) or to C if φ0 contains a
1 (i.e. the individual has the SNP at that index). In other words, it is possible
to exactly read oﬀ the SNPs of the added individual in this setting. Indeed, we
tested this strategy on the Cornell Dog Database and found that we were able
to reconstruct the genotype of the dog that was added to the second study with
100% accuracy, both on common and uncommon SNPs (see Figure 2(A)).

3.2 Complete reconstruction of multiple individuals’ genotype

when SNP frequency information is known

We now consider the case where m additional individuals have been included
in the second study, yielding a new GRS model ˆβM +m including these M + m
participants.

Consider again Eq. (8) above. The ith row of Φm is a binary vector that
represents the combination of the m individuals who have SNP i. This means
that, for a ﬁxed value of Cm, the value of the vector dm at index i is uniquely
determined by the combination of individuals who have SNP i (Figure 2(B)). In
other words, there will be at most 2m unique values taken by entries of dm, each
corresponding to a combination of the values in vector Cm (see Figure 2(C)).

If we were to learn which values of dm are also found in Cm, then we could
infer the complete genotypes of all the m individuals added to the second study.
We would be able to reconstruct m complete genotype vectors, although it would
be impossible to know which of the genotypes corresponded to which of the m
individuals. In fact, in many cases it is extremely straightforward to determine

0000100A010B001C110A+B101A+C011B+C111A+B+C!(#$!"#−#$!)[(]Possible combination of SNPs at index iAB!(#$!"#−#$!)[(]CbioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

8

B. Paige et al.

which values in dm correspond to values in Cm. Here we describe a simple algo-
rithm for ﬁnding Cm when there are exactly 2m unique values in dm. If this is
not the case, please see the more complete algorithm in Section G.

1. First, extract all unique, non-zero values from dm.
2. Find the sum of all pairs of values in this vector.
3. Find all values that are in (1), but not in (2). The values of Cm appear in
this list. There is no way to know which value of Cm corresponds to which
index, so for simplicity we can randomly assign them indices.

4. Each value in Cm corresponds to a speciﬁc individual who was added to
the second study. Each value in dm can be described as a sum of a unique
combination of values in Cm. For instance, if dm[i] = Cm[j] + Cm[k], this
means that the SNP at position i is found in individual j and k, but no one
else.

We tested this approach using the Cornell Dog Database, in a test scenario
where the second study added three diﬀerent dogs. We were able to uniquely
identify the genotypes of all three dogs with 100% accuracy, both with common
and uncommon SNPs (Figure 2(C)).

3.3 Accurate estimation of an individual’s genotype when SNP

frequency information is estimated from a public database

Previously, we assumed that
the attacker had access to the
matrix K, which consists of
population-level statistics on
frequencies and co-occurrence
frequencies of SNPs. While
this could be released volun-
tarily by organisations which
are not aware of the risk, we
now consider the case where
K is not directly available to
the attacker but is instead es-
timated from a separate pub-
lic database assumed to corre-
spond to individuals from the
same population.

Fig. 3. Example values taken by the noisy vector
ˆd, given the true value of the corresponding SNP
in the genome. (Left) adding one new participant;
(right) adding three new participants. These ﬁgures
are analogous to those in Figure 2, albeit in the case
where K is not known and instead estimated from
an independent public database.

We simulated this scenario using the Cornell Dog Database by taking one
random set of dogs for building the GRS model, and a second non-overlapping
set of dogs for estimating ˆK. We compared the value of ˆd1 = ˆK( ˆβM +1 − ˆβM )
with the known value of φ0. We observe that ˆd1 has signiﬁcantly diﬀerent values
at indices where φ0[i] = 0 and φ0[i] = 1; examples for the cases where one and
three dogs are added can be seen in Figure 3.

0.20.00.20.40.60.81.01.2true x00.00040.00020.00000.00020.00040.00060.00080.0010Value of d0^ 000001010011100101110111True SNP for three additional dogs0.0040.0030.0020.0010.0000.0010.0020.0030.004Value of dmbioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

9

Fig. 4. Accuracy at reconstruction of genomes x0 using EM estimation and a noisy
estimate ˆK, as compared to a natural baseline which always predicts the most common
variant at each SNP locus. We use this as a baseline, because without any additional
information about βM and βM +1, the most accurate prediction of the dog’s genotype
would be to predict the most common variant at each locus. Here we deﬁne accuracy
as the proportion of SNPs that are correctly identiﬁed in the dog that was found in
the second GWAS study, but not the ﬁrst. Each distribution is constructed from 500
experimental test points, in which we (i) took 10 random splits of the full dog data set,
assigning dogs to either the public and private data set (ii) for each split, we tested
the reconstruction 50 times, each time adding a diﬀerent randomly sampled dog to the
second GWAS study. The private dataset always has 1000 individuals; the public test
dataset is of increasing size, improving performance.

The main challenge is that the vector ˆd1 now includes additional noise, so we
cannot simply use its entry at index N + 1 to estimate C, nor do the entries i
with φ0[i] = 0 also correspond directly to ˆd1[i] = 0. Instead, we develop a custom
expectation-maximisation algorithm to ﬁnd a maximum likelihood estimate of
the constant C and recover φ0, i.e. to determine the probability that each φ0[i] =
0 or φ0[i] = 1, based on the value of ˆd1 (see Section D.3 for details). We ﬁnd
that this method can successfully reconstruct the correct value of φ0[i] much
better than a baseline which uses the public dataset to independently estimate
the most common variant for each SNPs (see Figure 4). Crucially, we show that
our approach is able to reconstruct, with relatively high accuracy, the genotypes
of dogs even when they diﬀer signiﬁcantly from those in the public dataset
(see Figure 5). This shows that our attack is able to extract information about
the particular individuals that diﬀer across the two studies, not merely about
the general population as in the most-common-variant baseline. By deﬁnition,
dogs that have genotypes that diﬀer signiﬁcantly from the general population
have a higher proportion of uncommon SNPs, and the ability to recover these
uncommon SNPs is particularly important from a privacy perspective. Indeed,
uncommon SNPs can be used to identify a particular individual and are also more
likely to be associated with disease phenotypes, which is sensitive information.
In general, we ﬁnd that the larger the public dataset available, and the more
similar the dataset is to the unknown private dataset, the better we are able to
reconstruct the genome of the added individual. Full details and description of
the experimental setting are given in Section A. We also derive theoretical error
bounds for our estimate of φ0 based on the error in ˆK in Section D.1.

baselineestimated0.00.20.40.60.81.0Public set: 400 dogsbaselineestimated0.00.20.40.60.81.0Public set: 200 dogsbaselineestimated0.00.20.40.60.81.0Public set: 800 dogsAccuracybioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

10

B. Paige et al.

Fig. 5. Results of Figure 4 broken down by individual dogs. Here each point represents
a dog and we deﬁne atypicality as the proportion of uncommon variants that the dog
has compared to the public database– for instance, if 51% or more of dogs in the
public database have a G in a speciﬁc locus, but this dog has a T, then this would
count towards the dog’s atypicality. In other words, dogs further to the right are less
and less similar to average dog present in the public dataset (measured by percentage
of diﬀerent variants). In contrast to the most-common-variant baseline, our method
generalizes well even to dogs which are highly dissimilar to those in the public dataset.
Larger public databases (right) provide more accurate population estimates ˆK, leading
to more accurate reconstructions overall.

3.4 Accurate estimation of an individuals’ genotype when diﬀerent

SNPs are used in each study

When GRS models are constructed, the ﬁrst step is to ﬁlter the set of SNPs
down to a small set of SNPs that are (i) signiﬁcantly correlated to the trait after
covariates are considered and (ii) far apart from one another along the genome.
If the two studies use two diﬀerent sets of SNPs to construct the GRS model,
it is still possible to recover whether or not each of the SNPs in the overlap is
present in the new individual. This process is highly analogous to the previous
cases and is detailed in Appendix F.

4 Discussion

In this manuscript, we demonstrate that private information is leaked when GRS
models are published, speciﬁcally in the case where two sets of largely overlap-
ping individuals are used for multiple studies. In particular, we show that we can
recover SNPs from an individual in a private database—a reconstruction attack.
Even though we would not have a name associated with this genotype, it may
be possible to identify the individual once the genotypic data is available to the
attacker. For instance, the attacker may have access to partial genotypic infor-
mation of the individual and then be able to identify them. Alternatively, they
could use the genotype information to predict ethnicity and other phenotypic
traits that could then be used to uniquely identify the individual. We also note
that even an incomplete reconstruction attack (in which only a proportion of
the SNPs are correctly identiﬁed) is likely to be suﬃcient to perform a member-
ship inference attack. Investigating the relationship between the reconstruction

0.340.360.380.400.420.440.460.48atypicality0.00.20.40.60.81.0accuracyPublic set: 200 dogsbaselineestimated0.340.360.380.400.420.440.46atypicality0.00.20.40.60.81.0accuracyPublic set: 400 dogsbaselineestimated0.340.360.380.400.420.440.460.480.50atypicality0.00.20.40.60.81.0accuracyPublic set: 800 dogsbaselineestimatedbioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

11

attack and the membership attack will be a subject of future research. Impor-
tantly, if the attackers were unable to link the genomic data with a particular
individual, the reconstruction attack would still be a breach in privacy that could
have serious consequences. For instance, the patient may have only consented
to have their genomic data used in particular kinds of research studies, while
the attacker may use the reconstructed genomic data for a diﬀerent (potentially
unethical) purpose.

Suggestions for good practice. We provide a number of simple suggestions for
good practice that would help limit this attack.

1. Aggregate statistics about the frequency of SNPs in the database or the fre-
quency of co-occurrence of SNPs should never be released. We have shown
that this information, combined with GRS, allows to precisely reconstruct
individual genomes in various settings. It may be possible to release noisy
versions of SNP frequency data, but this would be equivalent to releasing ˆK
(our estimated K from the public database). With our EM algorithm, we
have demonstrated that it is still possible to do some genotypic reconstruc-
tion with a noisy ˆK, but this becomes harder as the noise in ˆK increases.
However, providing a very noisy ˆK may be of limited utility to the scientiﬁc
community.

2. If a genetic data set is intended to serve for multiple complementary anal-
yses, it is important that all study participants are used in every analysis
performed. If there is missing phenotypic data from a few individuals, they
should not be included in any of the analyses performed, or their privacy
may be compromised.

3. When multiple individuals are added in between two studies, then the ability
to reconstruct the genomes depends on the number of SNPs being large
relative to the number of individuals. In particular, if m new dogs are added,
exact reconstruction is only possible using the approach in Section 3.2 if the
number of SNPs N > 2m. Thus, we suggest to avoid releasing multiple
studies which diﬀer by fewer than log2 N individuals.

Extensions and future work. While we have analyzed the case where the genome
is represented by binary values of 0 or 1, often studies instead count the number
of times each allele is present, which would lead to a design matrix Φ containing
values 0, 1, or 2. In this scenario, K no longer contains the frequencies of SNPs
and their co-occurrences, but something slightly more complicated that we de-
scribe in Appendix H. This does not dramatically change the approach in this
paper, except in that the vector dm can take 3m possible values, rather than
2m. In practice, then, studies which use allele counts are somewhat more robust
to attacks; the multiple dog reconstruction attack would likely be ambiguous if
3m > N , rather than 2m > N .

A possible countermeasure to our reconstruction attack could consist in ran-
domly perturbing the GRS models before releasing them, as done in diﬀerentially
private linear regression [19]. However, a naive application of this strategy could

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

12

B. Paige et al.

destroy the utility of the models. A formal and empirical analysis of the eﬀective-
ness of such protection against reconstruction attacks, as well as of the usefulness
of the resulting GRS models to genomic researchers, is beyond the scope of this
paper and left for future work.

Another countermeasure could consist in refraining from releasing precise
information about the population structure of the study population to prevent
the attacker from estimating K eﬀectively. This would however limit the utility
of the research study, because the researchers would not know to what popula-
tions the research applies to. An investigation of how diﬀerences in population
structures impact Kest will be undertaken in public human genomic data sets in
future work, but is also beyond the scope of this paper.

Our work has a number of limitations. For instance, we only test our EM
algorithm on dog data. Dog populations may have diﬀerent population structures
than human populations due to selective breeding, so in the future we aim to
test how properties of population structure will impact our ability to estimate
K and the accuracy of our reconstruction attack. In addition, the expectation-
maximisation algorithm described here is only explicitly described for the case in
which one participant is added to the database, and the matrix K is estimated
from a public database. We are currently extending the algorithm to the broader
case in which multiple participants are added at once.

It may seem on the surface unlikely that two GWAS analyses will include
nearly the same participants. One potentially common setting where this could
arise is when a single study collects both genotype and phenotype data from
a single set of participants, and releases multiple models to predict multiple
traits. In this case, there may be a small number of individuals who are used
in one analysis, but not the other; for instance, there may be a small subset
of participants who skip a particular survey question that was used to collect
phenotype information, and this is indeed evident in a recent study ([9]). In
such settings, it could be very possible for multiple released GRS models to be
computed on sets of individuals which diﬀer by only a few participants. In future
work, we aim to extend our analysis and attack to settings where multiple GRS
models are released, each predicting diﬀerent but highly correlated traits.

References

1. Belsky, D.W., Moﬃtt, T.E.,

J., Caspi, A.: Development
McCarthy,
risk
obesity. Biodemography
score
https://doi.org/10.1080/19485565.2013.774628

for

Sugden, K., Williams, B., Houts, R.,
genetic
and evaluation of
(2013).

a
Social Biology

and

2. Cai, R., Hao, Z., Winslett, M., Xiao, X., Yang, Y., Zhang, Z., Zhou, S.: Determin-
istic identiﬁcation of speciﬁc individuals from GWAS results. In: Bioinformatics
(2015). https://doi.org/10.1093/bioinformatics/btv018

3. Chouraki, V., Reitz, C., Maury, F., Bis, J.C., Bellenguez, C., Yu, L., Jakobsdottir,
J., Mukherjee, S., Adams, H.H., Choi, S.H., Larson, E.B., Fitzpatrick, A., Uitter-
linden, A.G., De Jager, P.L., Hofman, A., Gudnason, V., Vardarajan, B., Ibrahim-
Verbaas, C., Van Der Lee, S.J., Lopez, O., Dartigues, J.F., Berr, C., Amouyel, P.,

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

13

Bennett, D.A., Van Duijn, C., Destefano, A.L., Launer, L.J., Ikram, M.A., Crane,
P.K., Lambert, J.C., Mayeux, R., Seshadri, S.: Evaluation of a Genetic Risk Score
to Improve Risk Prediction for Alzheimer’s Disease. Journal of Alzheimer’s Disease
(2016). https://doi.org/10.3233/JAD-150749

4. Day, F.R., Thompson, D.J., Helgason, H., Chasman, D.I., Finucane, H., Sulem, P.,
Ruth, K.S., Whalen, S., Sarkar, A.K., Albrecht, E., Altmaier, E., Amini, M., Bar-
bieri, C.M., Boutin, T., Campbell, A., Demerath, E., Giri, A., He, C., Hottenga,
J.J., Karlsson, R., Kolcic, I., Loh, P.R., Lunetta, K.L., Mangino, M., Marco, B.,
McMahon, G., Medland, S.E., Nolte, I.M., Noordam, R., Nutile, T., Paternoster,
L., Perjakova, N., Porcu, E., Rose, L.M., Schraut, K.E., Segr`e, A.V., Smith, A.V.,
Stolk, L., Teumer, A., Andrulis, I.L., Bandinelli, S., Beckmann, M.W., Benitez,
J., Bergmann, S., Bochud, M., Boerwinkle, E., Bojesen, S.E., Bolla, M.K., Brand,
J.S., Brauch, H., Brenner, H., Broer, L., Br¨uning, T., Buring, J.E., Campbell, H.,
Catamo, E., Chanock, S., Chenevix-Trench, G., Corre, T., Couch, F.J., Cousminer,
D.L., Cox, A., Crisponi, L., Czene, K., Davey Smith, G., De Geus, E.J., De Mut-
sert, R., De Vivo, I., Dennis, J., Devilee, P., Dos-Santos-Silva, I., Dunning, A.M.,
Eriksson, J.G., Fasching, P.A., Fern´andez-Rhodes, L., Ferrucci, L., Flesch-Janys,
D., Franke, L., Gabrielson, M., Gandin, I., Giles, G.G., Grallert, H., Gudbjartsson,
D.F., Gu´enel, P., Hall, P., Hallberg, E., Hamann, U., Harris, T.B., Hartman, C.A.,
Heiss, G., Hooning, M.J., Hopper, J.L., Hu, F., Hunter, D.J., Ikram, M.A., Im,
H.K., J¨arvelin, M.R., Joshi, P.K., Karasik, D., Kellis, M., Kutalik, Z., Lachance,
G., Lambrechts, D., Langenberg, C., Launer, L.J., Laven, J.S., Lenarduzzi, S.,
Li, J., Lind, P.A., Lindstrom, S., Liu, Y., Luan, J., M¨agi, R., Mannermaa, A.,
Mbarek, H., McCarthy, M.I., Meisinger, C., Meitinger, T., Menni, C., Metspalu,
A., Michailidou, K., Milani, L., Milne, R.L., Montgomery, G.W., Mulligan, A.M.,
Nalls, M.A., Navarro, P., Nevanlinna, H., Nyholt, D.R., Oldehinkel, A.J., O’Mara,
T.A., Padmanabhan, S., Palotie, A., Pedersen, N., Peters, A., Peto, J., Pharoah,
P.D., Pouta, A., Radice, P., Rahman, I., Ring, S.M., Robino, A., Rosendaal, F.R.,
Rudan, I., Rueedi, R., Ruggiero, D., Sala, C.F., Schmidt, M.K., Scott, R.A., Shah,
M., Sorice, R., Southey, M.C., Sovio, U., Stampfer, M., Steri, M., Strauch, K.,
Tanaka, T., Tikkanen, E., Timpson, N.J., Traglia, M., Truong, T., Tyrer, J.P.,
Uitterlinden, A.G., Edwards, D.R., Vitart, V., V¨olker, U., Vollenweider, P., Wang,
Q., Widen, E., Van Dijk, K.W., Willemsen, G., Winqvist, R., Wolﬀenbuttel, B.H.,
Zhao, J.H., Zoledziewska, M., Zygmunt, M., Alizadeh, B.Z., Boomsma, D.I., Ciullo,
M., Cucca, F., Esko, T., Franceschini, N., Gieger, C., Gudnason, V., Hayward, C.,
Kraft, P., Lawlor, D.A., Magnusson, P.K., Martin, N.G., Mook-Kanamori, D.O.,
Nohr, E.A., Polasek, O., Porteous, D., Price, A.L., Ridker, P.M., Snieder, H., Spec-
tor, T.D., St¨ockl, D., Toniolo, D., Ulivi, S., Visser, J.A., V¨olzke, H., Wareham,
N.J., Wilson, J.F., Spurdle, A.B., Thorsteindottir, U., Pollard, K.S., Easton, D.F.,
Tung, J.Y., Chang-Claude, J., Hinds, D., Murray, A., Murabito, J.M., Stefansson,
K., Ong, K.K., Perry, J.R.: Genomic analyses identify hundreds of variants asso-
ciated with age at menarche and support a role for puberty timing in cancer risk.
Nature Genetics (2017). https://doi.org/10.1038/ng.3841

5. Dwork, C., Smith, A., Steinke, T., Ullman, J., Vadhan, S.: Robust traceability from
trace amounts. 2015 IEEE 56th Annual Symposium on Foundations of Computer
Science pp. 650–669 (Oct 2015). https://doi.org/10.1109/FOCS.2015.46

6. Hayward, J.J., Castelhano, M.G., Oliveira, K.C., Corey, E., Balkman, C., Baxter,
T.L., Casal, M.L., Center, S.A., Fang, M., Garrison, S.J., Kalla, S.E., Korniliev,
P., Kotlikoﬀ, M.I., Moise, N.S., Shannon, L.M., Simpson, K.W., Sutter, N.B., Tod-
hunter, R.J., Boyko, A.R.: Complex disease and phenotype mapping in the domes-

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

14

B. Paige et al.

tic dog. Nature Communications (2016). https://doi.org/10.1038/ncomms10460
7. Huang, Z., Ayday, E., Fellay, J., Hubaux, J., Juels, A.: Genoguard: Protecting
genomic data against brute-force attacks. 2015 IEEE Symposium on Security and
Privacy pp. 447–462 (May 2015). https://doi.org/10.1109/SP.2015.34

gwas

8. Im, H., Gamazon, E., Nicolae, D., Cox, N.: On sharing quantitative
limits
trait
of genomic privacy. The American Journal of Human Genetics 90(4),
591 – 598 (2012). https://doi.org/https://doi.org/10.1016/j.ajhg.2012.02.008,
http://www.sciencedirect.com/science/article/pii/S0002929712000936

of multiple-omics data

in an era

and the

results

9. Jiang, L., Zheng, Z., Qi, T., Kemper, K.E., Wray, N.R., Visscher, P.M., Yang, J.:
A resource-eﬃcient tool for mixed model association analysis of large-scale data.
bioRxiv (2019). https://doi.org/10.1101/598110

10. Knowles, J.W., Ashley, E.A.: Cardiovascular disease: The rise of the genetic risk
score. PLoS Medicine (2018). https://doi.org/10.1371/journal.pmed.1002546
genome

11. Mittos, A., Malin, B., Cristofaro, E.D.:

Systematizing

research: A privacy-enhancing
on Privacy Enhancing Technologies 2019(1),

vacy
ings
https://content.sciendo.com/view/journals/popets/2019/1/article-p87.xml

technologies

87

–

pri-
perspective. Proceed-
(2019),
107

12. Qi, L., Ma, J., Qi, Q., Hartiala, J., Allayee, H., Campos, H.: Genetic
infarction in hispanics. Circulation (2011).

risk score and risk of myocardial
https://doi.org/10.1161/CIRCULATIONAHA.110.976613

13. Raisaro, J.L., Tram`er, F., Ji, Z., Bu, D., Zhao, Y., Carey, W.K., Lloyd, D.D., Soﬁa,
H., Baker, D., Flicek, P., Shringarpure, S.S., Bustamante, C.D., Wang, S., Jiang,
X., Ohno-Machado, L., Tang, H., Wang, X., Hubaux, J.P.: Addressing beacon re-
identiﬁcation attacks: quantiﬁcation and mitigation of privacy risks. Journal of the
American Medical Informatics Association 24(4), 799 – 805 (2017)

14. Shringarpure, S., Bustamante, C.: Privacy

from genomic data-
sharing beacons. The American Journal of Human Genetics 97(5), 631
–
https://doi.org/https://doi.org/10.1016/j.ajhg.2015.09.010,
http://www.sciencedirect.com/science/article/pii/S0002929715003742

(2015).

risks

646

15. Simmons, S., Berger, B.: One size doesn’t ﬁt all: Measuring individual privacy in
aggregate genomic data. 2015 IEEE Security and Privacy Workshops pp. 41–49
(May 2015). https://doi.org/10.1109/SPW.2015.25

16. von Thenen, N., Ayday, E., Cicek, A.E.: Re-identiﬁcation of

individ-
uals
inference. Bioinformat-
ics 35(3), 365–371 (07 2018). https://doi.org/10.1093/bioinformatics/bty643,
https://doi.org/10.1093/bioinformatics/bty643

in genomic data-sharing beacons via allele

17. Tropp, J.A.: An introduction to matrix concentration inequalities. Foundations

and Trends R(cid:13) in Machine Learning 8(1-2), 1 – 230 (2015)

18. Visscher, P.M., Wray, N.R., Zhang, Q., Sklar, P., McCarthy, M.I.,
Brown, M.A., Yang, J.: 10 years of gwas discovery: Biology,
function,
and translation. The American Journal of Human Genetics 101(1), 5
–
https://doi.org/https://doi.org/10.1016/j.ajhg.2017.06.005,
http://www.sciencedirect.com/science/article/pii/S0002929717302409

(2017).

22

19. Wang, Y.X.: Revisiting diﬀerentially private linear regression: optimal and adaptive
prediction & estimation in unbounded domain. In: Proceedings of the Conference
on Uncertainty in Artiﬁcial Intelligence (UAI). pp. 93–103 (2018)

20. Zhao, X., Xi, B., Shen, Y., Wu, L., Hou, D., Cheng, H., Mi, J.: An obesity genetic
risk score is associated with metabolic syndrome in Chinese children. Gene (2014).
https://doi.org/10.1016/j.gene.2013.11.006

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

15

A Experimental details

Cornell Dog Database: To experimentally test the reconstruction attacks, we
used data from the Cornell Dog Genome Database, which contains data about
SNPs from a wide range of dog breeds and a number of associated phenotypic
traits. The two traits we focused on were average breed weight and average breed
height, because these two phenotypes had the fewest number of missing values.
For the initial investigation, we binarised the genotype matrix—considering all
heterogenous alleles to have a value of 1. (We also repeated the analysis with
the original genotype matrix.) Only common SNPs (i.e. SNPs that were found
in 25% to 75% of the dogs) were used, leaving 23,497 SNPs. For each linear
model built, M = 1000 dogs were randomly sampled as the “private” dataset
and N = 200 SNPs were randomly selected. To ensure that the SNPs that
were sampled were spatially distributed, the SNPs were randomly sampled in a
stratiﬁed way, so one SNP was selected in every 23,497

200 -sized bin.

Experiment with imprecise K: First, two linear models were constructed to
predict average breed weights: one with the M = 1000 randomly sampled dogs
and another that contained 1 additional randomly sampled dog. This gives ˆβM
and ˆβM +1. To mimic the process of estimating K from a public database, we
randomly sampled an additional 200, 400, or 800 dogs that were not included
as part of the original set and used this to estimate K, which we refer to as ˆK.
Now we could calculate ˆK( ˆβM +1 − ˆβM ) and compare this to the known φ0 for
the additional dog from the second study. These additional dogs are taken from
a third “test” dataset, disjoint from both the public and private data. The plots
in Figures 4 and 5 are produced by re-running the algorithms across 10 random
public / private / test splits, where the “test” dataset has 50 dogs which are
each individually considered as candidates for the (M + 1)th dog added to the
private dataset.

B Adding multiple dogs

Here we explain Equations (7) and (8). Note that the former is a special case of
the latter so we will only explain the latter in detail. First note that by deﬁnition

ˆβM = (Φ(cid:62)
ˆβM +m = (Φ(cid:62)

M ΦM )−1Φ(cid:62)
M +mΦM +m)−1Φ(cid:62)

M yM = (M KM )−1ΦT

M yM ,
M +myM +m = (M KM + mKm)−1Φ(cid:62)

M +myM +m.

Substituting these into the left hand side of the following equation gives the right
hand side:

(M KM + mKm) ˆβM +m − M KM

ˆβM = ΦT

mym.

(9)

This equation can be rearranged to give
1
M
1
M

KM ( ˆβM +m − ˆβM ) =

=

ΦT

mym −

m
M

Km

ˆβM +m

ΦT

m(ym − Φm

ˆβM +m).

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

16

B. Paige et al.

ˆβM +m) yields the form used
Deﬁning the length m vector Cm = 1
in Equation (8). For the special case of m = 1, Cm is a scalar and we recover
Eq. (7).

M (ym − Φm

C Case in which each GWAS study adds two new sets of

participants

This manuscript mostly explores the case in which one study’s participants are
a subset of the other study’s participants. Here we demonstrate that this is
equivalent to the case where each of the two studies contain a small number of
participants that are not found in the other study.

In particular, let us say that the ﬁrst study has M + a participants and the
second study has M + b participants, where the ﬁrst M participants are shared
between the studies, but there are a participants that are found in the ﬁrst study
but not the second, and b participants that are found in the second study but
not the ﬁrst. Following on from Equation 9, we see that:

KM ( ˆβM +a − ˆβM +b) = KM ( ˆβM +a − ˆβM ) − KM ( ˆβM +b − ˆβM )

=

1
M

(cid:104)
ΦT

a (ya − Φa

ˆβM +a) − ΦT

b (yb − Φb

(cid:105)
ˆβM +b)

.

Let us deﬁne the following (N +1)×(a+b) matrix obtained by concatenating

the two genotype matrices:

Φa+b = [Φa, Φb]

and the following a + b length vector:

(cid:104)

ra+b =

(ya − Φa

ˆβM +a), −(yb − Φb

(cid:105)
ˆβM +b)

Then this gives us:

KM ( ˆβM +a − ˆβM +b) =

1
M

Φa+bra+b

(10)

(11)

(12)

This means that having two non-overlapping participant sets is equivalent
to the setting in which the ﬁrst study is a subset of the second (only m is now
a + b).

D Estimating K

If the true matrix K is unknown, it can be estimated with public data. We
denote this estimator by ˆK. In order for ˆK to be an accurate estimate the data
that it is generated from must be drawn from the same (or a suﬃciently similar)
population as that used in the private study. We will model this assuming no
discrepancy between population distributions, however when we discuss how to

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

17

evaluate whether the estimate is good that assessment should account for this
systematic error as well.

In the following we are primarily concerned with the error due to the subsam-
pling in both the private and public data sets. For convenience we only consider
the case of adding a single individual, though the generalization is quite straight-
forward.

D.1 Analytic bound on (cid:107)φ0 − ˆφ0(cid:107)

If ˆK is substituted for K in our reconstruction equation (7) we get an approx-
imation of φ0 which we denote ˆφ0. We would like to bound the (relative) error
between φ0 and ˆφ0. In the following, we ignore the constant factors C and ˆC for
simplicity, noting that these scaling factors are estimated from the resulting φ0
or ˆφ0 anyway. We thus consider ϕ0 = K( ˆβM +1 − ˆβM ) and ˆϕ0 = ˆK( ˆβM +1 − ˆβM ).
Using (cid:107) · (cid:107) on vectors, and also on matrices to denote the corresponding operator
norm. The relative error between ϕ0 and ˆϕ0 is given by:

(cid:107)ϕ0 − ˆϕ0(cid:107)
(cid:107)ϕ0(cid:107)

=

(cid:107)( ˆK ˆK −1 − ˆKK −1)ϕ0(cid:107)
(cid:107)ϕ0(cid:107)

≤ (cid:107) ˆK ˆK −1 − ˆKK −1(cid:107) = (cid:107) ˆK( ˆK −1 − K −1)(cid:107).

Note that ˆK −1 − K −1 = ˆK −1(K − ˆK)K −1 and hence

(cid:107) ˆϕ0 − ϕ0(cid:107)
(cid:107)ϕ0(cid:107)

≤ (cid:107)K −1(cid:107)(cid:107)K − ˆK(cid:107),

(13)

This means we can bound the error by two quantities. The term (cid:107)K −1(cid:107) is
bounded above by 1/ min(eig(K)), which is ﬁnite as soon as K is non-singular.
This is not a strong requirement as in the case of linear regression it is required for
ˆβM +1 and ˆβM to exist. Note that in the case of L2-regularized linear regression
(i.e., ridge regression), K is replaced by K + λI where λ is the regularization
parameter, and we can directly bound this term by λ.

The key term in (13) is (cid:107)K − ˆK(cid:107), the error in estimating K by ˆK. Let us
assume that the public database used to obtain ˆK follows the same distribution
as the private database used to ﬁt the GRS models. Denote by ˆM the number of
individuals used to estimate ˆK. Then, under classic boundedness assumptions
and leveraging matrix concentration inequalities such as matrix Bernstein [17]
(cid:113)
we can show that E[(cid:107)K − ˆK(cid:107)] = O(1/
min( ˆM , M )). This shows that the error
in estimating K is small as long as the private and public databases are large
enough.

D.2 Modelling the error in ˆK

In this section we deﬁne a model to capture the error in ˆK, which leads to
the expectation maximization algorithm for estimating φ0 which is used in the
experiments.

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

18

B. Paige et al.

As our estimated ˆK drifts from the true K, this expression ˆK( ˆβM +1 − ˆβM )
would produce a wider range of values than just 0 and C. Let (cid:15)ij ∼ N (0, σ2) be
independent noise, which we assume corrupts each element of Kij; i.e. given the
estimated matrix ˆK, suppose

Kij ∼ N ( ˆKij, σ2),

(14)

for some small σ2. This is clearly an oversimpliﬁcation (as we know K is e.g.
bounded and symmetric), but is a useful starting point that allows derivation of
a simple estimation algorithm. For notational brevity, in this and the following
section we deﬁne the vector

∆ = ˆβM +1 − ˆβM

(15)

which corresponds to the diﬀerence between the two GRS model parameter
vectors. Given the true value of K, the system of equations

Cφ0 = K∆

relates the known quantity ∆ and the Gaussian-distributed K with the unknown
value of C and of the vector φ0.

If K is Gaussian (following Eq. (14)), then the linear transformation K∆ is
Gaussian as well. We denote each of the rows of K as a vector ki, i = 1, . . . , N ;
then for each row, the scalar value

i ∆ ∼ N (ˆk(cid:62)
k(cid:62)

i ∆, σ2∆(cid:62)∆),

meaning overall the vector K∆ is distributed N ( ˆK∆, σ2∆(cid:62)∆I). With some
algebraic re-arrangement, and since for the true underlying value of K we have
K∆ = Cφ0, we can write this as

ˆK∆ ∼ N (Cφ0, σ2∆(cid:62)∆I)

(16)

where C and σ are parameters we need to estimate. The vector ˆK∆ is observed
“data”, computed from the public SNP database and the two released parameter
vectors. We can model each of the entries of φ0, which are zeros and ones,
as Bernoulli distributions, whose prior probabilities correspond to the public
dataset estimated frequencies. This suggests a model for ˆK∆ which is akin to a
constrained mixture of Gaussians.

D.3 Derivation of EM algorithm for reconstructing an individual’s

genotype

Given the model in Eq. (16), we can deﬁne an EM algorithm for maximum
likelihood estimation of C and σ2, which then permits easy inference for each
entry of φ0.

Denote the entries of φ0 as z1, . . . , zN +1; denote their prior probabilities as
α1, . . . , αN +1, where α1, . . . , αN are the (public) population frequencies for each

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

19

SNP, and αN +1 = 1.0. Let x1, . . . , xM denote the entries of the ﬁxed (observed)
vector x = ˆK∆, which is distributed

p(x|C, z, σ2) = N (x|Cz, σ2∆(cid:62)∆I).

Supposing we know values of C, σ2, to estimate the entries of φ0 we want to ﬁnd
p(z|x, C, σ2),

p(z|x, C, σ2) ∝ p(x|C, z, σ2)p(z)

For each zi, i = 1, . . . , N , we deﬁne the quantity

πi = p(zi = 1|x, C, σ2) =

αiN (xi|C, σ2∆(cid:62)∆)
αiN (xi|C, σ2∆(cid:62)∆) + (1 − αi)N (xi|0, σ2∆(cid:62)∆)

,

(17)
the posterior probability of each particular entry taking a value of 1, rather than
0. A maximum likelihood algorithm to estimate C, σ2 proceeds by alternately:

1. Given C, σ2, estimate the posterior distribution π = p(z|x, C, σ2);
2. Given the posterior π, maximize L = Eπ[log p(x|C, z, σ2)] with respect to C

and σ2.

To maximize C and σ2, we ﬁrst compute the derivatives of

(cid:88)

(cid:88)

L =

i

zi

p(zi| . . . ) log p(xi|C, zi, σ2)

=

N
(cid:88)

i=1

πi log N (xi|C, σ2∆(cid:62)∆) + (1 − πi) log N (xi|0, σ2∆(cid:62)∆).

We take derivative w.r.t. C,

∂L
∂C

(cid:88)

=

i

πi
σ2∆(cid:62)∆

(xi − C)

and set equal to zero to ﬁnd

ˆC =

(cid:80)
i πixi
(cid:80)
i πi

.

(18)

For the noise term σ2, we have

∂L
∂σ2 =

N
(cid:88)

i=1

πi

∂
∂σ2 log N (xi|C, σ2∆(cid:62)∆) + (1 − πi)

∂
∂σ2 log N (xi|0, σ2∆(cid:62)∆)

which with some algebraic rearrangement becomes

ˆσ2 =

1
N ∆(cid:62)∆

N
(cid:88)

i=1

πi(xi − C)2 + (1 − πi)x2
i .

(19)

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

20

B. Paige et al.

These updates taken together can be used to deﬁne an EM algorithm which
optimizes the values of C and σ2, despite the fact that the entries of φ0 are
unknown; once C and σ2 are then known, the vector π will give probability
estimates for each entry of φ0.

The overall EM algorithm can be summarized by the following iterative up-

dates:

1. πi ≡ p(zi = 1|x, ˆC, ˆσ2) =

2. ˆC ←

(cid:80)
i πixi
(cid:80)
i πi
3. ˆσ2 ← 1

N ∆(cid:62)∆

,

(cid:80)N

i=1 πi(xi − ˆC)2 + (1 − πi)x2
i .

αiN (xi| ˆC, ˆσ2∆(cid:62)∆)
αiN (xi| ˆC, ˆσ2∆(cid:62)∆) + (1 − αi)N (xi|0, ˆσ2∆(cid:62)∆)

,

To initialize the algorithm, we can set πi to some initial probabilities, and ﬁnd
initial values for ˆC, ˆσ2; we experimented with both setting to the prior probabil-
ities per-SNP estimated from the public data, as well as to the vector of all zeros
(corresponding to a “hard” initialization at the value of the baseline estimate),
and found no qualitative diﬀerence in performance.

E Scaling of EM algorithm with size of private dataset

Figure 6 demonstrates the change in accuracy of the EM algorithm over a range
of diﬀerent private database sizes. For this test, a synthetic dataset with 100
SNPs and 1,000,000 individuals is generated; 10,000 are held out as a public
database, and 30 individuals are taken as a ﬁxed test dataset of new dogs to
add and are used to estimate EM algorithm accuracy, across increasingly large
private database sizes. The algorithm has stable performance for increasingly
large private databases.

Fig. 6. Accuracy at reconstruction of the genome of one additional individual, using
EM estimation and a noisy estimate ˆK, measured as the size of the initial private
database increases. For very small private databases, accuracy is very high, as changes
in entries of β are clearly attributable to the new individual. Beyond a certain threshold,
overall accuracy is quite stable. Error bars show mean and two standard deviations.

103104105106Private dataset size0.700.750.800.850.900.951.00Per-SNP accuracybioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

21

F Estimating φ0 with diﬀerent SNP sets

Here we analyse what can still be said in the event that the two studies do
not use exactly the same set of SNPs. We will still assume the sets of SNPs
considered to have a signiﬁcant overlap.

For this purpose we will need a greater variety of notation. A primed variable
denotes that it corresponds to the second set of SNPs, e.g. K (cid:48) is the co-occurrence
matrix from the original M users for the second experiment. If a vector or matrix
is surrounded by square brackets this denotes that object but with any rows or
columns corresponding to SNPs not in the overlap removed, e.g. [K] denotes
the co-occurrence matrix from the ﬁrst experiment restricted to the overlapping
SNPs.

As before, from the ﬁrst experiment, we have

and now, from the second experiment, we have

K ˆβ = ΦT y

(K (cid:48) + φ(cid:48)T

0 φ(cid:48)

0) ˆβ(cid:48) = Φ(cid:48)T y(cid:48).

Taking the diﬀerence between these expressions, as before, gives

K (cid:48) ˆβ(cid:48) − K ˆβ = Φ(cid:48)T y(cid:48) − ΦT y − φ(cid:48)T

0 φ(cid:48)
0

ˆβ(cid:48).

Restricting to the overlapping set gives that

[K (cid:48) ˆβ(cid:48)] − [K ˆβ] = [Φ(cid:48)T y(cid:48) − ΦT y − φ(cid:48)T

0 φ(cid:48)
0

ˆβ(cid:48)].

Noting that [K] = [K (cid:48)] and that [Φ(cid:48)T y(cid:48)] − [ΦT y] = [φT

0 y0] we get that

[K]([ ˆβ(cid:48)] − [ ˆβ]) = [φT

0 ](y(cid:48)

0 − φ0

ˆβ(cid:48)).

(20)

(21)

(22)

(23)

(24)

Analogously to the previous cases (y(cid:48)
and we get

0 − φ0

ˆβ(cid:48)) is a scalar which we can label C

[φT

0 ] =

1
C

[K]([ ˆβ(cid:48)] − [ ˆβ]).

(25)

Thus if K is known it can be used to deduce whether the additional individual
has each of the SNPs in the overlapping set. If K is not known exactly it can be
estimated from public data just as in the same SNP case.

G Algorithm for identifying unique genotypes of multiple

dogs, when a precise K is known

While the simple approach described in the main manuscript will work in many
cases, there are a few special circumstances where a more complex algorithm
may be required. In particular, it would not work if there are combinations of
SNPs that are not observed among the individuals added to the database. For

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

22

B. Paige et al.

instance, if there is not a single SNP location where the ﬁrst individual has a
SNP variant and the others do not, then we would miss the corresponding value
in Cm. However, it is still possible to identify all the values in Cm through a
more complex algorithm:

1. First, extract all unique, non-zero values from dm.
2. Find the sum of all pairs of values in (1).
3. Find all values that are in (1), but not in (2).
4. If there are exactly m values in (3) and the sum of these values equal the
last value of dm (corresponding to the intercept term), then you have found
the correct values of Cm.

5. Otherwise, this suggests that there are one or more elements of Cm that are

missing from (3) and possibly a few values in (3) that are not in Cm.

6. Begin by subtracting every pair of values in (3). These are now also potential

values of Cm

7. Search for a set of m values from (3) and (6) that sum to the last element
of dm. There may be more than one set of values for which this is true.
8. If this search is unsuccessful, repeat steps 6-7. Eventually, a set of m values

summing to dm should be found.

9. If more than one possible set of values is found for Cm in (7), it is still pos-
sible to compare these sets and identify which is the most likely to contain
the true values of Cm. For each possible Cm vector, a set of genotypes can
be constructed for the m additional individuals. Using the frequencies of
each SNP, it is possible to calculate the probability of observing each geno-
type. The set of values that produces the most likely genotypes for the m
individuals is most likely to be the correct one.

Additionally, this algorithm depends on the fact that it is extremely unlikely
that if someone were to sample three random continuous numbers i, j and k, it
would just so happen that i + j = k. There is an extremely small chance that a
value of Cm would be un-discoverable because of a coincidence of this nature.

H Description of K when the genotypes are non-binary

In many cases, GRS are calculated on genotype matrices that are non-binary. In
particular, they may take on three discrete values 0, 1 and 2, where 0 indicates
that the most common variant is homozygous, 1 indicates that the individual is
heterozygous for the uncommon variant, and 2 indicates that the individual is
homozygous for the uncommon variant.

If this is the case, the description of K will change. However, it is still the
case that the entries of K depend only on the SNP frequencies and SNP co-
occurrence frequencies in the dataset, and that knowledge of SNP frequencies
and pairwise co-frequencies from the original study, are all that is required in
order to compute K.

– For i = 1, . . . , N : Kii = pAa + 4pAA where paa is the frequency of individuals
being heterozygous for the uncommon variant and pAA is the frequency of
individuals being homozygous for the uncommon variant.

bioRxiv preprint 

doi: 

https://doi.org/10.1101/2020.01.15.907808

; 

this version posted January 15, 2020. 

The copyright holder for this preprint

(which was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made 

available under a

CC-BY 4.0 International license
.

Reconstruction attacks from GRS

23

– For i = 1, . . . , N − 1 and j > i: Kij = Kji = pAa/Bb + 2pAA/Bb + 4pAA/BB
where pAa/Bb is the frequency that both SNPs are simultaneously hetero-
gygous, pAA/Bb is the frequency that one SNP is homozygous for the rare
variant and the other is heterogygous simultaneously, and pAA/BB is the
frequency that that uncommon variants are found to be homozygous simul-
taneously.

– For i = 1, . . . , N and j = N + 1: Kij = Kji = pAa + 2pAA.
– Finally, KN +1,N +1 = 1.

